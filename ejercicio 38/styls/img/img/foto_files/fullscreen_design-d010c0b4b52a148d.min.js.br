"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="615eb246-aa0b-5e50-bff6-6b331b2554bc")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[1085],{23883:(e,t,n)=>{let a;n.r(t),n.d(t,{DesignView:()=>lT});var o=n(411855),i=n(188507),r=n(511655),l=n(922827),c=n(474474),s=n(406755),d=n(301929),m=n(325202),p=n(957029),u=n(115630),_=n(298455),E=n(196302),g=n(376793),y=n(944613),v=n(34087),h=n(917756),f=n(9063),N=n(558134),b=n(56182),I=n(858799),T=n(271160),A=n(411171),S=n(118256),C=n(659283),O=n(542030),P=n(839980),x=n(404158),w=n(978760),k=n(325010),D=n(967617);let M=(0,c.ck)("bfb358109ac5994e69048d8390d3a0c334253aa8");function R({changedNodeId:e,nodeHeight:t,complete:n}){return(0,g.h)(()=>{l.Egt?.replaceSelection([e],!0)}),o.createElement(P.NJ,{className:D.R3,targetKey:e,dismissModal:n,arrowPosition:O.F_.LEFT_TITLE,width:240,backgroundColor:"var(--color-bg)",topOffset:t?-t/2-15:0,leftOffset:12,closeButtonClassName:D.b,hideIfTargetLost:!0,noAnimation:!0,isCanvasNode:!0,shouldNotWrapInParagraphTag:!0,hideIfArrowPositionDoesNotMatch:!0},o.createElement("div",{className:D.Rg},(0,d.t)("dev_handoff.rfd_signals_upsell.title")),o.createElement("div",{className:D.O6},o.createElement("div",{className:D.j},o.createElement(x.GV,{src:M,width:240})),o.createElement("div",{className:D.zu},(0,d.t)("dev_handoff.rfd_signals_upsell.description"))),o.createElement("div",{className:D.JP},o.createElement(u.v,{mode:"dev-handoff"},o.createElement(v.$z,{trackingProperties:{trackingDescriptor:f.c.MARK_READY_FOR_DEV},variant:"primary",onClick:function(){e&&(n(),I.z4.setNodesReady(!0,[e],"dev-node-change-upsell",null))}},(0,d.t)("dev_handoff.rfd_signals_upsell.mark_ready_for_dev")))))}function L(e){E.az.trackDefinedEvent("activation.rfd_signal_upsell.disqualification_reason",{reason:e,upsellSubject:"frame"})}function U(){let[e,t]=o.useState(null),[n,a]=o.useState(null),i=(0,S._X)({subscribeToUpdates_expensive:!0}),r=(0,y.Xr)(k.hj),l=(0,y.Xr)(k.d1),c=(0,y.md)(k.Sp),s=(0,y.Xr)(k.Sp),d=o.useRef(null),m=(0,T.Z)("dev-handoff-rfd-signals-frame-upsell"),[p,u]=o.useState(!1),E=o.useCallback(()=>{d.current&&a(d.current.absoluteBounds.height*i.zoomScale)},[i.zoomScale]);o.useEffect(()=>{if(!e)return;let t=`dev-node-change-upsell-${e}`,n=(0,A.EE)(t,[e],e=>{d.current=e.position,E()});return d.current=n.currentNodePosition[e]?.position||null,E(),()=>{(0,A.lB)(t)}},[e,E]);let g=(0,h.cR)(),{show:v,complete:f,uniqueId:I,isShowing:O}=(0,b.e)({overlay:w.kBA,priority:C.N.HIGH_PRIORITY_MODAL,experiment:{check:g,predicate:e=>e,postCheck:()=>!0}});return(o.useEffect(()=>{l({fn:f})},[f,l]),(0,N.E)(I,["frame_node_name_changed_with_rfd_indicator"],e=>{if(!e.properties.nodeId){L("no_node_id");return}let n=(0,_.UN)().get(e.properties.nodeId);if(!n){L("node_not_found");return}if(0===n.childCount){L("no_children");return}if(c){L("already_seen_upsell_this_session");return}t(e.properties.nodeId),r(e.properties.nodeId),a(n.absoluteBoundingBox.h),v({onShow:async()=>{u(!0),await m(await (0,S.QZ)({nodeId:e.properties.nodeId,alwaysPan:!0}),{alwaysNavToSimilarViewport:!0}),u(!1),s(!0)}})}),e&&n&&O&&!p)?o.createElement(R,{changedNodeId:e,nodeHeight:n,complete:f}):null}var K=n(126517),V=n(327064),B=n(352074),F=n(775448),z=n(195909),G=n(256659),$=n(222903),W=n(349762),H=n(844882),Y=n(846995),X=n(579557),Q=n(840862),J=n(60843),j=n(530313),q=n(472403),Z=n(723319),ee=n(389790),et=n(187854),en=n(634484),ea=n(862151),eo=n(912675),ei=n(197416),er=n(899469),el=n(139558),ec=n(556576),es=n(972973),ed=n(546619),em=n(1829),ep=n(378851),eu=n(432995),e_=n(122865);let eE=(0,eo.tf)(B.N);function eg(){let e=(0,h.o9)(),t=(0,ec.tS)(),n=(0,Q.BI)(),a=function(){let e;let t=(0,em.hr)(e=>e).getRoot(),n=t=>{for(let a of t.childrenNodes)(a.isTopLevelFrame()||"CANVAS"===a.type)&&(a.hasReadyStatus?e?e.getStatusInfo().lastUpdateUnixTimestamp<a.getStatusInfo().lastUpdateUnixTimestamp&&(e=a):e=a:("SECTION"===a.type||"CANVAS"===a.type)&&n(a))};return n(t),e?.getStatusInfo()}(),i=(0,es.wW)(a?.userId??null),r=!!a&&W.A.unix(a.lastUpdateUnixTimestamp).isAfter((0,W.A)().subtract(60,"day")),l=(0,eu.U)("upsell"),s=H.Rs(ed.HdA,{key:t??""},{enabled:!!t})?.data?.file?.hasPermission,m=(0,y.md)(ei.LZ),p=(0,el.aV)(),u=(0,j._I)(),_=(0,j.U4)(),E=(0,y.md)(er.NT),g=(0,et.J)(),v=(0,h.Oc)(),{show:I,complete:T,isShowing:A,uniqueId:S}=(0,b.e)({overlay:w.koo,priority:C.N.OVERRIDING_MODAL},[E]);(0,o.useEffect)(()=>{I({canShow:t=>g&&m&&!u&&"loaded"===n.status&&!n.hasPendingRequest&&r&&_&&!p&&("developer"===t||"software-development"===t||e(t))})},[I,u,_,m,p,E,g,n,r,e]),(0,N.E)(S,"Enter Inspect Mode",()=>{A&&T()});let O=(0,en.BC)({dismissModal:T,onRequestAccess:()=>{s&&l("handoff")}}),P=o.useCallback(()=>{T(),O.hidden||O.onClick(ea.i$.Upsell)},[T,O]),x=o.createElement(eE,{newTab:!0,trusted:!0,trackingProperties:{trackingDescriptor:f.c.READ_THE_GUIDE},href:V.z},(0,d.tx)("dev_mode.onboarding_callout.read_the_guide")),k=o.createElement(o.Fragment,null,o.createElement("span",{className:e_.XQ},o.createElement($.O,null)),o.createElement("span",{className:X.cx.textBodyMediumStrong.$},(0,d.tx)("dev_handoff.status.mark_status_sentence_part.ready_for_dev"))),D=v()?o.createElement(Z.vB,null):o.createElement(o.Fragment,null,o.createElement("div",{className:e_.DD},(0,d.tx)("dev_handoff.paywall.blocking_modal.title.dev_onboarding")),o.createElement("ul",null,o.createElement("li",{className:e_.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.copy_code")),o.createElement("li",{className:e_.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.track_design_changes")),o.createElement("li",{className:e_.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.customize_plugins"))),o.createElement("div",{className:e_.jg},s?(0,d.tx)("dev_handoff.paywall.blocking_modal.content.explore_for_free_with_link",{learnMoreLink:x}):(0,d.tx)("dev_handoff.paywall.blocking_modal.content.curious_to_learn_more",{learnMoreLink:x}))),M=(0,q.W)(),R=F.hS({open:!0,onClose:Y.lQ,preventUserClose:!0,recordingKey:"dev-mode-paywall-modal"});return o.createElement(ep.M,{testId:"rfd-upsell-upsell",isShowing:A},o.createElement("div",{"data-editor-theme":"dev-handoff"},o.createElement(J.OM,null),o.createElement(eo.fu,{name:"RFD Upsell Modal",properties:M,enabled:M?.gracePeriod!==void 0},o.createElement(z.bL,{width:392,manager:R},o.createElement(G.Wk,null,o.createElement("div",{className:e_.XV},i.loading?"":(0,d.tx)("dev_handoff.upsell.user_marked_a design",{userName:i.user?.name||i.user?.handle,status:k})),o.createElement("div",{className:X.cx.py8.px16.$},o.createElement(ee.E,{imgSrc:(0,c.ck)("6d5e9cb0e9ec7fd5dd58425c5527dc8a78143a19"),content:D,modalType:"RFD Upsell Modal",primaryButtonLabel:(0,d.tx)("dev_handoff.paywall.blocking_modal.button.request_access"),primaryButtonType:"request_access",primaryButtonOnClick:O.hidden?void 0:P,secondaryButtonLabel:(0,d.tx)("dev_handoff.paywall.blocking_modal.button.not_now"),secondaryButtonType:"not_now",secondaryButtonOnClick:T})))))))}var ey=n(550707),ev=n(317004),eh=n(897392),ef=n(720793),eN=n(865046),eb=n(994073),eI=n(232087),eT=n(381218),eA=n(985091),eS=n(132878),eC=n(72400),eO=n(157599),eP=n(648372),ex=n(837287),ew=n(915576),ek=n(764554),eD=n(723789),eM=n(847132),eR=n(551857),eL=n(983767),eU=n(296027),eK=n(686644),eV=n(15544),eB=n(438476),eF=n(565652),ez=n(727466),eG=n(139689),e$=n(629019),eW=n.n(e$),eH=n(772391),eY=n(315711),eX=n(919122),eQ=n(101072),eJ=n(628673),ej=n(25448),eq=n(244609),eZ=n(43166),e0=n(989364),e1=n(192567),e2=n(545854),e8=n(976411),e3=n(731922);let e4="starting_points_templates_modal--templateOption--qYXkm",e5="starting_points_templates_modal--templateOptionTitle--DmVPR",e7="starting_points_templates_modal--verticalTemplateImage--kAzQz";var e6=(e=>(e.DESKTOP="desktop",e.MOBILE="mobile",e.WEBSITE="website",e))(e6||{});let e9={x:0,y:0},te={website:{x:0,y:1600},mobile:{x:0,y:300},desktop:{x:0,y:300}},tt={website:.1,mobile:.225,desktop:.1},tn=e=>{let t=(0,c.Ay)().starting_points;switch(e){case"basics":return t?.figma_basics_hub_file_id;case"desktop":return t?.desktop_templates_hub_file_id;case"mobile":return t?.mobile_templates_hub_file_id;case"website":return t?.website_templates_hub_file_id}};function ta({onClose:e}){let t=(0,i.wA)(),n=o.useRef(null),[a,r]=o.useState(!1),[s,m]=o.useState(!1),[p,u]=o.useState(!1),[_,v]=o.useState(!1),[h,N]=o.useState(window.innerWidth),b=(0,eq.q)(),I=(0,ec.tS)(),T=(0,i.d4)(e=>e.fileVersion),A=(0,i.d4)(e=>e.mirror.sceneGraph),S=b&&(0,e2.Qf)(A),C=!!S&&0===S.childCount,[O]=(0,eH.IT)((0,eJ.tH)({})),P=!!(0,c.kc)().starting_points_ghost_previews,{insertTemplate:x}=(0,ej.Fz)(),w=(0,e8.g)(),k=(0,y.Xr)(e3.Yq),D=(0,y.Xr)(e3.bj),[M,R]=o.useState(!1),L=(0,e0.GQ)(),U=(0,e1.P)();(0,g.h)(()=>{let e=()=>{N(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),o.useEffect(()=>{v(L+50>h/2-257||h-U-50<h/2+257),u(L+50>h/2-365||h-U-50<h/2+365)},[L,U,h]);let K=o.useCallback(()=>{if(!P||"loaded"!==O.status||!O.data)return;let e=[];for(let t of Object.values(e6)){let n=tn(t);if(!n)return;let a=O.data[n];if(!a)return;let o={type:eZ.n.HubFile,template:a};e.push(o)}Promise.all(e.map(e=>y.zl.get((0,e3.Re)({fileKey:I,fileVersion:T,template:e})))).then(()=>{R(!0)}).catch(e=>{console.error("Failed to load template buffers",e),R(!0)})},[I,T,O,P]);if(o.useEffect(()=>{"loaded"!==O.status||M||K()},[O,M,K]),o.useEffect(()=>{b&&S&&!C&&!s&&e()},[b,S,C,s,e]),!(0,c.kc)().starting_points_modal)return null;let V=async n=>{if("loaded"!==O.status)return;r(!0);let a=tn(n);if(!a)return;let o=O.data[a];o&&(P&&"basics"!==n?await (0,ej.Zg)({insert:()=>D({selectTemplateAfterCommit:!1,moveViewportAfterCommit:!1,priority:"user-visible",editScopeType:l.zkO.USER}),template:{template:o,type:eZ.n.HubFile},fileKey:I,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1}):await x({template:{template:o,type:eZ.n.HubFile},userTriggered:!1,editScopeType:l.zkO.ONBOARDING,triggeredFrom:"starting-points",templateInsertionDirection:l.hKj.RIGHT}),"basics"===n?(0,eQ.YQ)({id:"starting_points_basics_template_inserted"}):(0,eQ.YQ)({id:"starting_points_template_inserted"}),e(),r(!1))},B=o.createElement(eo.$z,{onClick:()=>V("basics"),trackingProperties:{trackingDescriptor:f.c.LEARN_THE_BASICS}},(0,d.tx)("starting_points.learn_the_basics")),F=e=>{if((0,E.sx)("Starting Points Template Option Hover",{template:e}),!P)return;let n=tn(e);if(!n||!O.data)return;let a=O.data[n];if(!a)return;let o={type:eZ.n.HubFile,template:a},i=tt[e];window.innerWidth>1700&&(i*=1.5),(0,ej.Zg)({insert:()=>w(o,{moveViewportAfterPreview:!0,priority:"user-visible",previewManager:{nodeType:l.Z6A.CANVAS},position:e9,viewportOptions:{position:te[e],scale:i,duration:0}}),template:o,fileKey:I,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1,isPreview:!0})},z=()=>{P&&k()};return o.createElement(eo.fu,{name:"Starting Points Modal"},o.createElement("div",{className:"starting_points_templates_modal--startingPointsTemplatesModalPositioner--R8g3u"},o.createElement(eX.x,{isLoading:a,className:"starting_points_templates_modal--loadingSpinner--UOrjg"},()=>o.createElement("div",{className:eW()({"starting_points_templates_modal--startingPointsTemplatesModal--dUQte":!0,"starting_points_templates_modal--isHidden--jVN1L":_,"starting_points_templates_modal--isCondensedView--3tVz6":p}),onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),ref:n},o.createElement("div",{className:"starting_points_templates_modal--modalInstructions--ZtdTL"},o.createElement("div",{className:"starting_points_templates_modal--modalTitle--HT3eZ"},(0,d.t)("starting_points.what_do_you_want_to_make_today")),o.createElement("div",{className:"starting_points_templates_modal--modalLearnMore--g-GWo"},(0,d.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:B}))),o.createElement("div",{className:"starting_points_templates_modal--optionContainer--mYEsG"},o.createElement(eo.$z,{className:e4,onClick:()=>V("website"),onMouseEnter:()=>F("website"),onMouseLeave:z,trackingProperties:{trackingDescriptor:f.c.WEBSITE_TEMPLATES}},o.createElement("div",{className:e5},(0,d.t)("starting_points.website")),o.createElement(eY.oW,{className:e7,src:(0,c.ck)("9b8475fdab7c1ed3cd1c0d16b957d65a80840b74"),alt:"Website template"})),o.createElement(eo.$z,{className:e4,onClick:()=>V("mobile"),onMouseEnter:()=>F("mobile"),onMouseLeave:z,trackingProperties:{trackingDescriptor:f.c.MOBILE_APP_TEMPLATES}},o.createElement("div",{className:e5},(0,d.t)("starting_points.mobile_app")),o.createElement(eY.oW,{className:e7,src:(0,c.ck)("b262e57bed515b9f0da45ae54fa43824d9704c14"),alt:"Mobile app template"})),o.createElement(eo.$z,{className:e4,onClick:()=>V("desktop"),onMouseEnter:()=>F("desktop"),onMouseLeave:z,trackingProperties:{trackingDescriptor:f.c.DESKTOP_APP_TEMPLATES}},o.createElement("div",{className:e5},(0,d.t)("starting_points.desktop_app")),o.createElement(eY.oW,{className:"starting_points_templates_modal--desktopTemplateImage--3kplg",src:(0,c.ck)("cb2f715253dacb4e7d3fb211ff2792fc28a38832"),alt:"Desktop app template"}))),o.createElement("div",{className:"starting_points_templates_modal--modalLearnMoreFooter--pSvfX"},(0,d.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:B})),o.createElement("div",{className:"starting_points_templates_modal--closeButton--io-14"},o.createElement(ez.K,{onClick:e,"aria-label":(0,d.t)("general.close"),htmlAttributes:{"data-testid":"close-button"}},o.createElement(eG.A,null)))))))}let to=(0,eR.r1)("dismissed_starting_points_templates_modal");function ti(){let e=(0,i.wA)(),t=!!(0,c.kc)().starting_points_modal,n=(0,h.GM)(),a=(0,eM.QL)(eF.E_.key)===eF.E_.value,r=(0,el.aV)(),l=(0,i.d4)(e=>e.mirror.appModel.currentPage),s=(0,em.Fk)((e,t)=>(0,eU.zC)(e,t),l),d=(0,eM.QL)(eB.pt.KEY)===eB.pt.VALUE,m=(0,ec.q5)(),p=(0,eK.TA)(),u=m?.creatorId===p,_=(0,y.md)(er.Fy),E=(0,y.md)(eL.UQ),g=!(0,eV.f)("not_gen_0"),v=(0,eD.GS)(),f=(0,y.md)(to),N=(0,c.Ay)().starting_points,{show:I,isShowing:T,complete:A}=(0,b.e)({overlay:w.EYw,priority:C.N.OVERRIDING_MODAL+1,experiment:{check:n,predicate:e=>e,postCheck:(e,t)=>!t}},[_,f]);return(o.useEffect(()=>{t&&u&&!d&&!r&&s&&!T&&(a?I():g&&E&&v&&N&&I({canShow:e=>!e}))},[t,u,r,s,T,a,g,E,v,d,N,I]),T)?o.createElement(ta,{onClose:()=>{f.data||e(ek.b({dismissed_starting_points_templates_modal:!0})),A()}}):null}var tr=n(342482),tl=n(761755),tc=n(815817),ts=n(475231),td=n(855826),tm=n(284084),tp=n(933717),tu=n(373094),t_=n(367984),tE=n(466585);let tg=(0,tE.Op)({initial:"ready_to_show",states:[{id:"ready_to_show",transitions:[(0,tE.nr)("curator_content_shown","ui3_onboarding_was_shown_in_current_session",{condition:({event:e})=>e.properties.shown===w.S$7.id})]},{id:"ui3_onboarding_was_shown_in_current_session",terminal:!0}]}),ty=(0,tE.rn)("track_ui3_onboarding_shown",tg);var tv=n(814003);function th(){let{isShowing:e,complete:t,show:n,uniqueId:a}=(0,b.e)({overlay:w.l_p,priority:C.N.SECONDARY_MODAL}),r=(0,i.wA)(),c=(0,el.aV)(),s=(0,ec.q5)(),m=(0,eK.iZ)(),p=(0,tr.te)(),u=!!(0,eV.f)(tu.bo),_="ui3_onboarding_was_shown_in_current_session"===(0,tc.zl)(ty).currentState,E="no_figma_basics_onboarding_was_shown_in_current_session"===(0,tc.zl)(t_.j).currentState,g=(0,y.md)(tp.Cl),v=(0,ts.jO)(),h=s?.canEdit,I=(0,i.d4)(e=>e.leftPanel.activeTab===l.xae.LAYERS);if((0,N.E)(a,["Reset Visual Assets Tooltips",tu.io],()=>{m&&s&&r(ek.b(tv.g))}),(0,o.useEffect)(()=>{!p()||!h||g||u||_||E||!v||c||!I||e||n()},[n,p,h,u,v,c,_,E,e,g,I]),(0,o.useEffect)(()=>{!I&&e&&t()},[I,e,t]),!e)return null;let T=o.createElement("strong",{style:{display:"contents"}},(0,d.tx)("design_systems.assets_panel.assets"));return o.createElement(td.X,{isShowing:e,title:(0,d.tx)("rcs.visual_assets.elevate_your_designs"),description:(0,d.tx)("rcs.visual_assets.grab_visual_assets",{strongAssets:T}),primaryCta:{label:(0,d.tx)("rcs.presets_baseline.try_it"),type:"button",onClick:()=>{r(tl.FP({tab:l.xae.ASSETS})),t()},ctaTrackingDescriptor:f.c.PRESETS_TRY_IT},trackingContextName:"Visual Assets Intro Tooltip",userFlagOnShow:tu.bo,position:tm.Q.UI3_EDITOR_TOP_LEFT,onClose:t})}var tf=n(173038),tN=n(824280),tb=n(216524),tI=n(232061);let tT=(0,eR.r1)(tI.WX),tA=(0,eR.r1)(tI.b6),tS=!1;function tC(){let e=(0,i.wA)(),t=(0,y.md)(ei.wg),n=(0,el.aV)(),a=(0,y.md)(er.mp),r=(0,j._I)(),l=(0,eD.GS)(),s=(0,y.md)(tA),m=(0,y.md)(tT),{uniqueId:p,show:u,complete:E,isShowing:g}=(0,b.e)({overlay:w.kc4,priority:C.N.SECONDARY_MODAL},[m,s,a]),v=(0,eu.U)("modal"),h=o.useCallback(()=>{!n&&!tS&&t&&r&&(0!==(_.UN().getCurrentPage()?.childCount||0)&&u({canShow:(e,t,n)=>!e&&!t&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),tS=!0)},[u,r,t,n]);function I(){e(ek.b({[tI.WX]:!0})),E()}o.useEffect(()=>{l||h()},[h,l]),(0,N.E)(p,(0,tb.wX)("design"),()=>{h()}),o.useEffect(()=>{"loaded"===m.status&&m.data&&E()},[m,E]),(0,N.E)(p,"Enter Inspect Mode",()=>{g&&I()});let T=(0,eD.GS)()?eF.ON:eF.JN;return o.createElement(tN.rq,{isShowing:g,trackingContextName:tI.WX,onClose:I,targetKey:T,title:(0,d.tx)("dev_handoff.annotations_introduction_overlay.title"),media:o.createElement(tf.y,{src:(0,c.ck)("5b9addc96424c11577a1ec91e1bbadcd786fe343"),alt:(0,d.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,d.tx)("dev_handoff.annotations_introduction_overlay.description"),primaryCta:{label:(0,d.tx)("dev_handoff.annotations_introduction_overlay.primary_cta"),type:"button",onClick:function(){v("handoff")},ctaTrackingDescriptor:f.c.SHOW_ME}})}var tO=n(556379);let tP=(0,eR.r1)(tI.b6),tx=(0,eR.r1)(tI.WX),tw=!1,tk=!1;function tD(){let e=(0,i.wA)(),t=(0,el.aV)(),n=(0,y.md)(er.mp),a=(0,y.md)(tO.N),r=(0,eA.J2)(l.Ez5.annotationObserver().annotationInfoByTlf),s=y.md(ec.yV)?.creatorId,m=(0,y.md)(tP),p=(0,y.md)(tx),{uniqueId:u,show:_,complete:E,isShowing:g}=(0,b.e)({overlay:w.kc4,priority:C.N.SECONDARY_MODAL},[m,p,n,a]),v=(0,eu.U)("modal"),h=r.size>0;function I(){e(ek.b({[tI.b6]:!0})),E()}o.useEffect(()=>{t&&(tk=!0),!t&&!tw&&tk&&h&&(_({canShow:(e,t,n,a)=>!e&&!t&&s!==a&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),tw=!0)},[h,t,s,_]),o.useEffect(()=>{"loaded"===m.status&&m.data&&E()},[m,E]),(0,N.E)(u,"Enter Inspect Mode",()=>{g&&I()});let T=(0,eD.GS)()?eF.ON:eF.JN;return o.createElement(tN.rq,{isShowing:g,trackingContextName:tI.b6,onClose:I,targetKey:T,title:(0,d.tx)("dev_handoff.annotations_upsell_overlay.title"),media:o.createElement(tf.y,{src:(0,c.ck)("e84a2faeb510847abd7bfb9c15a74ef974bb4c13"),alt:(0,d.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,d.tx)("dev_handoff.annotations_upsell_overlay.description"),primaryCta:{label:(0,d.tx)("dev_handoff.annotations_upsell_overlay.primary_cta"),type:"button",onClick:function(){v("handoff")},ctaTrackingDescriptor:f.c.OPEN_DEV_MODE},secondaryCta:{label:(0,d.tx)("dev_handoff.annotations_upsell_overlay.secondary_cta"),type:"button",onClick:E,ctaTrackingDescriptor:f.c.NOT_NOW}})}var tM=n(434236),tR=n(859905),tL=n(462132),tU=n(730215),tK=n(731173),tV=n(849133),tB=n(764976),tF=n(808638),tz=n(698563),tG=n(694208),t$=n(534599),tW=n(591032),tH=n(740788),tY=n(510237),tX=n(902225),tQ=n(128731),tJ=n(540706);function tj({asset:e,defaultDropPosition:t,onDismiss:n,onInsert:a}){let[i,r]=o.useState(!1);return i?null:o.createElement("div",{className:"asset_shelf_suggestion--container--18Rt5"},o.createElement("div",{className:"asset_shelf_suggestion--suggestionContainer--rY1cW"},o.createElement(tq,{asset:e,defaultDropPosition:t,onInsert:a},o.createElement("div",{className:"asset_shelf_suggestion--suggestion--WCutP"},o.createElement(tJ.M,{className:"asset_shelf_suggestion--image--R4c1I",item:e,shouldGenerateLocalThumbnail:!0,draggable:!1})))),o.createElement(tW.E,{className:"asset_shelf_suggestion--closeIcon--1S4i2",onClick:()=>{r(!0),n()}},o.createElement(tH.p,null)))}function tq(e){let{asset:t,defaultDropPosition:n,onInsert:a}=e,{onInsertableResourcePointerDown:i,dragState:r,insertAction:l}=(0,tQ.j)({resource:t,isList:!0,sourceForTracking:"SuggestionsShelf",clickToInsert_DEPRECATED:!1,draggingThumbMaxDimensions:void 0,insertionCallback:a}),c=new tL.Mi(.5,.5);return o.createElement(o.Fragment,null,o.createElement(tY.GG,{onPointerDown:e=>{i(e)},onClick:e=>{l({e:new PointerEvent(e.type,{...e,view:window}),isClick:!0,pointerPercentageOffset:c,dropPosition:n})}},e.children),o.createElement(tX.q,{dragState:r,isList:!0}))}let tZ="suggestions_shelf--emptyStateText--T0I8P";function t0({setIsOpen:e}){let{suggestions:t,isLoading:n,analyticsData:a,suggestionsNodeGuid:i,debugString:r}=(0,tF.$i)(),l=(0,_.UN)(),s=i?l.get(i):void 0,m=o.useMemo(()=>{let e=s?s.absoluteBoundingBox.x+s.absoluteBoundingBox.w/2:0,t=s?s.absoluteBoundingBox.y+s.absoluteBoundingBox.h/2:0;return new tL.Mi(e,t)},[s]),p=o.createElement(tR.k,{className:"suggestions_shelf--upChevron--oUF5v suggestions_shelf--downChevron--ZbvaY"}),u=o.useMemo(()=>t.slice(0,5).map((e,t)=>o.createElement(tj,{key:`suggestion:${t}`,asset:e,fileName:"mock",thumbLayout:tG.rp.SMALL,thumbHeight:35,thumbWidth:40,sectionPosition:t,displayType:"list",sourceForTracking:"suggestionsShelf",viewMode:t$.Bk.Grid,defaultDropPosition:m,onDismiss:()=>{(0,tB.gb)(a,tB.GG.RESULT_DISMISSED)},onInsert:()=>{(0,tB.gb)(a,tB.GG.RESULT_INSERTED)}})),[t,m,a]);return o.createElement("div",{className:eW()("suggestions_shelf--shelf--401Ia",{"suggestions_shelf--shelfNoDebug--mFs5X":!(0,c.kc)().anticipation_trigger_debug,"suggestions_shelf--shelfDebug--QvXPF":(0,c.kc)().anticipation_trigger_debug})},n&&o.createElement(tM.k,null),!n&&!i&&o.createElement("div",{className:tZ},(0,d.t)("auto_suggest.suggestion_shelf_empty_state")),(0,c.kc)().anticipation_trigger_debug&&!n&&i&&o.createElement("div",null,r),!n&&i&&(t.length>0?o.createElement("div",{className:"suggestions_shelf--suggestions--aZ-e9"},u):o.createElement("div",{className:tZ},(0,d.t)("auto_suggest.suggestion_shelf_no_suggestions"))),o.createElement("button",{className:"suggestions_shelf--upChevronContainer---RjEh",onClick:()=>{(0,tB.gb)(a,tB.GG.PANEL_CLOSED),e(!1)}},p))}function t1(){let e=(0,eA.ut)(l.Ez5?.editorPreferences().showAssetAutoSuggest,!0),t=o.useCallback(e=>{l.Ez5?.editorPreferences().showAssetAutoSuggest.set(e)},[]),[n,a]=(0,tV.d)(),i=o.createElement(tR.k,{className:"suggestions_shelf--downChevron--ZbvaY"}),r=o.createElement("button",{className:"suggestions_shelf--downChevronContainer--9AOKn",onClick:()=>{(0,tB.gb)(tB.YQ,tB.GG.PANEL_OPENED),t(!e)}},i);return o.createElement(tU.dP,null,o.createElement("div",{className:eW()("suggestions_shelf--wrapper--seged",tK.Dm)},o.createElement("div",{className:e?"suggestions_shelf--shelfContainerOpen--qh1UB suggestions_shelf--shelfContainer--EXG5K":"suggestions_shelf--shelfContainerClosed--jUxyH suggestions_shelf--shelfContainer--EXG5K",style:{marginLeft:n,marginRight:a}},!e&&r,e&&o.createElement(t0,{setIsOpen:t}))))}function t2(){return!(0,tz.r8)()||(0,c.kc)().anticipation_asset_panel?null:o.createElement(t1,null)}var t8=n(843117),t3=n(821910),t4=n(12106),t5=n(134309),t7=n(889012),t6=n.n(t7),t9=n(395096),ne=n(689570),nt=n(432642),nn=n(432408),na=n(470036),no=n(529e3),ni=n(47438),nr=n(897214),nl=n(539321),nc=n(754612),ns=n(424940),nd=n(145219);function nm(e){let t=e.rootNodeIdToViolatingNodeIdSet;if(t?.size)return Array.from(t.keys()).sort()[0]??void 0}let np=(0,y.eU)(null),nu=(0,y.eU)(null),n_=(0,nr.Wh)(()=>(0,y.eU)(e=>{let t=e(nt.m7),n=e(nt.Iy),a=e(np);if(!a)return null;let o=n.get(a),i=Array.from(o?.violatingNodeIdToRootNodeId.keys()??[]).map(e=>Array.from(t.get(e)?.values()??[])).flat(),r={};for(let e of i){let t=function(e,t,n){return n?(e===ns.C.REQUIRE_FILL_COLOR_TOKENS||e===ns.C.REQUIRE_STROKE_COLOR_TOKENS)&&"color"in n?`${t}-${e}-${(0,nl.colorToHex)(n.color)}-${n.opacity}`:e===ns.C.COMPONENT_MATCH&&"components"in n?`${e}-${n.guid}`:`${t}-${JSON.stringify(n,Object.keys(n).sort())}`:e}(e.ruleId,e.nodeType,e.detectionContext);r[t]=r[t]||[],r[t].push(e)}return Object.entries(r)})),nE=(0,nr.Wh)(()=>(0,y.eU)(e=>Array.from(e(nt.Iy).values()).sort((e,t)=>"SIMILARITY"===e.type&&"SIMILARITY"!==t.type?-1:"SIMILARITY"===t.type&&"SIMILARITY"!==e.type?1:t.violatingNodeIdToRootNodeId.size-e.violatingNodeIdToRootNodeId.size)));function ng(){let e=(0,y.md)(nt.m7);return(0,o.useMemo)(()=>Array.from(e.values()).reduce((e,t)=>e+t.size,0),[e])}function ny(){let e=(0,y.md)(np),t=(0,y.md)(nt.Iy);return e&&t.get(e)||null}var nv=n(463033),nh=n(83783);function nf(){let[e,t]=(0,o.useState)(0),[n,a]=(0,o.useState)(!1),i=(0,y.md)(nt.vo),r=(0,y.md)(nt.fY),l=(0,y.md)(nt.Iy),c=ng(),s=function(){let e=(0,y.md)(nt.m7);return(0,o.useMemo)(()=>{let t={};for(let n of e.values())for(let e of n.values()){let{ruleId:n}=e;t[n]=t[n]||[],t[n].push(e)}return Object.entries(t).map(([e,t])=>({rule:e,count:t.length}))},[e])}(),d=(0,nc.r)(),m=function(){let[e,t]=(0,o.useState)(0),n=(0,y.md)(nt.Iy),a=(0,y.md)(nt.m7);return(0,o.useEffect)(()=>{let e=new Set;for(let t of n.values())for(let n of t.violatingNodeIdToRootNodeId.keys())e.add(n);let o=new Set;for(let t of a.values())for(let n of t.values())e.has(n.guid)||o.add(n.guid);t(o.size)},[a,n]),e}();return(0,o.useEffect)(()=>{if(!n)return;let e=0;if(r){let t=(0,_.UN)();r.forEach(n=>{let a=t.get(n);a&&(0,nh.hV)(a,()=>{e++})})}t(e)},[r,n]),o.createElement("div",{className:X.cx.colorBg.m16.flex.flexColumn.b2.bRadius4.colorBorder.p4.wAuto.$},o.createElement("div",{className:X.cx.p4.$},o.createElement(tW.E,{className:X.cx.colorBg.$,onClick:()=>a(!n)},o.createElement("span",null,n?"\u25BC":"\u25B6"),o.createElement("span",{className:X.cx.ml2.textHeadingMedium.$},"Linter debug view")),n&&o.createElement(o.Fragment,null,o.createElement("div",{className:X.cx.grid.gridTemplateColumns2.gap2.pb4.$},o.createElement("div",{className:X.cx.textHeadingSmall.mr1.$},"Linter status:"),o.createElement("div",{className:X.cx.textBodyMedium.$},i),o.createElement("div",{className:X.cx.textHeadingSmall.mr1.$},"Linting target:"),o.createElement("div",{className:X.cx.textBodyMedium.$},`${r.join(",")}`),o.createElement("div",{className:X.cx.textHeadingSmall.mr1.$},"Linted nodes:"),o.createElement("div",{className:X.cx.textBodyMedium.$},e),o.createElement("div",{className:X.cx.textHeadingSmall.mr1.$},"Violations:"),o.createElement("div",{className:X.cx.textBodyMedium.$},c),o.createElement("div",{className:X.cx.textHeadingSmall.mr1.$},"Visual groups:"),o.createElement("div",{className:X.cx.textBodyMedium.$},l.size),o.createElement("div",{className:X.cx.textHeadingSmall.mr1.$},"Ungrouped violations:"),o.createElement("div",{className:X.cx.textBodyMedium.$},m)),o.createElement("div",{className:X.cx.textHeadingSmall.pt8.pb4.$},"Violations per rule"),o.createElement("ol",null,s.map(({rule:e,count:t})=>o.createElement("span",{key:e,className:X.cx.textBodyMedium.block.$},`${e}: ${t}`))),o.createElement("div",{className:X.cx.flex.flexColumn.gap4.pt4.w150.$},o.createElement(nv.$n,{onClick:()=>{d?.debugCopyGroupStateToClipboard()}},"Copy group state"),o.createElement(nv.$n,{onClick:()=>{d?.debugCopyViolationsStateToClipboard()}},"Copy violations state"),o.createElement(nv.$n,{onClick:()=>{d?.debugCopySimilarityGroupsToClipboard()}},"Copy similarity state")))))}var nN=n(527747);class nb{constructor(){this.fetchQueue=[],this.applyQueue=[],this.processing=new Set,this.MAX_CONCURRENT=3,this.intervalId=null,this.isProcessing=!1,this._lastYieldAt=0,this._TASK_DEADLINE_MS=1e3/60}startProcessingInterval(){this.intervalId||(this.intervalId=setInterval(()=>this.processQueues(),100))}maybeStopProcessingInterval(){this.intervalId&&0===this.fetchQueue.length&&0===this.applyQueue.length&&(clearInterval(this.intervalId),this.intervalId=null)}addToFetchQueue(e){return new Promise((t,n)=>{this.fetchQueue.push({violation:e,resolve:t,reject:n}),this.startProcessingInterval()})}addToApplyQueue(e){return new Promise((t,n)=>{this.applyQueue.push({violations:e,resolve:t,reject:n}),this.startProcessingInterval()})}async checkYield(){performance.now()-this._lastYieldAt>this._TASK_DEADLINE_MS&&(await this.yield(),this._lastYieldAt=performance.now())}yield(){return new Promise(e=>{setTimeout(e,0)})}async processQueues(){if(!this.isProcessing&&!(this.processing.size>=this.MAX_CONCURRENT)){this.isProcessing=!0;try{for(;this.applyQueue.length>0&&this.processing.size<this.MAX_CONCURRENT;){await this.checkYield();let e=this.applyQueue.shift();if(!e)break;let t=e.violations.map(e=>e.guid).join("-");this.processing.has(t)||(this.processing.add(t),this.processApplyItem(e,t))}for(;this.fetchQueue.length>0&&this.processing.size<this.MAX_CONCURRENT;){await this.checkYield();let e=this.fetchQueue.shift();if(!e)break;this.processing.has(e.violation.guid)||(this.processing.add(e.violation.guid),this.processFetchItem(e))}}finally{this.isProcessing=!1,this.maybeStopProcessingInterval()}}}async processFetchItem(e){try{let t=(0,nc.r)();if(!t)throw Error("Design linter not available");let n=await t.getFix(e.violation);e.resolve(n)}catch(t){console.error("Error fetching fix:",t),e.reject(t)}finally{this.processing.delete(e.violation.guid)}}async processApplyItem(e,t){try{let t;let n=(0,nc.r)();if(!n)throw Error("Design linter not available");for(let a of e.violations)try{if((t=await n.getFix(a))&&t.fixContext)break}catch(e){console.error("Error fetching fix for violation:",e);continue}if(!t?.fixContext)return;await n.applyFixContextToViolations(e.violations,t.fixContext),e.resolve()}catch(t){console.error("Error applying fix:",t),e.reject(t)}finally{this.processing.delete(t)}}}let nI=(0,o.createContext)(null);function nT({children:e}){let t=(0,o.useRef)(new nb);return o.createElement(nI.Provider,{value:t.current},e)}var nA=n(191797),nS=n(183324),nC=n(108951),nO=n(20389);class nP extends nO.JB{constructor(){super(!1),this.name="AbortError"}}var nx=n(296345),nw=(e=>(e.CURRENT="current",e.SUGGESTED="suggested",e))(nw||{});async function nk(e,t,n,a,o){if(t.aborted)throw new nP;let i=new _.qo(l.juq.LINTER).get(e);if(!i)throw Error("Attached node not found");if("suggested"===n&&a&&o){let e=(0,_.UN)().get(o);if(!e)throw Error("Original node not found");let n=function(e,t){let n=new Map,a=[],o=[];return(0,nx.eA)(e,e=>{a.push(e.guid)}),(0,nx.eA)(t,e=>{o.push(e.guid)}),a.forEach((e,t)=>{n.set(e,o[t]??"-1:-1")}),n}(e,i);await nc.r()?.applyFixesToThumbnailNode(a,n,t)}let[r,c]=function(e,t){if(!l.Vzr)throw Error("Thumbnail binding not available");let[n,a]=l.Vzr.generateThumbnailForNode(e,0,0,1,{inLinterScene:!0,type:"UNCOMPRESSED",scale:384/t});return[n,a]}(i.guid,i.size.x);if(t.aborted)throw new nP;return{width:r.width,height:r.height,image:c}}let nD="design_linter_preview--comparableThumbnail--OZpHJ",nM=[2,3,6,13,25,50,75,100,200,300,1e3],nR=o.memo(function(){let{rootNodeId:e,violatingNodeIdSet:t}=function(){let e=ny(),t=o.useMemo(()=>e?nm(e):void 0,[e]),n=o.useMemo(()=>e&&t?e.rootNodeIdToViolatingNodeIdSet.get(t)??new Set:new Set,[t,e]);return{rootNodeId:t,violatingNodeIdSet:n,hasValidGroup:!!e}}(),[n,a]=function(e,t){let[n,a]=o.useState((0,nA.Ok)()),[i,r]=o.useState((0,nA.Ok)()),c=o.useRef(null);return o.useEffect(()=>{let n=async e=>{let t=new AbortController;c.current=t;try{let n=await nk(e,t.signal,"current");a(n.image.length>0?(0,nA.NY)(n):(0,nA.uW)())}catch(e){e instanceof nP||(console.error("Error computing current image:",e),a((0,nA.uW)()))}},o=async(e,n)=>{let a=new AbortController;c.current=a;try{let o=await nk(n,a.signal,"suggested",t,e);r(o.image.length>0?(0,nA.NY)(o):(0,nA.uW)())}catch(e){e instanceof nP||(console.error("Error computing suggested image:",e),r((0,nA.uW)()))}};try{if(!e)return;a((0,nA.ux)()),r((0,nA.ux)());let t=l.mHF?.copyNodeToLinterScene(e);if(!t)throw Error("Attached guid not found");n(t),o(e,t)}catch(e){console.error("Error generating thumbnails: ",e)}return()=>{c.current?.abort()}},[e,t]),[n,i]}(e,t);return o.createElement(nL,{currentImage:n,suggestedImage:a})});function nL({currentImage:e,suggestedImage:t}){return o.createElement("div",{className:X.cx.bb1.bSolid.colorBorder.$},o.createElement(nS.qW,{zoomPercentageOptions:nM,zoomOnMousePointer:!1},o.createElement(nU,{asyncLoadedImage:e,containerStyle:"design_linter_preview--currentThumbnail---api0 design_linter_preview--_comparable--Hv79f",title:(0,d.t)("design_linter.preview.current")}),o.createElement(nU,{asyncLoadedImage:t,containerStyle:"design_linter_preview--suggestedThumbnail--GQkem design_linter_preview--_comparable--Hv79f",title:(0,d.t)("design_linter.preview.suggested")})))}function nU({asyncLoadedImage:e,title:t,containerStyle:n}){let a;let{image:i,isLoading:r}=o.useMemo(()=>(0,nA.xj)(e)?{isLoading:!1,image:{data:e.value.image,width:e.value.width,height:e.value.height,scale:2}}:(0,nA.Mx)(e)||(0,nA.yx)(e)?{isLoading:!0,image:null}:{isLoading:!1,image:null},[e]);return a=i?o.createElement(nC.ec,{className:nD,image:i}):r?o.createElement("div",{className:nD},o.createElement(eX.x,{isLoading:!0},()=>(0,d.tx)("design_linter.preview.thumbnail_unavailable"))):o.createElement("div",{className:nD},(0,d.tx)("design_linter.preview.thumbnail_unavailable")),o.createElement(nS.or,{title:(0,nA.xj)(e)?t:"",containerStyle:n,isDarkBackground:!1},a)}var nK=n(350693),nV=n(631437),nB=n(835379),nF=n(45623),nz=n(31524),nG=n(326331),n$=n(533294),nW=n(119087),nH=n(212521),nY=n(984988);let nX="design_linter_violation_group_row--chit--s-oKx paint_panels--chit--twQEy",nQ="design_linter_violation_group_row--currentColorHexBorderRadius--USgKl",nJ="design_linter_violation_group_row--chitWidth--aX7PB";function nj({violations:e}){let[t,n]=(0,o.useState)(!1),[a,i]=(0,o.useState)(!1),r=(0,o.useMemo)(()=>e.sort((e,t)=>e.guid.localeCompare(t.guid))[0],[e]),{fix:c,fixStatus:s}=function(e){let t=(0,o.useContext)(nI),[n,a]=(0,o.useState)(void 0),[i,r]=(0,o.useState)("fetching"),l=(0,o.useCallback)(async()=>{try{if(!t)throw Error("Fix orchestrator not available");if(!(0,nc.r)())throw Error("Design linter not available");for(let n of e??[]){let e=await t.addToFetchQueue(n);if(e){r("loaded"),a(e);break}}}catch(e){console.error("Error fetching fix:",e),r("error")}},[t,e]);return(0,o.useEffect)(()=>{l()},[l,e]),{fix:n,fixStatus:i}}(e),p=function(){let e=(0,o.useContext)(nI);return(0,o.useCallback)(async t=>{try{if(!e)throw Error("Fix orchestrator not available");await e.addToApplyQueue(t)}catch(e){var n,a,o;n=(0,d.t)("design_linter.penalty_box.fix_failed_bell"),a=nN.zX.EXCLAMATION,o="error",nd.D.dispatch(m.F.enqueue({message:n,type:o,icon:a,timeoutOverride:3e3}))}},[e])}(),u=(0,o.useCallback)(async()=>{c&&!t&&(n(!0),await p(e),n(!1))},[c,t,p,e]),_=(0,o.useCallback)(()=>{l.Egt?.replaceSelection(e.map(e=>e.guid),!0)},[e]);return r?o.createElement("div",{className:eW()(X.cx.flex.mx16.p8.$,{[X.cx.colorBgHover.bRadius5.$]:a}),onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1)},o.createElement("div",{className:X.cx.flex.itemsCenter.gap8.bRadius4.$},o.createElement("span",{className:eW()("design_linter_violation_group_row--tabularNumbers--RZ5HK",X.cx.colorTextSecondary.textBodyMediumStrong.selectNone.w32.$)},`(${e.length})`),o.createElement(nH.Bf,{guid:r.guid}),o.createElement(n1,{violation:r}),o.createElement("div",{className:X.cx.flex.itemsCenter.ml14.$},o.createElement(nK.o,{className:"design_linter_violation_group_row--iconTertiary--smOZe"}),o.createElement(nq,{fix:c,fixStatus:s})),a?o.createElement(o.Fragment,null,o.createElement(ez.K,{onClick:_,"aria-label":(0,d.t)("design_linter.penalty_box.select_nodes_aria")},o.createElement(nV.A,null)),o.createElement(ez.K,{disabled:!c?.valid,onClick:u,"aria-label":(0,d.t)("design_linter.penalty_box.accept_suggestion_aria")},t?o.createElement(tM.k,null):o.createElement(nB.r,null))):null)):null}function nq({fix:e,fixStatus:t}){if("fetching"===t)return o.createElement("div",{className:eW()(nJ,X.cx.flex.itemsCenter.p2.h24.radiusMedium.colorBorder.selectNone.b1.$)},o.createElement("span",{className:X.cx.flex.ml2.mr4.$},o.createElement(tM.k,{size:"sm"})),(0,d.t)("design_linter.penalty_box.loading_fix"));let{ruleId:n,fixContext:a,valid:i}=e??{};return e&&i&&a?n===ns.C.REQUIRE_FILL_COLOR_TOKENS||n===ns.C.REQUIRE_STROKE_COLOR_TOKENS?o.createElement(n0,{context:a}):n===ns.C.COMPONENT_MATCH?o.createElement(nZ,{context:a}):null:o.createElement("div",{className:eW()(nJ,X.cx.flex.itemsCenter.p2.h24.radiusMedium.colorBorder.selectNone.b1.$)},o.createElement(nF.Z,null),o.createElement("div",null,(0,d.t)("design_linter.penalty_box.no_fix_available")))}function nZ({context:e}){let[t,n]=(0,o.useState)(!1),[a,i]=(0,y.fp)(nt.uR),r=(0,o.useCallback)(e=>{i(e)},[i]);if(!e||!("targetNode"in e))return null;let l=e.components[a];return l?o.createElement("div",{className:"design_linter_violation_group_row--componentSuggestionContainer--JnH-w"},o.createElement("div",{className:eW()(nJ,t?X.cx.flex.itemsCenter.b1.bSolid.colorBorderOnselected.colorBg.radiusMedium.p2.$:X.cx.flex.itemsCenter.b1.bSolid.colorBorder.colorBg.radiusMedium.p2.$),onClick:()=>n(!t)},o.createElement("div",{className:eW()(nJ,X.cx.flex.itemsCenter.p2.h24.selectNone.$)},o.createElement(nz.y,null),o.createElement("div",null,l.name)),o.createElement(nG.r,{className:X.cx.pl8.bl1.bSolid.colorBorderBg.colorText.flex.itemsCenter.selectNone.h24.w40.$})),t?o.createElement("div",{className:eW()("design_linter_violation_group_row--componentMatchList--8XeMT",X.cx.b1.bSolid.colorBorder.colorBg.radiusLarge.pt16.pl16.$)},o.createElement("h1",{className:X.cx.textBodyMediumStrong.colorText.truncate.selectNone.mb16.$},(0,d.t)("design_linter.rules.component_match.dropdown_title")),e.components.map((e,t)=>o.createElement("div",{key:e.id,className:X.cx.textBodyMedium.colorText.truncate.selectNone.mb16.$},o.createElement("div",{className:eW()("design_linter_violation_group_row--thumbnailContainer--90PJq",X.cx.colorBgSecondary.selectNone.bRadius5.mr16.$,a===t?"design_linter_violation_group_row--selectedMatch--mCLxV":""),onClick:e=>{r(t),n(!1)}},o.createElement(eY.oW,{src:e.thumbnail_url,alt:e.name})),o.createElement("h3",null,e.name)))):null):null}function n0({context:e}){if(!("fixes"in e)||!("selection"in e))return null;let{fixes:t,selection:n}=e;if(!t||0===t.length)return null;let a=t[n??0];if(!a)return null;let{variableId:i,resolvedValue:r}=a,l=y.zl.get(nt.nE),c=l[i]?.name,s=r.value;return s&&c?o.createElement("div",{className:eW()(nJ,X.cx.flex.itemsCenter.b1.bSolid.colorBorder.colorBg.radiusMedium.p2.$)},o.createElement("div",{className:nX},o.createElement(nY.J,{color:s,opacity:s.a})),o.createElement("span",{className:X.cx.textBodyMedium.colorText.truncate.selectNone.$,"data-tooltip":c,"data-tooltip-type":"TEXT"},c)):null}function n1({violation:e}){let{ruleId:t,detectionContext:n}=e;return t===ns.C.REQUIRE_FILL_COLOR_TOKENS||t===ns.C.REQUIRE_STROKE_COLOR_TOKENS?o.createElement(n8,{context:n}):t===ns.C.COMPONENT_MATCH?o.createElement(n2,{context:n}):null}function n2({context:e}){return e&&"components"in e?o.createElement("div",{className:eW()(nJ,X.cx.flex.itemsCenter.b1.bSolid.colorBorder.radiusMedium.$)},o.createElement("div",{className:eW()(nJ,nQ,X.cx.flex.itemsCenter.h24.p2.justifyBetween.$)},o.createElement("div",{className:X.cx.flex.itemsCenter.$},o.createElement("div",{className:X.cx.ml4.textBodyMedium.colorText.selectNone.$},e.name)))):null}function n8({context:e}){if(!e||!("color"in e))return null;let t=e.color,n=e.opacity;return o.createElement("div",{className:eW()(nJ,X.cx.flex.itemsCenter.b1.bSolid.colorBorder.radiusMedium.$)},o.createElement("div",{className:eW()(nJ,nQ,X.cx.flex.itemsCenter.h24.p2.justifyBetween.$)},o.createElement("div",{className:X.cx.flex.itemsCenter.$},o.createElement("div",{className:eW()(nX,X.cx.mr4.$)},o.createElement(nY.J,{color:t,opacity:n})),o.createElement("div",{className:X.cx.textBodyMedium.colorText.selectNone.$},n$.TI.format(t)))),n?o.createElement("div",{className:eW()(X.cx.pl8.bl1.bSolid.colorBorderBg.colorText.flex.itemsCenter.selectNone.h24.w40.radiusMedium.$,"design_linter_violation_group_row--currentColorOpacity--kwVGB")},new nW.t6({min:0,max:100}).format(100*n),o.createElement("span",{className:X.cx.colorTextSecondary.pl12.pr6.selectNone.$},"%")):null)}let n3=o.memo(function(){let e=(0,y.md)(np),t=(0,y.md)(n_);return o.createElement(nT,null,o.createElement("div",{className:X.cx.flex.flexColumn.hFull.overflowYScroll.py8.$},t?.map(([t,n])=>o.createElement("div",{className:X.cx.flex.flexColumn.$,key:`${e}-${t}`},o.createElement(nj,{violations:n})))),o.createElement("div",{className:X.cx.flex.wFull.bt1.colorBorder.bSolid.justifyEnd.$},t?.length?o.createElement(n4,{violationRowEntries:t}):null))});function n4({violationRowEntries:e}){let{applyAll:t,isFixing:n}=function(e){let t=(0,o.useContext)(nI),[n,a]=(0,o.useState)(!1);return{applyAll:(0,o.useCallback)(async()=>{if(!n){if(!t)throw Error("Fix orchestrator not available");try{a(!0);let n=[];try{for(let a of e){let e=t.addToApplyQueue(a);n.push(e)}await Promise.allSettled(n)}catch(e){console.error("Error processing violation row:",e)}}finally{a(!1)}}},[t,n,e]),isFixing:n}}(e.map(([e,t])=>t)),a=(0,o.useCallback)(()=>{n||t()},[t,n]);return o.createElement("div",{className:X.cx.m8.$},o.createElement(nv.$n,{variant:"primary",onClick:a},(0,d.tx)("design_linter.penalty_box.apply_all")))}let n5=(0,o.memo)(function(){let e=function(){let e=ny();return e?.rootNodeIdToViolatingNodeIdSet.size??0}();return o.createElement("div",{className:X.cx.flex.flexColumn.colorBg.px16.py12.bb1.bSolid.colorBorder.$},o.createElement("div",{className:X.cx.fpl__textBodyMediumStrongFontFamily.fpl__textBodyMediumStrongFontSize.fpl__textBodyMediumStrongFontWeight.fpl__textBodyMediumStrongLineHeight.selectNone.$},(0,d.tx)("design_linter.visual_group.title",{count:e})))}),n7=(0,o.memo)(function(){return o.createElement("div",{className:X.cx.flex.flexColumn.colorBg.bl1.bSolid.colorBorder.hFull.wFull.overflowYScroll.$},o.createElement(n5,null),o.createElement(nR,null),(0,c.kc)().aip_flower_garden_debug&&o.createElement(nf,null),o.createElement(n3,null))});var n6=n(179220),n9=n(497858),ae=n(531629),at=n(398707);let an="16px",aa=o.memo(function(){let e=(0,o.useRef)(null),t=(0,y.md)(nE),n=(0,y.md)(nu),[a,i]=(0,y.fp)(np),r=(0,n6.Te)({count:t?.length??0,getScrollElement:()=>e.current,overscan:3,estimateSize:()=>174,getItemKey:e=>{let n=t[e];if(!n)return e;let a=nm(n);return a?`${n.id}-${a}`:n.id}});!function(){let e=(0,y.md)(nE),t=(0,y.md)(nt.Iy),[n,a]=(0,y.fp)(np);(0,o.useEffect)(()=>{if(n&&t.get(n))return;let o=e[0];o&&a(o.id)},[n,a,e,t])}();let l=n?n.y-40:400;return o.createElement("div",{ref:e,className:X.cx.minW250.overflowYScroll.$,style:{height:l}},o.createElement("div",{className:X.cx.wFull.relative.$,style:{height:r.getTotalSize()}},o.createElement("div",{className:X.cx.top0.left0.wFull.relative.$,style:{height:`${r.getTotalSize()}px`}},r.getVirtualItems().map(e=>{let n=t[e.index];if(!n)return null;let r=nm(n);if(!r)return null;let l=n.id===a;return o.createElement("div",{key:r,"data-index":e.index,className:X.cx.flex.justifyCenter.my12.absolute.top0.left0.wFull.$,style:{height:`${e.size-24}px`,transform:`translateY(${e.start}px)`}},o.createElement(ao,{setSelectedGroup:i,nodeId:r,groupId:n.id,isSelected:l}))}))))});function ao({nodeId:e,groupId:t,isSelected:n,setSelectedGroup:a}){let i=(0,n9.ei)(e),r=(0,at.yh)({nodeId:e,width:150,height:200,shouldSkip:!1,version:i?.lastEditedAt??"-",reason:"design-linter.thumbnail",regenerateAfterImagesLoaded:!0,isDevModeBlendedSection:!1}),l=(0,o.useCallback)(()=>{a(t)},[t,a]);return r?o.createElement(tW.E,{className:eW()(X.cx.h150.w200.p24.flex.itemsCenter.justifyCenter.overflowHidden.colorBgSecondary.b2.bRadius5.colorBorder.$,{[X.cx.colorBorderDesign.$]:n}),onClick:l},o.createElement(eY.oW,{src:r.src,className:eW()("design_linter_modal--objectFitContain--TLOt0",X.cx.maxWFull.maxHFull.$),alt:(0,d.t)("design_linter.penalty_box.thumbnail_alt")})):o.createElement(ae.Qp,{className:X.cx.h150.w200.b2.bRadius5.colorBorder.$,animationType:ae.JR.LIGHT_SHIMMER})}let ai=o.memo(function(){let e=function(){let e=function(){let e=(0,y.md)(nt.vo);return[na.t.DETECTING,na.t.DETECTION_REQUESTED,na.t.FINDING_SIMILARITY_GROUPS,na.t.GROUPING_PENDING].includes(e)}(),{status:t}=(0,y.md)(nt.v4),n=["uninitialized","loading"].includes(t);return e||n}(),t=(0,y.md)(nt.Iy).size>0;return e&&!t?o.createElement(ar,null,o.createElement(tM.k,null)):t?o.createElement("div",{className:X.cx.flex.hFull.$},o.createElement(aa,null),o.createElement(n7,null)):o.createElement(ar,null,o.createElement("div",{className:X.cx.p12.flex.justifyCenter.$},(0,d.tx)("design_linter.penalty_box.no_violations")))});function ar({children:e}){return o.createElement("div",{className:X.cx.flex.flexColumn.mt12.itemsCenter.$},e,(0,c.kc)().aip_flower_garden_debug&&o.createElement(nf,null))}let al=(0,ne.jz)(an);function ac(){return(0,nt.qZ)()?o.createElement(as,null):null}let as=o.memo(()=>{let e=(0,eA.J2)(l.Ez5.uiState().showDesignLinter),t=(0,y.md)(nt.FD);return(!function(){let e=(0,y.Xr)(nt.v4),t=(0,ni.pN)(),n=t.data?.libraryVariables,a=t.data?.libraryVariableSets;(0,o.useEffect)(()=>{if("errors"===t.status){e(e=>({...e,status:"error"}));return}if("loaded"!==t.status)return;let o=new AbortController,i=o.signal;return async function(){if(a&&n){for(let e=0;e<a.length;e+=2){if(i.aborted)return;let t=a.slice(e,e+2).map(e=>(0,no.RI)(e));await Promise.allSettled(t)}e({libraryVariables:n,libraryVariableSetIdToSet:a.reduce((e,t)=>(t.node_id&&(e[t.node_id]=t),e),{}),status:"loaded"})}}(),()=>{o.abort()}},[t.status,a,n,e])}(),!e||t)?null:o.createElement(ad,null)});function ad(){let e=t4.ox(),t=function(){let e=(0,e0.GQ)(),t=(0,o.useMemo)(()=>new tL.Mi(e+(0,ne.jz)(an),(0,ne.jz)(an)),[e]),[{windowInnerHeight:n,windowInnerWidth:a}]=(0,t9.A)((0,nn.l)(),300,{equalityFn:t3.c2});return{initialPosition:t,maxHeight:n-2*al,minHeight:250,minWidth:400,initialHeight:750,initialWidth:Math.min(a-2*al,850)}}(),n=function(){let e=(0,y.Xr)(nu);return(0,o.useMemo)(()=>t6()(t=>{e(t)},100),[e])}(),a=(0,o.useCallback)(e=>{e.size&&n(e.size)},[n]);return(0,g.h)(()=>{n({x:t.initialWidth,y:t.initialHeight})}),o.createElement(t5._L,{defaultWidth:t.initialWidth,defaultHeight:t.initialHeight,defaultPosition:{left:t.initialPosition.x,top:t.initialPosition.y},maxHeight:t.maxHeight,manager:e,onClose:({source:e})=>{"outside"!==e&&(l.Ez5?.uiState().showDesignLinter.set(!1),l.mHF?.clearLinterScene())},onTransform:a},o.createElement(G.vo,null,o.createElement(G.Y9,null,o.createElement(am,null)),o.createElement(G.nB,{padding:0,scrolling:"none"},o.createElement(ai,null))))}function am(){let e=ng();return o.createElement("div",{className:X.cx.p8.pl16.cursorDefault.selectNone.pr0.wFull.pl8.$},o.createElement("div",{className:X.cx.flex.flexRow.justifyBetween.itemsCenter.$},o.createElement("div",{className:X.cx.flex.textBodyMediumStrong.$},o.createElement("span",{className:X.cx.mr2.$},(0,d.tx)("design_linter.penalty_box.title")),o.createElement("span",null,e?`(${e})`:""))))}var ap=n(852938),au=n(223528),a_=n(296724),aE=n(900204),ag=n(46749),ay=n(68060),av=n(785657);function ah({children:e}){return o.createElement(av.G.Provider,{value:{loggerEventName:"design_navigate"}},o.createElement(ay.s.Provider,{value:{allowLibraryPublish:!0}},e))}var af=n(987337),aN=n(419339),ab=n(987711),aI=n(387017),aT=n(358769),aA=n(463918),aS=n(206276),aC=n(215514),aO=n(988241),aP=n(263159);let ax=(0,o.memo)(function(e){return(0,aP.jsxs)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:[(0,aP.jsx)("mask",{id:"fpl-icon-24-mail-a",fill:"#fff",children:(0,aP.jsx)("path",{fillRule:"evenodd",d:"M5.88 7h12.24a.88.88 0 0 1 .88.88v.82l-7 3.733L5 8.7v-.82A.88.88 0 0 1 5.88 7M4 8.99v7.13A1.88 1.88 0 0 0 5.88 18h12.24A1.88 1.88 0 0 0 20 16.12V7.88A1.88 1.88 0 0 0 18.12 6H5.88A1.88 1.88 0 0 0 4 7.88zm15 .843v6.287a.88.88 0 0 1-.88.88H5.88a.88.88 0 0 1-.88-.88V9.833l6.765 3.608.235.126.235-.126z",clipRule:"evenodd"})}),(0,aP.jsx)("path",{fill:"var(--color-icon)",d:"m19 8.7.47.882L20 9.3v-.6zm-7 3.733-.47.883.47.25.47-.25zM5 8.7H4v.6l.53.282zm-1 .31h1v-.02zm0-.02 1 .02v-.02zm16 .02-1-.02v.02zm0-.02h-1v.02zm-1 .843h1V8.167l-1.47.784zm-14 0 .47-.882L4 8.167v1.666zm6.765 3.608-.47.882zm.235.126-.47.882.47.251.47-.251zm.235-.126.471.882zM18.12 6H5.88v2h12.24zM20 7.88A1.88 1.88 0 0 0 18.12 6v2a.12.12 0 0 1-.12-.12zm0 .82v-.82h-2v.82zm-7.53 4.616 7-3.734-.94-1.764-7 3.733zM4.53 9.582l7 3.734.94-1.765-7-3.733zM4 7.88v.82h2v-.82zM5.88 6A1.88 1.88 0 0 0 4 7.88h2a.12.12 0 0 1-.12.12zM5 8.99v.02l-2-.04v.06zm-2 .02v7.11h2V9.01zm0 7.11A2.88 2.88 0 0 0 5.88 19v-2a.88.88 0 0 1-.88-.88zM5.88 19h12.24v-2H5.88zm12.24 0A2.88 2.88 0 0 0 21 16.12h-2a.88.88 0 0 1-.88.88zM21 16.12V9.01h-2v7.11zm-2-7.11v-.02l2 .04v-.06zm2-.02V7.88h-2v1.11zm0-1.11A2.88 2.88 0 0 0 18.12 5v2a.88.88 0 0 1 .88.88zM18.12 5H5.88v2h12.24zM5.88 5A2.88 2.88 0 0 0 3 7.88h2A.88.88 0 0 1 5.88 7zM3 7.88v1.11h2V7.88zm17 8.24V9.833h-2v6.287zM18.12 18A1.88 1.88 0 0 0 20 16.12h-2a.12.12 0 0 1 .12-.12zM5.88 18h12.24v-2H5.88zM4 16.12A1.88 1.88 0 0 0 5.88 18v-2a.12.12 0 0 1 .12.12zm0-6.287v6.287h2V9.833zm8.235 2.726L5.471 8.95l-.941 1.765 6.764 3.608zm.236.125-.236-.125-.94 1.765.235.125zm-.706-.125-.236.125.942 1.765.235-.126zm6.764-3.608-6.764 3.608.941 1.765 6.765-3.608z",mask:"url(#fpl-icon-24-mail-a)"})]})});var aw=n(137035),ak=n(136189),aD=n(515017),aM=n(19294),aR=n(907555),aL=n(364329),aU=n(828824);function aK(){let e=(0,b.e)({overlay:w.Dqt,priority:C.N.DEFAULT_MODAL});(0,N.E)(e.uniqueId,"commentThreadMobileAnnouncementClicked",()=>{(0,E.sx)("sidebar_announcement_mobile_app_download_prompt_modal_shown"),e.show({})});let t=(0,o.useCallback)(async()=>{(0,E.sx)("sidebar_announcement_mobile_app_download_prompt_email_me_cta_clicked"),await aD.Ay.post("/api/send_mobile_download_email"),e.complete()},[e]);return o.createElement(aR.h,{isShowing:e.isShowing,modalType:aL.q3.FEATURE_UPDATE,closeButtonStyle:aL.M_.ON_DARK,element:()=>o.createElement(aV,{onEmailClick:t}),trackingContextName:"mobile_comment_announcement",onClickPrimaryCta:e.complete,onClose:e.complete,onManualDismiss:e.complete})}function aV(e){return o.createElement("div",{className:"modal_comment_sidebar_announcement--container--5oh-p"},o.createElement("div",{className:"modal_comment_sidebar_announcement--imageContainer--Vuo-V"},o.createElement("img",{alt:"Background",src:(0,c.ck)("e19f2f58bc09414847ad59ff9228e07032e8842c"),className:"modal_comment_sidebar_announcement--image--lyA61"}),o.createElement("div",{className:"modal_comment_sidebar_announcement--spacer--m02YT"}),o.createElement(aU.T,null)),o.createElement("div",{className:"modal_comment_sidebar_announcement--textContainer--btaTy"},o.createElement("div",{className:"modal_comment_sidebar_announcement--title--eiyLq"},o.createElement(aM.E,{fontSize:24,fontWeight:"semi-bold"},(0,d.t)("rcs.mobile_comment_announcement.title"))),o.createElement("div",{className:"modal_comment_sidebar_announcement--description--Y8AJE"},o.createElement(aM.E,{fontSize:14},(0,d.t)("rcs.mobile_comment_announcement.description")))),o.createElement("div",{className:"modal_comment_sidebar_announcement--buttonsContainer--UTcgc"},o.createElement(nv.$n,{variant:"secondary",onClick:e.onEmailClick,iconPrefix:o.createElement(ax,null)},(0,d.t)("rcs.mobile_comment_announcement.email_download_link")),o.createElement(nv.$n,{variant:"primary",onClick:()=>{(0,E.sx)("sidebar_announcement_mobile_app_download_prompt_learn_more_cta_clicked"),ak.Ay.unsafeRedirect("https://help.figma.com/hc/articles/1500007537281-Guide-to-the-Figma-mobile-app#download","_blank")},iconPrefix:o.createElement(aw.b,null)},(0,d.t)("rcs.rcs_shared.learn_more"))))}var aB=n(131663),aF=n(536825),az=n(340818),aG=n(572304),a$=n(616662),aW=n(744952),aH=n(248591),aY=n(688572),aX=n(603275),aQ=n(899356),aJ=n(412634),aj=n(118931),aq=n(516090),aZ=n(878206),a0=n(876560),a1=n(871972),a2=n(926325),a8=n(765726),a3=n(701e3),a4=n(340868),a5=n(390816),a7=n(83661),a6=n(171946),a9=n(631511),oe=n(503965);let ot=(0,a9.ex)("prototype_action_info",function(){return o.createElement("div",{className:X.cx.flex.itemsCenter.justifyCenter.$},o.createElement(a6.B,{className:"prototype_action_info_tooltip--prototypeDestinationInfoIcon--GeQWS",svg:oe.A}),o.createElement("span",{className:X.cx.flexGrow1.m6.$,style:{maxWidth:144}},(0,d.tx)("proto.prototype_panel.use_the_circular_node_to_connect_the_selected_object_to_another_frame_tooltip")))},()=>({unconstrainWidth:!0})),on=(0,o.memo)(function(e){return(0,aP.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,aP.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M11.5 6a.5.5 0 0 1 .5.5V11a1 1 0 0 0 1 1h4.5a.5.5 0 0 1 0 1H13a2 2 0 0 1-2-2V6.5a.5.5 0 0 1 .5-.5",clipRule:"evenodd"})})});var oa=n(931294),oo=n(145087),oi=n(345202),or=n(444229),ol=n(935271),oc=n(983991),os=n(678632),od=n(399230),om=n(30231),op=n(75557);let ou=om.c$,o_=om.l6;function oE({action:e}){return o.createElement("div",{className:"prototype_action_dropdown--prototypeActionIcon--qChhY"},o.createElement(aX.U,{svg:(0,os.Yb)(e)},(0,os.av)(e)))}function og(e){let t=`prototype-action-select-${e.recordingKey}`,n=e.dropdownShown&&e.dropdownShown.type===t,a=(0,aj.E7)(e.action),r=(0,os.Yb)(a),l=(0,os.av)(a),c=(0,eD.GS)(),s=(0,i.d4)(od.ZM),d=new oo.js(c,s),m=new oo.Z6(c,s),p=n?d:m,u=!(0,i.d4)(e=>e.mirror.selectionProperties.isValidPrototypingSourceSelected??!0),_=o.useCallback(e=>e-24,[]),E=o.useCallback(e=>e+24,[]),[g,y]=o.useState(void 0),v=o.createElement(or.Q,{setMaxWidth:y,options:oy(e),formatOption:e=>e&&e.props.value?p.format(e.props.value):"",getIcon:()=>o.createElement(oE,{action:"NAVIGATE_TO"})}),h=eW()({[e.className??""]:!0,"prototype_action_dropdown--select--b3Ssx":!c}),f=o.createElement(aX.U,{svg:r},l);return o.createElement(o.Fragment,null,o.createElement(o_,{disabled:u,id:t,dataTestId:"action-select",className:h,chevronClassName:"prototype_action_dropdown--prototypeActionChevron--ZL1Q4",inputClassName:"prototype_action_dropdown--prototypeActionInputWithSvg--Atfua",property:e.action,formatter:p,onChange:e.onChange,dispatch:e.dispatch,dropdownShown:e.dropdownShown,icon:f,iconClassName:"prototype_action_dropdown--selectActionSvg--XfhUx",recordingKey:aW.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,oc.nl)(),dropdownAlignment:_,dropdownWidth:c?g:E},oy(e)),c&&v)}function oy(e){let t=(0,op.cJ)(),n=(0,eD.GS)(),a=o.createElement(ou,{key:"NONE",value:"NONE",icon:o.createElement(oE,{action:"NONE"}),recordingKey:aW.Pt(e,"clear-option"),disabled:!1}),i=o.createElement(ou,{key:"NAVIGATE_TO",value:"NAVIGATE_TO",icon:o.createElement(oE,{action:"NAVIGATE_TO"}),recordingKey:aW.Pt(e,"navigate-to-option"),disabled:!1}),r=o.createElement(ou,{key:"SWAP_STATE_TO",value:"SWAP_STATE_TO",icon:o.createElement(oE,{action:"SWAP_STATE_TO"}),recordingKey:aW.Pt(e,"swap-state-to-option"),disabled:!l.glU.isSelectionContainedInStateOrStateInstance()}),s=o.createElement(ou,{key:"GO_BACK",value:"GO_BACK",icon:o.createElement(oE,{action:"GO_BACK"}),recordingKey:aW.Pt(e,"back-option"),disabled:!1}),d=o.createElement(ou,{key:"SCROLL_TO",value:"SCROLL_TO",icon:o.createElement(oE,{action:"SCROLL_TO"}),recordingKey:aW.Pt(e,"scroll-to-option"),disabled:!1}),m=o.createElement(ou,{key:"OPEN_URL",value:"OPEN_URL",icon:o.createElement(oE,{action:"OPEN_URL"}),recordingKey:aW.Pt(e,"url-option"),disabled:!1}),p=o.createElement(ou,{key:"OPEN_OVERLAY",value:"OPEN_OVERLAY",icon:o.createElement(oE,{action:"OPEN_OVERLAY"}),recordingKey:aW.Pt(e,"open-overlay-option"),disabled:!1}),u=o.createElement(ou,{key:"SWAP_WITH",value:"SWAP_WITH",icon:o.createElement(oE,{action:"SWAP_WITH"}),recordingKey:aW.Pt(e,"swap-with-option"),disabled:!1}),_=o.createElement(ou,{key:"CLOSE_OVERLAY",value:"CLOSE_OVERLAY",icon:o.createElement(oE,{action:"CLOSE_OVERLAY"}),recordingKey:aW.Pt(e,"close-option"),disabled:!1}),E=o.createElement(ou,{key:"SET_VARIABLE",value:"SET_VARIABLE",icon:o.createElement(oE,{action:"SET_VARIABLE"}),recordingKey:aW.Pt(e,"set-variable"),disabled:!1}),g=(0,c.kc)().prototype_set_mode_action&&o.createElement(ou,{key:"SET_VARIABLE_MODE",value:"SET_VARIABLE_MODE",icon:o.createElement(oE,{action:"SET_VARIABLE_MODE"}),recordingKey:aW.Pt(e,"set-variable-mode"),disabled:!1}),y=!e.isNestedInConditional&&o.createElement(ou,{key:"CONDITIONAL",value:"CONDITIONAL",icon:o.createElement(oE,{action:"CONDITIONAL"}),recordingKey:aW.Pt(e,"conditional"),disabled:!1}),v=o.createElement(om.sK,{key:"first-divider"}),h=o.createElement(om.sK,{key:"second-divider"}),f=o.createElement(om.sK,{key:"third-divider"}),{getConfig:N}=(0,ol.I7)("exp_prototyping_reorder_actions"),b=!!N().getValue("new_ordering",!1),I=(0,c.kc)().sts_interaction_interop&&t?[r,s,d,v,E,y]:n?b?[a,v,i,r,s,d,m,h,E,g,y,f,p,u,_]:[a,v,i,r,s,d,m,h,p,u,_,f,E,g,y]:[a,v,i,r,s,h,E,g,y,d,m,f,p,u,_];if(e.showVideoActions&&!t){let t=[o.createElement(om.sK,{key:"fourth-divider"}),o.createElement(ou,{key:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",value:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",icon:o.createElement(oE,{action:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS"}),recordingKey:aW.Pt(e,"update-media-play-pause-options"),disabled:!1}),o.createElement(ou,{key:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",value:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",icon:o.createElement(oE,{action:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS"}),recordingKey:aW.Pt(e,"update-media-mute-unmute-options"),disabled:!1}),o.createElement(ou,{key:"UPDATE_MEDIA_SKIP_TO",value:"UPDATE_MEDIA_SKIP_TO",icon:o.createElement(oE,{action:"UPDATE_MEDIA_SKIP_TO"}),recordingKey:aW.Pt(e,"update-media-skip_to"),disabled:!1}),o.createElement(ou,{key:"UPDATE_MEDIA_SKIP_BY_OPTIONS",value:"UPDATE_MEDIA_SKIP_BY_OPTIONS",icon:o.createElement(oE,{action:"UPDATE_MEDIA_SKIP_BY_OPTIONS"}),recordingKey:aW.Pt(e,"update-media-skip-by-options"),disabled:!1})];I=I.concat(t)}return I.filter(Boolean)}var ov=n(140593),oh=n(983405),of=n(629851),oN=n(344386),ob=n(441907),oI=n(698020),oT=n(908367);let oA="prototype_action_verbose_title--actionNameInsertion--aF4kI",oS="prototype_action_verbose_title--actionName--qWJL3",oC="prototype_action_verbose_title--actionNameUI3--JAYsG",oO=()=>{let e=(0,i.d4)(e=>e.mirror.sceneGraph);return o.useMemo(()=>new oo.cP(e),[e])};function oP({action:e,isNestedInConditional:t,isNarrowPanel:n,onClick:a}){let i=(0,a3.YT)()===a3.Oz.TWO_COL,r=o.useContext(oN.c),c=i&&r===oN.P.LEFT,s=t||n,m=(0,ni.u)((0,aj.hS)(e.targetVariable)&&e.targetVariable&&"id"in e.targetVariable?e.targetVariable?.id:void 0),p=(0,aj.hS)(e.targetVariable)&&e.targetVariable&&"nodeFieldAlias"in e.targetVariable?(0,of.aA)(e.targetVariable.nodeFieldAlias.stablePathToNode,e.targetVariable.nodeFieldAlias.indexOrKey):void 0,u=m?.name??p?.name,_=oO(),E=new oo.Z6((0,eD.GS)()),g=(0,oo._X)(e),y=(0,aj.E7)(g),v=o.createElement(aX.U,{svg:(0,os.Yb)(y)},(0,os.av)(y)),h=e=>{if(!e.connectionType||(0,aj.gl)(e.connectionType))return null;let t=eW()({[oS]:!0,[oC]:i}),n=eW()({"prototype_action_verbose_title--actionDestination--JZ-gU":!0,"prototype_action_verbose_title--actionDestinationUI3--ZGxbq":i});switch(e.connectionType){case"NONE":case"SET_VARIABLE_MODE":case"OBJECT_ANIMATION":return null;case"INTERNAL_NODE":case"BACK":case"CLOSE":case"UPDATE_MEDIA_RUNTIME":{let a=e.transitionNodeID;if((0,aj.gl)(a))return o.createElement("div",{className:t},(0,d.t)("proto.variant_actions.mixed"));if(void 0===a)return null;let i=aG.dI(a),r=_.format(i);return o.createElement("div",{className:n},r)}case"URL":{let a=e.connectionURL;if(!a)return null;if((0,aj.gl)(a))return o.createElement("div",{className:t},(0,d.t)("proto.variant_actions.mixed"));return o.createElement("div",{className:n},a)}case"SET_VARIABLE":if(!e.targetVariableData||(0,aj.gl)(e.targetVariableData))return null;return o.createElement("div",{className:"prototype_action_verbose_title--setVariablePreviewContainer--6omxy"},o.createElement(a2.y3,{targetVariableData:e.targetVariableData,onClick:Y.lQ,showVariableThumbnails:!1,isNarrowPanel:s,isInConditional:!0}));case"CONDITIONAL":{if((0,aj.gl)(e)||(0,aj.gl)(e.conditionalActions)||!e.conditionalActions)return null;let t=e.conditionalActions.length>0?e.conditionalActions[0].condition:void 0;return o.createElement(a2.y3,{targetVariableData:t,onClick:Y.lQ,isInConditional:!0,showVariableThumbnails:!1})}default:(0,ov.xb)(e.connectionType)}},f=eW()({[X.cx.block.bgTransparent.$]:!0,"prototype_action_verbose_title--buttonResetTextAlign--gy69p":!0,[oT.Li]:s&&!i,[oT.O8]:!s&&!i,[oT.kE]:i}),N=eW()({"prototype_action_verbose_title--iconContainer--jqarD":!0,"prototype_action_verbose_title--iconContainerUI3--yBP0-":i});return o.createElement(tW.E,{className:f,onClick:a},o.createElement(oh.Y1,{horizontalAlignItems:"space-between",width:"fill-parent"},o.createElement("div",{className:N},v),(e=>{let t=y?E.format(y):"Undefined",n=eW()({[oS]:!0,[oC]:i});if((0,aj.gl)(e.connectionType)&&(t=(0,d.t)("fullscreen.mixed")),!e.connectionType||(0,aj.gl)(e.connectionType)||"NONE"===e.connectionType||"BACK"===e.connectionType||"CLOSE"===e.connectionType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t));var a=h(e);switch(e.connectionType){case"INTERNAL_NODE":if("SWAP_STATE"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,d.t)("proto.action_change_to")),a);if(a){if("OVERLAY"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:oA},(0,d.tx)("proto.action_overlay_title",{overlayFrameName:o.createElement("span",null,a)})));if("SWAP"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,d.t)("proto.action_swap_overlay_title")),a)}return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t),a);case"UPDATE_MEDIA_RUNTIME":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t),a);case"URL":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},a?(0,d.t)("proto.action_url_title"):(0,d.t)("proto.action_open_link")),a);case"SET_VARIABLE":{let r=e.targetVariableData&&(0,aj.hS)(e.targetVariableData)&&e.targetVariableData.resolvedType===l.rXF.COLOR,s=eW()({"prototype_action_verbose_title--actionNameInsertionColor--isir- prototype_action_verbose_title--actionNameInsertion--aF4kI":!0,"prototype_action_verbose_title--actionNameInsertionColorUI3--Apj0i":i});if(u&&a)return o.createElement(o.Fragment,null,o.createElement("div",{className:r?s:oA},(0,d.tx)("proto.action_set_variable_title",{variableName:o.createElement("span",{className:"prototype_action_verbose_title--variableNameContainer--XeJX2"},o.createElement(oI.wG,{text:u,isDeleted:!!m&&(0,ob.eF)(m),disableHover:c})),variableValue:o.createElement("span",{className:"prototype_action_verbose_title--variableDestinationContainer--RXbKo prototype_action_verbose_title--variableNameContainer--XeJX2"},a)})));return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t))}case"SET_VARIABLE_MODE":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,d.t)("proto.action_set_variable_mode")));case"CONDITIONAL":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},i?(0,d.t)("proto.if"):(0,d.t)("proto.action_conditional_title")),a);case"OBJECT_ANIMATION":return o.createElement(o.Fragment,null);default:(0,ov.xb)(e.connectionType)}})(e)))}var ox=n(396353),ow=n(177131),ok=n(789529),oD=n.n(ok),oM=n(636149),oR=n.n(oM),oL=n(675551),oU=n.n(oL),oK=n(184058),oV=n.n(oK),oB=n(237798),oF=n(870501),oz=n(649792),oG=n(270095),o$=n(882230),oW=n(458243);let oH="prototype_set_variable_mode_controls--dropdownRow--vl5z4",oY="missing",oX=om.l6,oQ=om.c$,oJ=om.l6,oj=om.c$,oq={},oZ=(0,oF.fv)();function o0(){let e=(0,ni.h6)()||oq,t=(0,o$.iR)(),n=o.useMemo(()=>{let n=oU()(t,(e,t)=>({collectionID:e.node_id,collectionName:e.name,key:e.key,modeOptions:e.modes?.map(t=>({modeId:{guid:t.id,collectionKey:e.key},name:t.name,isCompatible:!0}))||[],explicitMode:null,inheritMode:null,fileKey:oZ(e),libraryKey:e.library_key}));return oD()({},e,n)},[t,e]),a=o.useMemo(()=>Object.entries(n).map(([e,t])=>({setKey:e,modeData:t,isLocal:void 0===t.libraryKey})),[n]),r=o.useMemo(()=>Object.values(a).filter(e=>e.modeData?.modeOptions&&e.modeData?.modeOptions.length>1),[a]),c=o.useMemo(()=>oV()(r.map(e=>e.modeData.libraryKey??oW.CC)),[r]),s=(0,oz.U)(c),[m,p]=o.useMemo(()=>{let{_local:e,_unknownFile:t,...n}=oR()(r,e=>e.isLocal?"_local":e.modeData.libraryKey&&s.data?.[e.modeData.libraryKey]===void 0?"_unknownFile":e.modeData.libraryKey),a=Object.entries(n).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>[{libraryKey:e,fileName:s.data?.[e]??""},...t]).flat(1);return t&&(a.push({libraryKey:oW.CC,fileName:(0,d.t)("variables.mode_properties_panel.used_variables.subheading")}),a.push(...t)),[e??[],a]},[s,r]),u=(0,o$.d2)(),_=o.useCallback(e=>{let t=u[(0,ow.yG)(e)],n=r.find(t=>t.setKey===e);if(n)return(e=>{if(e)return void 0===t&&(t=e.modeData.modeOptions[0].modeId.guid),e.modeData.modeOptions.find(e=>e.modeId.guid!==t&&(t=e.modeId.guid,!0))?.modeId.guid})(n)},[u,r]),E=r.length>0?r[0]:void 0,g=E?.setKey,y=E?.modeData.collectionID,v=o.useMemo(()=>g&&_(g),[g,_]),h=(0,i.wA)();return{localVariableSets:m,allVariableSets:r,firstVariableSet:E,firstVariableSetID:y,firstVariableSetMode:v,getDefaultNewModeForVariableCollectionKey:_,reportAnalyticsEventWhenSelected:e=>{let t=l.mSn.getVariableSetInfoForSetModeAnalytics(e);h((0,aq.Zh)({name:"prototype.set_mode_select_variable_set",params:{...t}}))},subscribedVariableSetsWithSections:p}}function o1({targetVariableSetID:e,targetVariableModeID:t,deprecatedTargetVariableSetKey:n,updateSelectionProperties:a,recordingKey:i,actionIndexPath:r}){let{getDefaultNewModeForVariableCollectionKey:l,allVariableSets:c,reportAnalyticsEventWhenSelected:s}=o0(),{shouldShowAdvancedPrototypingPaywall:m,showAdvancedPrototypingVariablesModal:p}=(0,a3.zt)(),u=(0,eD.GS)();o.useEffect(()=>{if(!n||(0,aj.gl)(n))return;let e=c.find(e=>e.setKey===n);e?((0,oB.Lo)("SetVariableModeControls","updating variable set key to non-deprecated id value"),a({targetVariableSetKey:void 0,targetVariableSetID:e?.modeData.collectionID})):((0,oB.Lo)("SetVariableModeControls","attempted to update variable set key to non-deprecated id value, but could not find it in the list of variable sets, will just clear out the bad data."),a({targetVariableSetKey:void 0}))},[n,c,a]);let[_,E]=o.useMemo(()=>{let t=(0,aj.gl)(e)||void 0===e?e:function(e,t){let n=e.find(e=>e.modeData.collectionID===t);if(n)return n;let a=ox.gr.toRefIfSubscribed(t);if(a)return e.find(e=>e.setKey===a.key)}(c,e)||oY,n=(()=>{if(!(0,aj.gl)(t)&&void 0!==t&&t!==oY)return t})();return[t,n]},[e,c]),g=o.createElement(o3,{selectedVariableSet:_,onChange:e=>{m?p():(s(e.modeData.collectionID),a({targetVariableSetID:e.modeData.collectionID,targetVariableModeID:l(e.setKey)}))},actionIndexPath:r}),y=u?o.createElement(oG.cS,{input:g,label:(0,d.tx)("proto.set_variable_mode.collection_label")}):o.createElement(a7.fI,{recordingKey:aW.Pt(i,"selectTargetVariableSet")},g),v=o.createElement(o7,{selectedVariableSetKey:E&&E.setKey,selectedVariableModeID:t,onChange:e=>{m?p():a({targetVariableModeID:e})},actionIndexPath:r}),h=u?o.createElement(oG.cS,{input:v,label:(0,d.tx)("proto.set_variable_mode.mode_label")}):o.createElement(a7.fI,{recordingKey:aW.Pt(i,"selectTargetVariableMode")},v);return o.createElement("div",{className:u?void 0:X.cx.relative.$},y,E&&h)}let o2={format:e=>void 0===e?(0,d.t)("proto.prototype_panel.edit_set_mode.none"):e===oY?(0,d.t)("proto.prototype_panel.edit_set_mode.missing_collection"):e.modeData.collectionName,isEqual:(e,t)=>void 0!==e&&void 0!==t&&e!==oY&&t!==oY&&(e.setKey===t.setKey||e.modeData.collectionID===t.modeData.collectionID)};function o8(e,t){return"libraryKey"in e?[t&&o.createElement(om.sK,{key:e.libraryKey+"divider"}),o.createElement(oQ,{isHeader:!0,key:e.libraryKey+"header",formattedValue:e.fileName})]:o.createElement(oQ,{key:e.setKey,value:e})}function o3({selectedVariableSet:e,onChange:t,actionIndexPath:n}){let a=(0,i.wA)(),r=(0,oi.Um)(),l="set-variable-mode--select-variable-set-"+n,{localVariableSets:s,allVariableSets:m,subscribedVariableSetsWithSections:p}=o0();return o.createElement(oX,{id:l,className:oH,property:e,formatter:o2,dispatch:a,dropdownShown:r?.type===l?r:null,onChange:e=>{(0,aj.gl)(e)||void 0===e||e===oY||t(e)}},m.length>0?[s.length>0&&o.createElement(oQ,{key:aW.Pt(l,"local_variables"),isHeader:!0,formattedValue:(0,c.kc)().ds_variable_props_unified_ui?(0,d.t)("variables.mode_properties_panel.assets_created_in_file.subheading"):(0,d.t)("variables.mode_properties_panel.local_variables.subheading")}),...s.map(e=>o8(e,!1)),...p.map((e,t)=>o8(e,s.length>0||t>0))]:[])}let o4={format:e=>void 0===e?(0,d.t)("proto.prototype_panel.edit_set_mode.none"):e===oY?(0,d.t)("proto.prototype_panel.edit_set_mode.missing_mode"):e?.name??""};function o5(e){return o.createElement(oj,{key:e.modeId.guid,value:e})}function o7({selectedVariableSetKey:e,selectedVariableModeID:t,onChange:n,actionIndexPath:a}){let r=(0,i.wA)(),l=(0,oi.Um)(),c="set-variable-mode--select-variable-mode-"+a,{allVariableSets:s}=o0(),d=o.useMemo(()=>s.find(t=>t.setKey===e)?.modeData.modeOptions,[e,s]),m=o.useMemo(()=>(0,aj.gl)(t)||void 0===t?t:d?.find(e=>e.modeId.guid===t)||oY,[t,d]);return o.createElement(oJ,{id:c,className:oH,property:m,formatter:o4,dispatch:r,dropdownShown:l?.type===c?l:null,onChange:e=>{!e||(0,aj.gl)(e)||e===oY||n(e.modeId.guid)}},d&&d?.map(o5))}var o6=n(963989),o9=n(532214),ie=n(360986),it=n(447657),ia=n(447716),io=n(256296),ii=n(320012),ir=n(567428),il=n(888943),ic=n(294614),is=n(543653),id=n(769612),im=n(132540),ip=n(910392),iu=n(909666),i_=n(442458);let iE=n$.TI;function ig({children:e}){return(0,eD.GS)()?o.createElement(oG.TN,null,e):o.createElement(a7.fI,{className:"overlay_panel--fplCheckboxRow--EYTAZ checkbox--_checkboxRow--oEhow"},e)}function iy({interactionType:e,recordingKey:t,actionIndexPath:n,nodeId:a}){let[r,c]=o.useState(!1),[s,m]=o.useState(new tL.Mi),p=(0,i.wA)(),u=(0,eD.GS)(),_="{ "+n.join(", ")+" }",{destinationOverlayBackgroundColor:E,destinationOverlayBackgroundType:g,destinationOverlayPositionType:y,destinationOverlayBackgroundInteraction:v}=(0,o9.R)(e=>({destinationOverlayBackgroundColor:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[_]?.destinationOverlayBackgroundColor,destinationOverlayBackgroundType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[_]?.destinationOverlayBackgroundType,destinationOverlayPositionType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[_]?.destinationOverlayPositionType,destinationOverlayBackgroundInteraction:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[_]?.destinationOverlayBackgroundInteraction})),h=o.useRef(null),f=o.useRef(null),N=o.useCallback(()=>{c(!1)},[c]),b=o.useCallback(()=>{if(r)N();else{c(!0);let e=u?f.current:h.current;m((0,ir.cn)(e))}},[r,N,u]),I=o.useCallback(e=>{let t=e?"SOLID_COLOR":"NONE";az.l7.user("overlay-background-type-edit-scope",()=>{l.X3B.setOverlayBackgroundType(aG.dI(a),t)}),p((0,aq._P)({name:"Overlay background visible changed",params:{backgroundType:t}}))},[p,a]),T=o.useCallback(e=>{let t=e?"CLOSE_ON_CLICK_OUTSIDE":"NONE";az.l7.user("overlay-background-interaction-edit-scope",()=>{l.X3B.setOverlayBackgroundInteraction(aG.dI(a),t)}),p((0,aq._P)({name:"Overlay background interaction changed",params:{backgroundInteraction:t}}))},[p,a]),A=o.useCallback(()=>(0,aj._W)(E,{r:0,g:0,b:0,a:.25}),[E]),S=o.useCallback((e,t)=>{t!==ii.zk.NO&&az.l7.user("overlay-background-color-edit-scope",()=>{l.X3B.setOverlayBackgroundColor(aG.dI(a),e)})},[a]),C=o.useCallback((e,t)=>{S(e,ii.zk.YES)},[S]),O=o.useCallback((e,t)=>{let n=A();S({r:n.r,g:n.g,b:n.b,a:e},t)},[A,S]),P=o.useCallback(e=>{az.l7.user("overlay-position-type-edit-scope",()=>{l.X3B.setOverlayPositionType(aG.dI(a),e)}),p((0,aq._P)({name:"Overlay position changed",params:{position:e}}))},[p,a]),x=A(),w=A().a,k=(0,aj.E7)(y),D="CLOSE_ON_CLICK_OUTSIDE"===(0,aj.E7)(v),M="SOLID_COLOR"===(0,aj.E7)(g),R=o.createElement("div",{className:"overlay_panel--colorValueContainer--gJtb9 paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t"},o.createElement(nY.J,{onClick:M?b:()=>{},color:x,opacity:w,recordingKey:aW.Pt(t,"chit"),className:"overlay_panel--chit--Zn66r paint_panels--chit--twQEy"}),o.createElement(is.AN,{className:u?"overlay_panel--colorInputUI3--ozOrK paint_panels--colorInput--nSz13":"overlay_panel--colorInput--6yyym paint_panels--colorInput--nSz13",noLeftBorder:!0,formatter:iE,property:x,disabled:!M,onChange:C,recordingKey:aW.Pt(t,"colorInput"),noBorderOnFocus:!0}),o.createElement(il.Pd,{className:"overlay_panel--opacity--vrrjV paint_panels--opacityInputContainer--oqlsk",value:w,onValueChange:O,dispatch:p,disabled:!M,noBorderOnFocus:!0,recordingKey:aW.Pt(t,"opacity")}));return o.createElement(a7.Zk,{className:u?"overlay_panel--overlayPanelUI3--GLqgD":"overlay_panel--overlayPanel--l-Hts"},!u&&o.createElement(a7.fI,null,o.createElement(a7.xw,{faded:!0,className:"overlay_panel--overlayPanelTitle--e9pjs"},(0,d.tx)("proto.overlay_settings"))),o.createElement(iA,{overlayPositionType:k,onOverlayPositionTypeChange:P,recordingKey:t}),!("ON_HOVER"===e||"ON_PRESS"===e)&&o.createElement(ig,null,o.createElement(ia.S,{label:o.createElement(io.J,null,(0,d.tx)("proto.close_when_clicking_outside")),recordingKey:aW.Pt(t,"closeOnClickOutside"),onChange:T,checked:D})),o.createElement(ig,null,o.createElement(ia.S,{label:o.createElement(io.J,null,u?(0,d.tx)("proto.overlay_panel.background"):(0,d.tx)("proto.add_background")),recordingKey:aW.Pt(t,"addBackgroundBehindOverlay"),onChange:I,checked:M})),M&&(u?o.createElement(oG.cS,{ref:f,label:(0,d.tx)("proto.overlay_panel.background"),input:R}):o.createElement(a7.fI,{ref:h}," ",R," ")),r&&o.createElement(ic.h3,{disabledVariableIds:new Set,initialPosition:s,color:x,boundVariable:null,onChange:S,onClose:N,recordingKey:aW.Pt(t,"colorPicker")}))}let iv=om.l6,ih=om.c$;class iN extends o.PureComponent{constructor(){super(...arguments),this.titleFormatter=new oo.Cr,this.renderOverlayPositionOption=(e,t)=>o.createElement(ih,{key:t,value:e,recordingKey:aW.Pt(this.props,e)})}render(){let e=["CENTER","TOP_LEFT","TOP_CENTER","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT"].map(this.renderOverlayPositionOption);return o.createElement(iv,{id:this.props.recordingKey??"overlay-position_select",className:this.props.className,chevronClassName:"overlay_panel--chevron--7RTA-",inputClassName:"overlay_panel--input--tGHHB",dropdownWidth:im.DxS,property:this.props.property,formatter:this.titleFormatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,recordingKey:aW.Pt(this.props,"select")},e,o.createElement(om.sK,null),this.renderOverlayPositionOption("MANUAL",10))}}iN.displayName="OverlayPositionDropdown";class ib extends id.I{}class iI extends id.Y{}class iT extends o.PureComponent{render(){return o.createElement(ib,{className:this.props.className,property:this.props.property,onChange:this.props.onChange,recordingKey:this.props.recordingKey},o.createElement(iI,{value:"CENTER",tooltip:(0,d.t)("proto.tooltip_overlay_position_center"),svg:iu.A,recordingKey:aW.Pt(this.props,"center")}),o.createElement(iI,{value:"TOP_LEFT",tooltip:(0,d.t)("proto.tooltip_overlay_position_top_left"),svg:i_.A,recordingKey:aW.Pt(this.props,"top-left")}),o.createElement(iI,{value:"BOTTOM_CENTER",tooltip:(0,d.t)("proto.tooltip_overlay_position_bottom_center"),svg:ip.A,recordingKey:aW.Pt(this.props,"bottom-center")}))}}function iA({overlayPositionType:e,onOverlayPositionTypeChange:t,recordingKey:n}){let a=(0,eD.GS)(),r=(0,i.wA)(),l=(0,oi.Um)(),c=o.createElement(iN,{className:"overlay_panel--overlayPositionDropdown--ZxxSI",property:e,dispatch:r,dropdownShown:l,onChange:t,recordingKey:aW.Pt(n,"overlayPositionDropdown")}),s=o.createElement(iT,{property:e,onChange:t,recordingKey:aW.Pt(n,"overlayPositionControl"),className:"overlay_panel--overlayPositionControl--SWngJ"});return a?o.createElement(oG.cS,{label:(0,d.tx)("proto.overlay_panel.position"),input:c}):o.createElement(a7.fI,null,c,s)}var iS=n(977747),iC=n(791970),iO=n(927457),iP=n(474538),ix=n(500440),iw=n(501191);let ik=e=>`interaction-panel-create-action-${e}`;function iD(e){let t=ik(e.recordingKey);var{showing:n,toggle:a,hide:r}=(0,oi.BK)(t);let l=(0,o.useRef)(null),{recordingKey:c,addButtonPressed:s,presetInteractions:m}=e,{shouldShowAdvancedPrototypingPaywall:p,showAdvancedPrototypinglMultipleActionsModal:u}=(0,a3.zt)(),_=(0,o.useCallback)(()=>{!e.skipPaywall&&p?u():a()},[e.skipPaywall,p,u,a]),E=(0,a3.YT)()===a3.Oz.TWO_COL,g=(0,a3.hP)(),y=(0,eD.GS)(),h=(0,op.cJ)(),f=(0,a3.He)({showVideoActions:g,isNestedInConditional:e.isNestedInConditional,isSites:h,isUI3:y,showPresetActions:!!e.presetInteractions}),N=(0,i.wA)(),b=(0,o.useCallback)(e=>{s((0,a3.Bs)(e)),r()},[s,r]),I=eW()({[oT.x1]:e.renderButton,[oT.xm]:!e.renderButton&&!E,[oT.U3]:!e.renderButton&&E}),T=[];f.forEach(e=>{(0,a3.vc)(e)?T.push(iP.w):e===a3.Xk&&m?.length?T.push(...m,iP.w):T.push(function({actionType:e,clickCb:t,recordingKey:n,isUI3:a}){let i=(0,os.Yb)(e),r=(0,os.av)(e),l=new oo.Z6(a),c=e?l.format(e):"Undefined";return{className:oT.BP,callback:()=>t(e),icon:o.createElement(aX.U,{className:oT.QE,svg:i},r),displayText:c,recordingKey:aW.Pt(n,"createActionOption",e)}}({clickCb:b,recordingKey:c,actionType:e,isUI3:y}))});let A=e.isNestedInConditional?(0,d.t)("proto.prototype_panel.add_nested_action"):(0,d.t)("proto.prototype_panel.add");return o.createElement(o.Fragment,null,o.createElement(v.e6,{ref:l,recordingKey:aW.Pt(c,"createActionDropdown"),className:I,onClick:_,"aria-label":(0,d.t)("proto.prototype_panel.create_action_button"),htmlAttributes:{"data-tooltip":A,"data-tooltip-type":"text"}},e.renderButton?o.createElement(aX.U,{svg:iw.A},o.createElement(iO.e,null)):(0,d.tx)("fullscreen.properties_panel.click_plus_to_add_new_action")),n&&l.current&&o.createElement(ix.j,{minWidth:130,lean:"center",parentRect:l.current.getBoundingClientRect(),hidePointWhenContentOffScreen:!0,showPoint:!0,items:T,dispatch:N,onSelectItem:e=>e.callback?.(),recordingKey:"actionDropdown"}))}let iM="prototype_conditional_controls--conditionalRowUI3--rQlu6",iR="prototype_conditional_controls--conditionIcon--Npk57";var iL=n(381809),iU=n(527967),iK=n(5068);function iV({onDeleteAction:e,updateMultipleDestinationNodes:t,updateSelectionProperties:n,updateCondition:a,updateActions:i,onAddAction:r,autoOpenVariablePicker:c,isSelected:s,handleMouseDownUI3:m,...p}){let u=p.conditionalActions,_=u?.actions?u?.actions:[],E=u?.condition?u?.condition:void 0,g=(0,a3.YT)()===a3.Oz.TWO_COL,y=g?iM:"prototype_conditional_controls--conditionalRowIf--25FqB prototype_conditional_controls--conditionalRow--u0PaS",v=o.createElement(a2.KN,{resolvedType:l.rXF.BOOLEAN,targetVariableData:E,updateSelectionProperties:n,recordingKey:p.recordingKey,updateConditionInConditionalAction:a,showVariableThumbnails:!0,isNarrowPanel:!0}),h=o.createElement("div",{className:"prototype_conditional_controls--addButton--vlYLn"},o.createElement(iD,{addButtonPressed:r,recordingKey:aW.Pt(p.recordingKey,"addActionToIfButton"),renderButton:!0,isNestedInConditional:!0})),f=o.createElement(o.Fragment,null,g?o.createElement("span",{className:"prototype_conditional_controls--conditionIconUI3--zcwx0"},(0,d.tx)("proto.else")):o.createElement(a6.B,{className:iR,svg:iL.A}),!g&&_.length>0&&o.createElement("div",{className:"prototype_conditional_controls--addButtonForElse--ogBWu prototype_conditional_controls--addButton--vlYLn"},o.createElement(iD,{addButtonPressed:r,recordingKey:aW.Pt(p.recordingKey,"addActionToElseButton"),renderButton:!g,isNestedInConditional:!0}))),N=g?o.createElement(tW.E,{className:"prototype_conditional_controls--elseBlockRowUI3--VXjmO",onClick:m},f):o.createElement(a7.fI,{className:g?iM:"prototype_conditional_controls--conditionalRow--u0PaS"},f);return o.createElement(o.Fragment,null,p.ifStatement&&o.createElement("div",{className:y},!g&&o.createElement(a5.Y,{direction:"horizontal",spacing:4},o.createElement("span",{className:g?"prototype_conditional_controls--conditionalRowConditionUI3--M2mOx":"prototype_conditional_controls--conditionalRowCondition--kn-f7"},o.createElement(a5.Y,{direction:"horizontal",spacing:0},o.createElement(a6.B,{className:iR,svg:iU.A}),o.createElement(a5.Y,{direction:"horizontal",spacing:0},(0,aj.hS)(E)&&v),o.createElement(a6.B,{className:"prototype_conditional_controls--icon--JV1i0",svg:iK.default}))),!g&&_.length>0&&h)),!p.ifStatement&&N,_&&_.map((a,i)=>o.createElement(rk,{key:i,updateMultipleDestinationNodes:t.appendActionIndex(i),action:a,recordingKey:aW.Pt(p.recordingKey,"conditional-action-row",i),updateSelectionProperties:n.appendActionIndex(i),onDeleteAction:()=>e(i),interactionType:p.interactionType,actionIndexPath:[p.actionIndexPath[0],p.actionIndexPath[1],i],numActions:_.length,isNestedInConditional:!0,stateManagementVersion:p.stateManagementVersion,selectedInteractions:p.selectedInteractions,onDrop:p.onDrop,onSelect:p.onSelect,onExpand:p.onExpand,onAddAction:r,selectedActionIndex:p.selectedActionIndex,expandedRows:p.expandedRows,autoOpenVariablePicker:c})),0===_.length&&o.createElement(rk,{key:0,updateMultipleDestinationNodes:t.appendActionIndex(0),action:p.emptyAction,recordingKey:aW.Pt(p.recordingKey,"conditional-action-row",0),updateSelectionProperties:n.appendActionIndex(0),onDeleteAction:()=>e(0),interactionType:p.interactionType,actionIndexPath:[p.actionIndexPath[0],p.actionIndexPath[1],0],numActions:_.length,isNestedInConditional:!0,stateManagementVersion:p.stateManagementVersion,selectedInteractions:p.selectedInteractions,onDrop:p.onDrop,onSelect:p.onSelect,onExpand:p.onExpand,onAddAction:r,selectedActionIndex:p.selectedActionIndex,expandedRows:p.expandedRows,autoOpenVariablePicker:c}))}function iB(e,t,n){return function(a){var o=[...t];o.length>e?o[e].condition=a:o.push({condition:0===e?a:void 0,actions:[]},{condition:1===e?a:void 0,actions:[]}),n({conditionalActions:o})}}function iF({onDrop:e,onSelect:t,onExpand:n,action:a,updateMultipleDestinationNodes:r,updateSelectionProperties:l,interactionType:c,recordingKey:s,stateManagementVersion:m,selectedInteractions:p,actionIndexPath:u,selectedActionIndex:_,expandedRows:E,autoOpenVariablePicker:g,onNewActionAdded:y,handleMouseDownUI3:v}){let h=(0,i.wA)(),f=(0,el.p8)("currentPage"),N=(0,a3.YT)()===a3.Oz.TWO_COL,b=N?_.equals(u):void 0,{shouldShowAdvancedPrototypingPaywall:I,showAdvancedPrototypingConditionalActionsModal:T}=(0,a3.zt)(),A=(0,aj.hS)(a.conditionalActions)&&a.conditionalActions?a.conditionalActions:[],S=e=>function(t){var n=[...A];n.length>e?n[e].actions=[...t]:n.push({actions:t}),l({conditionalActions:n})},C=e=>function(t){var n=[...A],a=0;if(n.length>e){var o=n[e].actions;o?o.push(t):o=[t],a=o.length}else n.push({actions:0===e?[t]:[]},{actions:1===e?[t]:[]}),a=1;"SET_VARIABLE"===t.connectionType&&(g.current=!0),l({conditionalActions:n}),y&&y(new iC.Op([u[0],e,a-1])),h((0,aq._P)({name:"Prototype add action",params:{action:t.connectionType?t.connectionType:"NONE",source:"panel",page_id:f,actionInConditionalAction:!0}}))},O=e=>function(t){if(I)T();else{var n=[...A];let a=A[e],o=[];if(a&&a.actions)for(let e=0;e<a.actions.length;e++){let n=a.actions[e];e!==t?o.push(n):h((0,aq._P)({name:"Prototype delete action",params:{action:n.connectionType?n.connectionType:"NONE",source:"panel",page_id:f,actionInConditionalAction:!0}}))}n[e].actions=o,l({conditionalActions:n})}},P=A.length>0?A[0]:void 0,x=A.length>1?A[1]:void 0;return o.createElement("div",{style:N?{position:"relative"}:void 0},(0,aj.gl)(a.conditionalActions)&&o.createElement(oh.Y1,null,o.createElement(tW.E,{className:"prototype_conditional_controls--mixedConditionalText--6O32b",onClick:()=>{var e=[];e.push({},{}),l({conditionalActions:e})}},(0,d.t)("fullscreen.properties_panel.click_to_replace_mixed_content"))),(0,aj.hS)(a.conditionalActions)&&o.createElement(o.Fragment,null,o.createElement(iV,{key:0,conditionalActions:P,recordingKey:aW.Pt(s,"conditional-block",0),updateCondition:iB(0,A,l),updateActions:S(0),onAddAction:C(0),updateMultipleDestinationNodes:r.appendActionIndex(0),onDeleteAction:O(0),interactionType:c,updateSelectionProperties:l.appendActionIndex(0),ifStatement:!0,stateManagementVersion:m,selectedInteractions:p,actionIndexPath:[u[0],0],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:_,autoOpenVariablePicker:g,expandedRows:E,emptyAction:{ifStatement:!0,action:a},isSelected:b,handleMouseDownUI3:v}),o.createElement(iV,{key:1,conditionalActions:x,recordingKey:aW.Pt(s,"conditional-block",1),updateCondition:iB(1,A,l),updateActions:S(1),onAddAction:C(1),updateMultipleDestinationNodes:r.appendActionIndex(1),onDeleteAction:O(1),interactionType:c,updateSelectionProperties:l.appendActionIndex(1),ifStatement:!1,stateManagementVersion:m,selectedInteractions:p,actionIndexPath:[u[0],1],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:_,autoOpenVariablePicker:g,expandedRows:E,emptyAction:{ifStatement:!1,action:a},isSelected:b,handleMouseDownUI3:v})))}function iz({updateSelectionProperties:e,conditionalActions:t,autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,...i}){let r=t.length>0?t[0]:void 0,c=r?.condition?r?.condition:void 0,s=eW()({"prototype_conditional_controls--standaloneIfConditional--GLFDU":!0,"prototype_conditional_controls--placeholderText--esG0u":!c});return o.createElement(o.Fragment,null,o.createElement(oG.cS,{input:null,label:(0,d.tx)("proto.condition")}),o.createElement(o6.Ad,{appendedClassName:"prototype_conditional_controls--conditionalActionRightPadding--xpK6Z",label:null,input:(0,aj.hS)(c)?o.createElement("div",{className:s},o.createElement(a2.KN,{resolvedType:l.rXF.BOOLEAN,targetVariableData:c,updateSelectionProperties:e.appendActionIndex(0),recordingKey:i.recordingKey,updateConditionInConditionalAction:iB(0,t,e),autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,showVariableThumbnails:!0,isNarrowPanel:!0})):null}))}var iG=n(650947),i$=n(806285),iW=n(845412),iH=n(328628);let iY=om.c$,iX=om.l6;function iQ(e){let t=o.useMemo(()=>new oo.cP(e.scene),[e.scene]),[n,a]=o.useState([]),[i,r]=o.useState([]),c=(0,op.cJ)(),s=e.nodeId===aj.oV?aj.oV:aG.dI(e.nodeId),d=n;(0,aj.hS)(s)&&s!==aG.AD&&-1===d.indexOf(s)&&(d=d.concat([s]));let m=`prototype-destination-select-${e.recordingKey}`,p="SCROLL_TO"!==e.action?d.filter(e=>t.hasNameForNode(e)).map((t,n)=>o.createElement(iY,{key:`enabled-${t}`,value:t,recordingKey:aW.Pt(e,`viable-option-${n}`),disabled:!1})):((n,a)=>{let i=oR()(n.filter(e=>t.hasNameForNode(e)),t=>t===a&&(0,aj.hS)(a)?nh.Ql(e.scene,t)?.guid:e.scene.get(t)?.parentGuid),r=Object.keys(i);(0,nh.X4)(r,t.format.bind(t));let{tlfId:l,index:c}=(0,nh.H_)(e.scene,r);return l&&c&&(r.splice(c,1),r=[l,...r]),r.reduce((t,n,a)=>(0!==a&&t.push(o.createElement(om.sK,{key:a})),t.push(o.createElement(iY,{key:`disabled-${n}`,value:n+" ",recordingKey:aW.Pt(e,`disabled-option-${n}`),disabled:!0})),i[n].forEach((n,a)=>{t.push(o.createElement(iY,{key:`enabled-${n+a}`,value:n,recordingKey:aW.Pt(e,`viable-option-${a}`),disabled:!1}))}),t),[])})(d,s),u=i.filter(e=>t.hasNameForNode(e)).map((t,n)=>o.createElement(iY,{key:`disabled-${t}`,value:t,recordingKey:aW.Pt(e,`disabled-option-${n}`),disabled:!0})),_=e.isUI3?o.Fragment:a7.fI;return o.createElement(_,null,o.createElement(iX,{id:m,dataTestId:"destination-select",className:e.className,chevronClassName:"prototype_destination_dropdown--chevron--pmWtI",inputClassName:"prototype_destination_dropdown--input--rzglN",dropdownWidth:im.DxS,property:s,formatter:t,onChange:e.onChange,dispatch:e.dispatch,dropdownShown:e.dropdownShown,recordingKey:aW.Pt(e,"select"),willShowDropdown:()=>{let t=l.baT.ALL;"SCROLL_TO"===e.action?t=l.baT.SCROLL_TO:"SWAP_STATE_TO"===e.action?t=l.baT.STATES:"NAVIGATE_TO"===e.action&&c&&(t=l.baT.RESPONSIVE_SETS);let{viableIds:n,disabledIds:o}=l.X3B.getTransitionDestinationsOnActiveCanvas(t);return a(n),r(o),Promise.resolve()},onOptionFocus:e=>{ef.Uc(e??"")},hideDropdownWhenContainerMoves:!(0,oc.nl)()},p||null,0!==i.length&&0!==d.length&&o.createElement(om.sK,null),u))}let iJ=o.memo(function(e){let t=(0,ec.tS)(),n=(0,ec._G)(),a=(0,i.d4)(ij),r=(0,i.d4)(iG.Sh),c=(0,i.d4)(iG.dK),s=(0,i$.D)(r,c),d=(0,i.d4)(iq),m=o.useMemo(()=>(0,iH.cP)(d,t,n,e.actionIndexPath),[d,t,n,e.actionIndexPath]),p=o.useMemo(()=>(0,iH.cP)(a,t,n),[a,t,n]),u=m||p;if(!u||u.mode!==l.iCO.STATE_OR_STATE_INSTANCE_SUBLAYER)return null;let{allStates:_,stateGroupModel:E,selectedStates:g,selectedStatesPropertyValues:y}=u,v=E.propertySortOrder||[],h=E.propertyValues;return h?o.createElement(iW.lS,{sortedProperties:v,stateGroupPropertyValues:h,selectedStatesPropertyValues:y,selectedStates:g,allStates:_,onSelectProperty:t=>{let n={};for(let e of Object.keys(t)){let a=t[e].symbol.node_id;for(let t of(n[e]=a,s[e]||[]))n[t]=a;for(let e of r)n[e]||(n[e]=a)}e.onChange(n)},recordingKey:e.recordingKey,hideErrorsPanel:!0,shouldIndent:!0,extended:!0}):null});function ij(e){return e.mirror.selectionProperties.stateGroupSelectionInfo}function iq(e){return e.mirror.selectionProperties.prototypeDestinationStateGroupSelectionInfo}var iZ=n(57721),i0=n(700201),i1=n(184970),i2=n(629785),i8=n(318982),i3=n(618120);let i4="prototype_set_variable_controls--dropdownAndIconContainer--6m3Tw",i5="prototype_set_variable_controls--icon---HzDt",i7="prototype_set_variable_controls--placeholderText--PBIqf";function i6({targetVariableData:e,targetVariable:t,updateSelectionProperties:n,autoOpenVariablePicker:a,...r}){let s=o.useRef(null),m=(0,i.wA)(),p=(0,eD.GS)(),u=(0,i.d4)(e=>e.variablePickerShown),_=(0,ni.tZ)((0,aj.hS)(t)&&"id"in t?t.id:void 0),E=(0,ni.u)((0,aj.hS)(t)&&"id"in t?t.id:void 0),[y,v]=o.useState("");(0,g.h)(()=>{a&&!0===a.current&&(f(),a.current=!1)});let h=(0,ni.BQ)((0,aj.hS)(t)&&"id"in t?t.id:void 0)??(0,of.m9)((0,aj.hS)(t)&&"nodeFieldAlias"in t?t.nodeFieldAlias:void 0);o.useEffect(()=>{void 0!==e&&h&&"MIXED"!==h&&(0,aj.hS)(e)&&e.resolvedType!==h.resolvedType&&!((0,of.tz)(e.resolvedType)&&(0,of.tz)(h.resolvedType))&&n({targetVariableData:void 0})},[h,n,e]);let f=()=>{let e=s.current.getBoundingClientRect();m((0,iZ.C)({type:"variable-picker-set-variable-action",isShown:!0,resolvedType:l.rXF.STRING,initialPosition:new tL.Mi(e.left-20,e.top),key:r.recordingKey,onVariableSelected:T}))},N=o.useCallback(()=>{m((0,iZ.B)())},[m]),[b,I]=o.useState(!1),T=o.useCallback(t=>{if(void 0!==t&&t.node_id){let a={targetVariable:{id:t.node_id}},o=l.CWU.getVariableResolvedValue(t.node_id,new Map);!e&&t.resolvedType===l.rXF.COLOR&&o&&(a.targetVariableData=o??void 0),n(a),m((0,aq.Zh)({name:"prototype.variable_selected",params:{collectionId:t.variableSetId,variableId:t.node_id,variableType:t.resolvedType}})),I(!0)}},[m,e,n]),A=o.useCallback(e=>{e.value.stablePath.map(e=>aG.sH(e))&&(n({targetVariable:{nodeFieldAlias:{stablePathToNode:e.value.stablePath,nodeField:"COMPONENT_PROP_ASSIGNMENTS",indexOrKey:e.value.explicitDefId}}}),I(!0))},[n]),S=o.useMemo(()=>({type:"LOCAL_VARIABLES",layout:"list"}),[]),C=o.useRef(null);o.useEffect(()=>{let e=l.Ez5.prototypingEditorState().colorPickerEyedropperVarData;return(0,eA.lu)(e,{onChangeImmediate(){let t=e.getCopy();t&&n({targetVariableData:t})}})},[n]);let O="nodeFieldAlias"in t?(0,of.aA)(t.nodeFieldAlias.stablePathToNode,t.nodeFieldAlias.indexOrKey):void 0,P=O?(0,of.Xx)(O.varValue.resolvedType):null,x=null;if((0,aj.gl)(t))x=null;else if(h?.resolvedType===l.rXF.COLOR)x=(0,aj.gl)(e)?o.createElement("div",{className:"prototype_set_variable_controls--targetVariableDataMixedContainer--H6uGu"},(0,d.t)("fullscreen.mixed")):o.createElement(o.Fragment,null,o.createElement(i8.gJ,{variableValue:e??h,onChange:e=>{n({targetVariableData:e})},recordingKey:aW.Pt(r.recordingKey,"variableValueInput"),setVariableAction:!0,innerContainerClassName:"prototype_set_variable_controls--variableColorInputContainer--NaOmp"}));else{let t=r.isNestedInConditional?"prototype_set_variable_controls--absoluteIconInConditional--BbEmW":"prototype_set_variable_controls--absoluteIcon--1XpBF",a=l.rXF.BOOLEAN;E?a=E.resolvedType:O&&(a=O.varValue.resolvedType===l.rXF.TEXT_DATA?l.rXF.STRING:O.varValue.resolvedType),x=o.createElement("div",{className:p?void 0:X.cx.ml12.$},o.createElement("div",{className:i4},o.createElement(a2.KN,{resolvedType:a,targetVariableData:e,autoOpenExpressionBuilder:b,setAutoOpenExpressionBuilder:I,updateSelectionProperties:n,recordingKey:r.recordingKey,isNarrowPanel:r.isNarrowPanel,showVariableThumbnails:!0}),!p&&o.createElement(a6.B,{className:eW()(i5,t),svg:iK.default})))}let w=eW()({"prototype_set_variable_controls--targetVariableDropdown--IZwoF":!p&&!r.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownNarrow--WWi-t prototype_set_variable_controls--targetVariableDropdown--IZwoF":!p&&r.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownUI3--Pz71q":p,[i7]:p&&!(_||O)}),k=(0,i.d4)(od.ZM),D=(0,c.kc)().ds_variable_props_unified_ui&&k?(0,d.t)("proto.select_variable_unified"):p?(0,d.t)("proto.select_variable.short"):(0,d.t)("proto.select_variable"),M=o.createElement(tY.D8,{recordingKey:aW.Pt(r.recordingKey,"selectTargetVariable"),onClick:f},o.createElement("div",{className:p?void 0:(0,aj.hS)(t)?"prototype_set_variable_controls--targetVariableLabel--AFCqK":"prototype_set_variable_controls--targetVariableLabelInactive--zHWCC prototype_set_variable_controls--targetVariableLabel--AFCqK",ref:s},o.createElement(a5.Y,null,o.createElement("div",{className:w},o.createElement("div",{className:i4},(0,aj.gl)(t)?o.createElement("div",{className:eW()(X.cx.pt2.$,X.cx.pb2.$)},(0,d.t)("fullscreen.mixed")):_?o.createElement(oI.wG,{text:_,thumbnailValue:h,isDeleted:!!E&&(0,ob.eF)(E)}):O?o.createElement(oI.wG,{text:O.name,thumbnailValue:P,isDeleted:!1,colorTheme:oI.J2.COMPONENT}):o.createElement("div",{className:eW()(X.cx.pt2.$,X.cx.pb2.$,p?"prototype_set_variable_controls--placeholderTextColorUI3--Pc-4N":void 0)},D),!p&&o.createElement(a6.B,{className:i5,svg:iK.default})))))),R=p?o.createElement(oG.cS,{input:M,label:(0,c.kc)().ds_variable_props_unified_ui?(0,d.tx)("proto.target"):(0,d.tx)("proto.variable")}):M,L=eW()({"prototype_set_variable_controls--setVariableToContainerNarrow--HHbHQ prototype_set_variable_controls--setVariableToContainer--kxsCZ":!p&&r.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainer--kxsCZ":!p&&!r.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainerUI3--pGbDe":p,[i7]:p&&!e&&h?.resolvedType!==l.rXF.COLOR}),U=o.createElement("div",{className:L,"data-testid":"set-variable-container"},x),K=p?null!==x?o.createElement(oG.cS,{label:(0,d.tx)("proto.variable.value"),input:U}):null:U;return o.createElement("div",{className:p?void 0:X.cx.relative.$},R,u.isShown&&"variable-picker-set-variable-action"===u.type&&u.key===r.recordingKey?o.createElement(o.Fragment,null,o.createElement(i3.vx,{title:"",headerSize:"hidden",initialPosition:u.initialPosition,onClose:N,dragHeaderOnly:!1,initialWidth:216,canRenderBelowViewport:!0},o.createElement(i2.YK,{selectedItem:E,disabledVariableIds:new Set,currentView:S,pickerType:"set-variable",onVariableSelected:T,onClose:N,recordingKey:aW.Pt(r.recordingKey,"variablePickerForSelection"),searchQuery:y,onSearchInputChange:v,onComponentPropSelected:(0,c.kc)().ds_variable_props_proto?A:void 0,searchInputRef:C,renderSetControls:()=>o.createElement(i1.Z,{currentView:S,subscribedLibraries:[],setControlRightButtons:o.createElement(i0.f,{resolvedTypes:[l.rXF.BOOLEAN,l.rXF.STRING,l.rXF.FLOAT,l.rXF.COLOR]}),recordingKey:aW.Pt(r.recordingKey,"variablePickerForSelection")})})),o.createElement(i2.$3,{onClose:N})):null,K)}var i9=n(96796),re=n(463420),rt=n(641860),rn=n(995076),ra=n(36815);let ro=(0,a9.ex)("prototype_state_management_info",function(){let e=o.createElement(B.N,{newTab:!0,href:"https://help.figma.com/hc/articles/14397859494295",htmlAttributes:{rel:"noopener noreferrer",onMouseDown:e=>{e.stopPropagation(),e.preventDefault()}}},(0,d.tx)("proto.state_management.info_tooltip_learn_more")),t=o.createElement("span",null,o.createElement("strong",null,(0,d.tx)("proto.animation_panel.preserve_scroll_position")));return o.createElement("div",{className:"prototype_state_management_info_tooltip--stateManagementMoreInfo---gER1 tooltip--text--Ll1mS"},(0,d.tx)("proto.state_management.info_tooltip",{PreserveScrollPositionBold:t,LearnMoreLink:e}))}),ri="prototype_state_management_panel--checkboxRow--2u02e checkbox--_checkboxRow--oEhow",rr="prototype_state_management_panel--expandCaret--uuDge";var rl=n(949207),rc=n(432023);function rs({transition:e,navigationType:t,recordingKey:n,showPreserveScrollPosition:a,showResetVideoState:r,showResetInteractiveComponentState:l,updateSelectionProperties:c,stateManagementVersion:s,selectedInteractions:m}){let p=(0,i.wA)(),u=(0,eD.GS)(),[_,E]=o.useState(!u),g=o.useContext(oN.c);if((0,a3.YT)()===a3.Oz.TWO_COL&&g===oN.P.LEFT)return null;let y=(0,a3.LH)(s),v=o.createElement(ia.S,{onChange:t=>{p((0,aq._P)({name:"Preserve Scroll Changed",params:{newValue:t}})),c({...function(e){if((0,aj.hS)(e.preserveScroll))return{transitionPreserveScroll:e.preserveScroll}}({...e,preserveScroll:t})})},checked:!0===e.preserveScroll,mixed:(0,aj.gl)(e.preserveScroll),recordingKey:aW.Pt(n,"preserve-scroll-check"),label:o.createElement(io.J,null,(0,d.tx)("proto.animation_panel.preserve_scroll_position"))}),h=u?o.createElement(oG.TN,null,v):o.createElement(a7.fI,{className:ri},v),f=o.createElement(ia.S,{onChange:t=>{p((0,aq._P)({name:"Reset Scroll Position Changed",params:{newValue:t,noodleUpgradedThisSession:ra.zZ.haveAnyInteractionsBeenUpgraded(m)}})),c({...function(e){if((0,aj.hS)(e.resetScrollPosition))return{transitionResetScrollPosition:e.resetScrollPosition}}({...e,resetScrollPosition:t})})},checked:!0===e.resetScrollPosition,mixed:(0,aj.gl)(e.resetScrollPosition),recordingKey:aW.Pt(n,"reset-scroll-position-check"),label:o.createElement(io.J,null,(0,d.tx)("proto.animation_panel.reset_scroll_position"))}),N=o.createElement("div",{"data-tooltip-type":a0.Ib.SPECIAL,"data-tooltip":ro,"data-tooltip-interactive":!0,"data-tooltip-show-immediately":!0,"data-tooltip-max-width":240,className:u?"prototype_state_management_panel--stateManagementPanelTooltipUI3--x5MQ3":void 0},o.createElement(rn.In,{icon:"info-16"})),b=u?o.createElement(oG.TN,null,f," ",N):o.createElement(a7.fI,{className:ri},f),I=o.createElement(ia.S,{onChange:t=>{p((0,aq._P)({name:"Reset Component State Changed",params:{newValue:t,noodleUpgradedThisSession:ra.zZ.haveAnyInteractionsBeenUpgraded(m)}})),c({...function(e){if((0,aj.hS)(e.resetInteractiveComponents))return{transitionResetInteractiveComponents:e.resetInteractiveComponents}}({...e,resetInteractiveComponents:t})})},checked:!0===e.resetInteractiveComponents,mixed:(0,aj.gl)(e.resetInteractiveComponents),recordingKey:aW.Pt(n,"reset-component-state-check"),label:o.createElement(io.J,null,(0,d.tx)("proto.animation_panel.reset_component_state"))}),T=u?o.createElement(oG.TN,null,I):o.createElement(a7.fI,{className:ri},I),A=o.createElement(ia.S,{onChange:t=>{p((0,aq._P)({name:"Reset Video Position Changed",params:{newValue:t}})),c({...function(e){if((0,aj.hS)(e.resetVideoPosition))return{transitionResetVideoPosition:e.resetVideoPosition}}({...e,resetVideoPosition:t})})},checked:!0===e.resetVideoPosition,mixed:(0,aj.gl)(e.resetVideoPosition),recordingKey:aW.Pt(n,"reset-video-position-check"),label:o.createElement(io.J,null,(0,a3.LH)(s)?(0,d.tx)("proto.state_management.reset_video_state"):(0,d.tx)("proto.animation_panel.reset_video_state"))}),S=u?o.createElement(oG.TN,null,A):o.createElement(a7.fI,{className:ri},A),C=o.createElement(a7.Zk,{className:`prototype_state_management_panel--stateManagementPanel--sYaaj ${(0,a3.kM)(s)&&"prototype_state_management_panel--stateManagementPanelWithVersion--AovOP"}`},!u&&o.createElement(a7.fI,null,o.createElement(a7.xw,{className:"prototype_state_management_panel--panelTitle--Nr4Eh",faded:!0},(0,d.tx)("proto.state_management")),!(0,a3.kM)(s)&&N),(0,a3.uU)(s)&&a&&h,r&&(0,a3.uU)(s)&&S,y&&b,y&&l&&T,y&&r&&S,(0,aj.gl)(s)&&o.createElement(a5.Y,{direction:"horizontal",padding:{horizontal:12,vertical:12}},o.createElement(a7.UZ,null,(0,d.tx)("proto.state_management.mixed_state_update")))),O=o.createElement(aX.U,{svg:_?rl.A:rc.A},_?o.createElement(i9.O,{className:rr}):o.createElement(re.k,{className:rr})),P=o.createElement(tW.E,{key:"expand-caret",recordingKey:aW.Pt(n,"expand-caret"),onClick:()=>{E(!_)},actionOnPointerDown:!0,className:"prototype_state_management_panel--expandRow--RVDCp"},O,o.createElement("span",null,(0,d.tx)("proto.state")));return o.createElement(rt.k,{name:"prototype_state_management_panel"},u&&P,(_||!u)&&C)}let rd=om.c$,rm=om.l6,rp=aG.AD;class ru extends oo.cP{format(e){return e===rp||null===e?(0,d.t)("proto.target_video_node_name_formatter.this_video"):super.format(e)}}function r_(e){let{viableSameFrameVideoIds:t,disabledSameFrameVideoIds:n,scene:a,dropdownShown:r,targetVideoNodeID:l,isVideoSelected:c,onChange:s}=e,m=(0,i.wA)(),[p,u]=o.useState(()=>c?new ru(a):new oo.cP(a));t.sort((e,t)=>{let n=p.format(e),a=p.format(t);return n.localeCompare(a)}),c&&t.unshift(rp);let _=t.length>0&&n.length>0,E=`prototype-target-video-select-${e.recordingKey}`,g=(0,eD.GS)(),y=o.createElement(rm,{id:E,dataTestId:"target-video-select",className:"prototype_target_video_dropdown--targetVideoDropdown--6hKF-",chevronClassName:"prototype_target_video_dropdown--chevron--jgz53",inputClassName:"prototype_target_video_dropdown--input--infAK",property:(0,aj.gl)(l)?l:aG.dI(l),formatter:p,onChange:s,dispatch:m,dropdownShown:r,recordingKey:aW.Pt(e,"select"),onOptionFocus:e=>{ef.Uc(e??"")},dropdownAlignment:"left"},t.filter(e=>p.hasNameForNode(e)).map((t,n)=>o.createElement(rd,{key:`enabled-${n}`,value:t,recordingKey:aW.Pt(e,`viable-option-${n}`),disabled:!1})),_&&o.createElement(om.sK,null),n.filter(e=>p.hasNameForNode(e)).map((t,n)=>o.createElement(rd,{key:`disabled-${n}`,value:t,recordingKey:aW.Pt(e,`viable-option-${n}`),disabled:!0})));return g?o.createElement(oG.cS,{input:y,label:(0,d.tx)("proto.video_dropdown.label")}):y}var rE=n(466391);function rg({action:e,recordingKey:t,onURLChange:n,onOpenInNewTabChange:a}){let i=(0,eD.GS)(),r=o.createElement(rE.ks,{className:i?"prototype_open_url_action_options--urlInputUI3--H-JfT":"prototype_open_url_action_options--urlInput--T-tGT",dataTestId:"url-input",placeholder:(0,d.t)("proto.interaction.example_com"),value:(0,aj.gl)(e.connectionURL)?(0,d.t)("fullscreen.mixed"):(0,aj._W)(e.connectionURL,""),onChange:n,recordingKey:aW.Pt(t,"urlTextInput"),autoFocus:!1}),l=o.createElement(ia.S,{label:o.createElement(io.J,null,(0,d.tx)("proto.action_open_url_in_new_tab")),onChange:a,recordingKey:aW.Pt(t,"open-url-in-new-tab-check"),checked:void 0===e.openUrlInNewTab||!0===e.openUrlInNewTab});return o.createElement(o.Fragment,null,i?o.createElement(oG.cS,{label:(0,d.tx)("proto.open_url.text_input_label"),input:r}):r,i?o.createElement(oG.TN,null,l):o.createElement(a7.fI,{className:"prototype_open_url_action_options--checkboxRow--mu17T checkbox--_checkboxRow--oEhow"},l))}var ry=n(334367),rv=n(588599);function rh({updateSelectionProperties:e,action:t,extraScrollOffset:n,showScrollToOptions:a,recordingKey:r}){let{smallNudgeAmount:l,bigNudgeAmount:c}=(0,ry.sT)(),s=(0,i.wA)(),m=(0,eD.GS)(),p=(t,n)=>(a,o)=>{t&&e({extraScrollOffset:{...t,[n]:a}},{shouldCommit:o})},u=(0,aj._W)(n,{x:0,y:0});if(!a||"SCROLL_TO"!==t)return null;let _=o.createElement(il.gq,{className:m?void 0:oT.U,inputClassName:m?oT.oM:oT.hF,value:u.y,wheelMultiplier:l,scrubMultiplier:l,smallNudgeAmount:l,bigNudgeAmount:c,onValueChange:p(u,"y"),dispatch:s,"data-tooltip-type":a0.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.y_offset"),tooltipForScreenReadersOnly:!1,recordingKey:aW.Pt(r,"extraScrollOffsetY")},m?o.createElement("span",{className:oT.QK},(0,d.tx)("proto.scroll_options.scroll_offset.y")):o.createElement(a6.B,{className:oT.QK,svg:rv.A})),E=o.createElement(il.gq,{className:m?void 0:oT.sC,inputClassName:m?oT.oM:oT.hF,value:u.x,wheelMultiplier:l,scrubMultiplier:l,smallNudgeAmount:l,bigNudgeAmount:c,onValueChange:p(u,"x"),dispatch:s,"data-tooltip-type":a0.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.x_offset"),tooltipForScreenReadersOnly:!1,recordingKey:aW.Pt(r,"extraScrollOffsetX")},m?o.createElement("span",{className:oT.QK},(0,d.tx)("proto.scroll_options.scroll_offset.x")):o.createElement(a6.B,{className:oT.Kh,svg:rv.A}));return m?o.createElement(oG.Cm,{label:(0,d.tx)("proto.scroll_options.offset"),leftInput:E,rightInput:_}):o.createElement(a7.fI,null,_,E)}let rf=(0,o.memo)(function(e){return(0,aP.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,aP.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M18 12a6 6 0 1 1-12 0 6 6 0 0 1 12 0m1 0a7 7 0 1 1-14 0 7 7 0 0 1 14 0m-6.5-3.5a.5.5 0 0 0-1 0V12a.5.5 0 0 0 .146.354l2 2a.5.5 0 0 0 .708-.708L12.5 11.793z",clipRule:"evenodd"})})}),rN="prototype_video_action_options--chevron--mkNyv",rb="prototype_video_action_options--input--3-cEi",rI=new oo.js,rT=new oo.Z6;function rA({action:e,onChange:t,updateSelectionProperties:n,dropdownShown:a,recordingKey:r}){let l=(0,eD.GS)(),c=(0,oo.Od)(e),s=(0,aj.E7)(e.mediaAction),m="UPDATE_MEDIA_RUNTIME"===(0,aj.E7)(e.connectionType),p="SKIP_TO"===s,u="SKIP_FORWARD"===s||"SKIP_BACKWARD"===s,_="PLAY"===s||"PAUSE"===s||"TOGGLE_PLAY_PAUSE"===s,E="MUTE"===s||"UNMUTE"===s||"TOGGLE_MUTE_UNMUTE"===s,g=(0,i.wA)(),y=(0,ry.RU)(),v=o.useCallback(e=>{n({mediaSkipToTime:e}),g((0,aq._P)({name:"Media skip to time changed",params:{value:e}}))},[g,n]),h=`prototype-media-action-select-${r}`,f="prototype_video_action_options--shortDropdown--NOXXv",N=a&&a.type===h?rI:rT,b=o.createElement(o_,{id:h,dataTestId:"media-play-pause-select",className:f,chevronClassName:rN,inputClassName:rb,property:c,formatter:N,onChange:t,dispatch:g,dropdownShown:a,recordingKey:aW.Pt(r,"select")},o.createElement(ou,{key:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",value:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",recordingKey:aW.Pt(r,"toggle-play-pause-option"),disabled:!1}),o.createElement(ou,{key:"UPDATE_MEDIA_PLAY",value:"UPDATE_MEDIA_PLAY",recordingKey:aW.Pt(r,"play-option"),disabled:!1}),o.createElement(ou,{key:"UPDATE_MEDIA_PAUSE",value:"UPDATE_MEDIA_PAUSE",recordingKey:aW.Pt(r,"pause-option"),disabled:!1})),I=o.createElement(o_,{id:h,dataTestId:"media-mute-unmute-select",className:f,chevronClassName:rN,inputClassName:rb,property:c,formatter:N,onChange:t,dispatch:g,dropdownShown:a,recordingKey:aW.Pt(r,"select")},o.createElement(ou,{key:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",value:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",recordingKey:aW.Pt(r,"toggle-mute-unmute-option"),disabled:!1}),o.createElement(ou,{key:"UPDATE_MEDIA_MUTE",value:"UPDATE_MEDIA_MUTE",recordingKey:aW.Pt(r,"mute-option"),disabled:!1}),o.createElement(ou,{key:"UPDATE_MEDIA_UNMUTE",value:"UPDATE_MEDIA_UNMUTE",recordingKey:aW.Pt(r,"unmute-option"),disabled:!1})),T=o.createElement(o_,{id:h,dataTestId:"media-skip-by-select",className:f,chevronClassName:rN,inputClassName:rb,property:c,formatter:N,onChange:t,dispatch:g,dropdownShown:a,recordingKey:aW.Pt(r,"select"),dropdownWidth:160},o.createElement(ou,{key:"UPDATE_MEDIA_SKIP_FORWARD",value:"UPDATE_MEDIA_SKIP_FORWARD",recordingKey:aW.Pt(r,"skip-forward-option"),disabled:!1}),o.createElement(ou,{key:"UPDATE_MEDIA_SKIP_BACKWARD",value:"UPDATE_MEDIA_SKIP_BACKWARD",recordingKey:aW.Pt(r,"skip-backward-option"),disabled:!1})),A=o.createElement(il.qd,{className:"prototype_video_action_options--timestampContainer---DdaI",inputClassName:"prototype_video_action_options--timestamp--luOrs",dataTestId:"mediaSkipToTime-input",dispatch:g,value:e.mediaSkipToTime||0,onValueChange:v,wheelMultiplier:y/1e3,scrubMultiplier:y/1e3,max:3600,displayFractions:!0,"data-tooltip-type":a0.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.timestamp_to_set_to"),tooltipForScreenReadersOnly:!0,recordingKey:aW.Pt(r,"mediaSkipToTimeInput")},l?o.createElement(rf,null):void 0),S="SKIP_BACKWARD"===s?(0,d.t)("proto.trigger.duration_to_jump_backward"):(0,d.t)("proto.trigger.duration_to_jump_forward"),C=o.createElement(il.dE,{className:"prototype_video_action_options--timeAmountContainer--5kpHn",dataTestId:"mediaSkipByAmount-input",dispatch:g,value:e.mediaSkipByAmount||5,onValueChange:e=>{n({mediaSkipByAmount:e}),g((0,aq._P)({name:"Media skip by amount changed",params:{value:e}}))},wheelMultiplier:y/1e3,scrubMultiplier:y/1e3,max:3600,"data-tooltip-type":a0.Ib.TEXT,"data-tooltip":S,tooltipForScreenReadersOnly:!0,recordingKey:aW.Pt(r,"mediaSkipByAmountInput")});if(!m)return null;if(l){if(_)return o.createElement(oG.cS,{input:b,label:(0,d.tx)("proto.video_options.behavior")});if(E)return o.createElement(oG.cS,{input:I,label:(0,d.tx)("proto.video_options.behavior")});if(u)return o.createElement(o.Fragment,null,o.createElement(oG.cS,{input:T,label:(0,d.tx)("proto.video_options.direction")}),o.createElement(oG.cS,{input:C,label:(0,d.tx)("proto.video_options.offset")}));if(p)return o.createElement(oG.cS,{input:A,label:(0,d.tx)("proto.video_options.timestamp")})}return o.createElement(a7.fI,null,_&&b,E&&I,u&&T,u&&C,p&&A)}var rS=n(108378);function rC({action:e,recordingKey:t,interactionType:n,onActionChange:a,updateMultipleDestinationNodes:r,updateSelectionProperties:c,stateManagementVersion:s,autoOpenVariablePicker:m,autoOpenExpressionBuilder:p,setAutoOpenExpressionBuilder:u,..._}){let E=(0,i.wA)(),g=(0,oi.Um)(),{scene:y}=(0,o9.R)(e=>({scene:e.mirror.sceneGraph})),v=(0,eD.GS)(),h=(0,a3.YT)(),f=h===a3.Oz.SINGLE_COL,N=h===a3.Oz.TWO_COL,b=o.useContext(oN.c),I=N&&b===oN.P.RIGHT,T="SET_VARIABLE"===(0,aj.E7)(e.connectionType),A="SET_VARIABLE_MODE"===(0,aj.E7)(e.connectionType),S="CONDITIONAL"===(0,aj.E7)(e.connectionType),C="INTERNAL_NODE"===(0,aj.E7)(e.connectionType),O="INTERNAL_NODE"===(0,aj.E7)(e.connectionType)&&"SWAP_STATE"===(0,aj.E7)(e.navigationType),P="URL"===(0,aj.E7)(e.connectionType),x=C||"BACK"===(0,aj.E7)(e.connectionType)||"CLOSE"===(0,aj.E7)(e.connectionType),w="UPDATE_MEDIA_RUNTIME"===(0,aj.E7)(e.connectionType),k=(0,i.d4)(e=>{let t=e.mirror.selectionProperties.numSelected,n=e.mirror.selectionProperties.numVideosSelected;return 1===t&&!!n}),D=(0,it.uQ)(),M=[],R=[];if(D){let{viableIds:e,disabledIds:t}=l.X3B.getVideoNodesOnSameTlfAsNode(D);M=e,R=t}let L=aG.dI((0,aj.E7)(e.transitionNodeID)),U=null!=L&&L!==aG.AD,K=C&&(!(0,aj.hS)(e.transitionNodeID)||U),V=(0,aj.E7)(e.navigationType),B=C&&"OVERLAY"===(0,aj.E7)(V),F=(0,a3.hU)(e.transitionType,e.easingType,e.easingFunction,e.transitionDuration,e.transitionShouldSmartAnimate,e.transitionPreserveScroll,e.transitionResetVideoPosition,e.openUrlInNewTab,e.transitionResetScrollPosition,e.transitionResetInteractiveComponents),z=x&&!B&&("INSTANT"===F.behavior||"DISSOLVE"===F.behavior),G=C&&"OVERLAY"===(0,aj.E7)(e.navigationType)&&U,$=C&&(B||"SWAP"===(0,aj.E7)(V)),W=!w&&(0,a3.oc)(e),H=(0,a3.GB)(e),Y=(0,a3.uU)(s)?z||W:(0,a3.Fp)(s,e.connectionType,e.navigationType),{selectedInteractions:Q}=(0,rS.Ay)(ie.J.NORMAL),J=Q.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>a$.d({nodeID:e.sourceNodeID,interactionID:e.id})),j=o.useCallback(e=>{let t=aG.sH(e);t&&c({transitionNodeID:t}),E((0,aq._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(J),destinationTlfId:e}}))},[E,c,J]),q=o.useCallback(e=>{r(e),E((0,aq._P)({name:"Variant based prototyping UI changed",params:{source:"panel"}})),E((0,aq._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(J)}}))},[r,E,J]),Z=o.useCallback(e=>{c({connectionURL:e.target.value})},[c]),ee=(0,oo.Od)(e),et=eW()({[oT.Ph]:!v,[oT.Ti]:_.isNestedInConditional&&!f&&!I}),en=C&&!O,ea=o.createElement(iQ,{className:oT.iR,dispatch:E,dropdownShown:g,onChange:j,nodeId:e.transitionNodeID||aG.Hr,scene:y,recordingKey:aW.Pt(t,"destinationDropdown"),action:ee,isUI3:v}),eo=o.createElement(rh,{action:ee,showScrollToOptions:"SCROLL_TO"===ee,extraScrollOffset:e.extraScrollOffset,updateSelectionProperties:c,recordingKey:aW.Pt(t,"scrollOptionsPanel")}),ei=o.createElement(iy,{interactionType:n,updateSelectionProperties:c,recordingKey:aW.Pt(t,"overlaySettings"),actionIndexPath:_.actionIndexPath,nodeId:e.transitionNodeID||aG.Hr});return o.createElement("div",{className:et},en&&(v?o.createElement(o.Fragment,null,o.createElement(oG.cS,{label:$?(0,d.tx)("proto.overlay"):(0,d.tx)("proto.destination"),input:ea}),eo,G&&ei):ea),P&&o.createElement(rg,{action:e,recordingKey:t,onOpenInNewTabChange:e=>{c({openUrlInNewTab:e}),E((0,aq._P)({name:"Open Url In New Tab Changed",params:{value:e}}))},onURLChange:Z}),w&&o.createElement(r_,{dropdownShown:g,scene:y,targetVideoNodeID:e.transitionNodeID||aG.Hr,recordingKey:aW.Pt(t,"targetVideoDropdown"),viableSameFrameVideoIds:M,disabledSameFrameVideoIds:R,isVideoSelected:k,onChange:j}),o.createElement(rA,{dropdownShown:g,action:e,onChange:a,updateSelectionProperties:c,recordingKey:t}),!v&&eo,T&&o.createElement("div",{className:v?void 0:X.cx.ml4.$},o.createElement(i6,{className:oT.PB,dispatch:E,onChange:j,nodeId:e.transitionNodeID||aG.Hr,targetVariable:e.targetVariable||{id:""},targetVariableData:e.targetVariableData,updateSelectionProperties:c,recordingKey:aW.Pt(t,"setVariableControls"),action:ee,isNestedInConditional:_.isNestedInConditional,isNarrowPanel:_.isNestedInConditional||_.isNarrowPanel,autoOpenVariablePicker:m})),A&&o.createElement("div",{className:v?void 0:X.cx.ml4.$},o.createElement(o1,{dispatch:E,targetVariableSetID:e.targetVariableSetID,targetVariableModeID:e.targetVariableModeID,deprecatedTargetVariableSetKey:e.targetVariableSetKey,updateSelectionProperties:c,recordingKey:aW.Pt(t,"setVariableControls"),actionIndexPath:_.actionIndexPath.join(",")})),S&&(I?o.createElement(iz,{recordingKey:aW.Pt(t,"conditionalActionSection","conditional-block",0),autoOpenExpressionBuilder:p,setAutoOpenExpressionBuilder:u,updateSelectionProperties:c,conditionalActions:(0,aj.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]}):o.createElement(iF,{updateSelectionProperties:c,recordingKey:aW.Pt(t,"conditionalActionSection"),action:e,updateMultipleDestinationNodes:r,interactionType:n,stateManagementVersion:s,selectedInteractions:_.selectedInteractions,actionIndexPath:_.actionIndexPath,onDrop:_.onDrop,onSelect:_.onSelect,onExpand:_.onExpand,onNewActionAdded:_.onNewActionAdded,selectedActionIndex:_.selectedActionIndex,expandedRows:_.expandedRows,autoOpenVariablePicker:m,handleMouseDownUI3:_.handleMouseDownUI3})),O&&o.createElement("div",{className:X.cx.ml0.$},o.createElement(iJ,{onChange:q,nodeId:e.transitionNodeID||aG.Hr,recordingKey:aW.Pt(t,"consumption"),actionIndexPath:_.actionIndexPath})),K&&o.createElement(o.Fragment,null,v&&o.createElement("div",{className:oT.x}),o.createElement(iS.X7,{transition:F,interactionType:n,navigationType:e.navigationType,recordingKey:aW.Pt(t,"animationPanel"),updateSelectionProperties:c,isNarrowPanel:_.isNestedInConditional||_.isNarrowPanel,stateManagementVersion:s})),G&&!v&&ei,Y&&o.createElement(o.Fragment,null,v&&o.createElement("div",{className:oT.x}),o.createElement(rs,{connectionType:e.connectionType,transition:F,navigationType:e.navigationType,recordingKey:aW.Pt(t,"stateManagementPanel"),updateSelectionProperties:c,showPreserveScrollPosition:z,showResetVideoState:!!W,showResetInteractiveComponentState:!!H,stateManagementVersion:s,selectedInteractions:_.selectedInteractions})))}var rO=n(474153),rP=n(323110),rx=n(482725);let rw=Symbol("ACTION_ROW");function rk({updateMultipleDestinationNodes:e,updateSelectionProperties:t,onDeleteAction:n,stateManagementVersion:a,selectedInteractions:r,autoOpenVariablePicker:l,autoOpenExpressionBuilder:c,setAutoOpenExpressionBuilder:s,...m}){let p=(0,i.wA)(),{shouldShowAdvancedPrototypingPaywall:u,showAdvancedPrototypingVariablesModal:_,showAdvancedPrototypingConditionalActionsModal:E}=(0,a3.zt)(),g=(0,oi.Um)(),v=(0,a3.hP)(),{firstVariableSetMode:h,firstVariableSetID:f}=o0(),N=m.action,b=m.isNestedInConditional&&(0,iC.qQ)(m.action),I=!!N.connectionType&&"CONDITIONAL"===N.connectionType,T=(0,eD.GS)(),A=(0,a3.YT)(),S=A===a3.Oz.SINGLE_COL,C=A===a3.Oz.TWO_COL,O=o.useContext(oN.c),P=C&&O===oN.P.RIGHT,x=C&&O===oN.P.LEFT,w=!((0,aj.gl)(m.action)||["CLOSE","NONE"].includes(N.connectionType))&&!T;var k=m.selectedActionIndex.equals(m.actionIndexPath);let D=1===m.selectedActionIndex.path.length&&m.isNestedInConditional&&m.actionIndexPath[0]===m.selectedActionIndex.path[0];var M=void 0===m.expandedRows||void 0!==m.expandedRows.find(e=>e.equals(m.actionIndexPath));T&&(M=!!S||!x||I);let R=o.useCallback(()=>{(w||S)&&m.onExpand(m.actionIndexPath)},[w,S,m]),[L,U]=o.useState(!1);o.useEffect(()=>{if(I){let e=setTimeout(()=>{U(!0)},0);return()=>clearTimeout(e)}U(!0)},[I]);let K=I&&!M,V=I&&M,B=o.useRef(null),[F,z]=(0,y.fp)(a3.hV),{position:G,dragItem:$}=(0,a4.h4)(()=>({type:rw,element:B,item:m.action,dropPositionThreshold:V?.2:K?1/3:.5,getDeepestTargetOnly:!0,canDrag:!!x||!M,onDrop(e){m.onDrop(e),z(!0)}})),W=o.useMemo(()=>{let e=B.current;if(!e||!G||P)return;if($&&"CONDITIONAL"===$.connectionType&&m.isNestedInConditional||(0,iC.qQ)($)){z(!1);return}let t=b?a4.Nz.BEFORE:G;var n=void 0;let a=e.offsetParent?.firstElementChild?.scrollTop??0;return t===a4.Nz.BEFORE?n=e.offsetTop-a:t===a4.Nz.AFTER&&(n=e.offsetTop+e.offsetHeight-a),z(!0),n},[G,P,$,m.isNestedInConditional,b,z]),H=G&&I&&!M&&G===a4.Nz.INSIDE&&"CONDITIONAL"!==$.connectionType,Y=aW.rf(m.recordingKey,"mousedown",e=>{M||(k=!0,m.onSelect(m.actionIndexPath,!0))}),X=aW.rf(m.recordingKey,"mousedown",e=>{k=!1,m.onSelect(m.actionIndexPath,!1)}),Q=aW.rf(m.recordingKey,"click",e=>{m.onSelect(m.actionIndexPath,!0)}),J=aW.rf(m.recordingKey,"mousedown",e=>{(0,iC.qQ)(m.action)||m.onSelect(m.actionIndexPath,!0)}),j=e=>{var n=!0,a=!1;switch(e){case"NONE":t({connectionType:"NONE"});break;case"NAVIGATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"NAVIGATE"});break;case"OPEN_OVERLAY":t({connectionType:"INTERNAL_NODE",navigationType:"OVERLAY"});break;case"SCROLL_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SCROLL_TO"});break;case"SWAP_WITH":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP"});break;case"SWAP_STATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP_STATE"});break;case"GO_BACK":t({connectionType:"BACK"});break;case"CLOSE_OVERLAY":t({connectionType:"CLOSE"});break;case"OPEN_URL":t({connectionType:"URL"});break;case"SET_VARIABLE":u?(n=!1,_()):(t({connectionType:"SET_VARIABLE"}),l.current=!0);break;case"SET_VARIABLE_MODE":u?(n=!1,_()):t({connectionType:"SET_VARIABLE_MODE",targetVariableSetID:f,targetVariableModeID:h});break;case"UPDATE_MEDIA_PLAY":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PLAY"});break;case"UPDATE_MEDIA_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PAUSE"});break;case"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_PLAY_PAUSE"});break;case"UPDATE_MEDIA_MUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"MUTE"});break;case"UPDATE_MEDIA_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"UNMUTE"});break;case"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_MUTE_UNMUTE"});break;case"UPDATE_MEDIA_SKIP_BY_OPTIONS":case"UPDATE_MEDIA_SKIP_FORWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_FORWARD"});break;case"UPDATE_MEDIA_SKIP_BACKWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_BACKWARD"});break;case"UPDATE_MEDIA_SKIP_TO":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_TO"});break;case"CONDITIONAL":a=!0,u?(n=!1,E()):(t({connectionType:"CONDITIONAL"}),T&&s&&s(!0))}if(T||M||R(),C&&m.onExpand(m.actionIndexPath,a),n){let t=r.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>a$.d({nodeID:e.sourceNodeID,interactionID:e.id}));p((0,aq._P)({name:"Prototype action changed",params:{action:e,source:"panel",connectorIds:JSON.stringify(t)}}))}},q=m.isNestedInConditional?oT.It:oT.ft,Z=eW()({[oT.wu]:!x,[oT.zX]:x&&F}),ee=o.createElement(aX.U,{svg:rP.A},o.createElement(on,{className:oT._2}));if(b&&m.onAddAction)return o.createElement("div",{className:x?oT.LW:void 0},W&&o.createElement("hr",{className:q,style:{transform:`translateY(${W}px)`}}),x&&m.isNestedInConditional&&ee,o.createElement("div",{className:Z,ref:B},o.createElement(iD,{addButtonPressed:m.onAddAction,recordingKey:aW.Pt(m.recordingKey,"addAction"),isNestedInConditional:!0})));let et=(0,oo._X)(N),en="NONE"!==et,ea=(M||!en)&&!x,eo=m.numActions>1,ei=(m.numActions>1||m.isNestedInConditional)&&!x,er=eW()({[oT.$l]:!0,[oT.KY]:x&&!m.isNestedInConditional,[oT.Iw]:x&&!m.isNestedInConditional&&F,[oT.DM]:x&&m.isNestedInConditional,[oT.vs]:x&&m.isNestedInConditional&&F,[oT.M9]:x&&m.isNestedInConditional&&D&&F,[oT.I_]:x&&I&&!k&&F,[oT.Cu]:k&&!T,[oT.PE]:k&&x&&!m.isNestedInConditional,[oT.Ze]:H,[oT.Op]:m.isNestedInConditional&&!T}),el=eW()({[oT.rn]:!0,[oT.Gu]:x,[oT.Ti]:m.isNestedInConditional&&!T&&!P,[oT.Yo]:m.isNestedInConditional&&T&&!P}),ec=o.createElement(a6.B,{key:"expand-caret",className:oT.GE,svg:M?rl.A:rc.A,recordingKey:aW.Pt(m.recordingKey,"expandCaret"),onClick:R}),es=o.createElement(oP,{action:N,isNestedInConditional:m.isNestedInConditional,isNarrowPanel:m.isNarrowPanel&&eo,onClick:T?Q:void 0}),ed=o.createElement(og,{className:"NONE"===et||T?void 0:rO.fH,dispatch:p,dropdownShown:g,onChange:j,action:et,recordingKey:aW.Pt(m.recordingKey,"actionDropdown"),showVideoActions:v,isNestedInConditional:m.isNestedInConditional}),em=o.createElement(a7.K0,{className:T?oT.gG:oT.hH,onClick:n,"data-tooltip-type":a0.Ib.TEXT,"data-tooltip":(0,d.t)("proto.prototype_panel.delete"),"aria-label":(0,d.t)("proto.prototype_panel.delete"),recordingKey:aW.Pt(m.recordingKey,"actionDeleteButton")},o.createElement(aX.U,{svg:rx.A},o.createElement(aF.O,null))),ep=o.createElement(a7.fI,{className:el,onDoubleClick:R},w&&ec,ea?o.createElement("span",{className:oT.P2},ed):es,ei&&em),eu=ea?ed:es,e_=o.createElement(oa.S.div,{className:el,onDoubleClick:R},w&&ec,ei?o.createElement(o6.DE,{appendedClassName:oT.Jw,label:null,input:eu,icon:em}):o.createElement(o6.Ad,{appendedClassName:oT.Jw,label:null,input:eu})),eE=(0,d.tx)("proto.action"),eg=o.createElement(oa.S.div,{className:el},S||P?o.createElement(oG.cS,{label:eE,input:eu}):eu),ey=T?eg:e_,ev=eW()({[oT.Oe]:!0,[oT.h2]:k,[oT.Ob]:I});return o.createElement(oa.S.div,{className:er,ref:B,role:"button",tabIndex:0,onMouseDown:T?void 0:Y,onMouseUp:T?void 0:X},void 0!==W&&o.createElement("hr",{className:q,style:{transform:`translateY(${W}px)`}}),x?o.createElement(oa.S.div,{className:ev,role:"button",tabIndex:0,onMouseDown:T?J:void 0},m.isNestedInConditional&&ee,ey):T?ey:ep,M&&L&&o.createElement(rC,{updateMultipleDestinationNodes:e,action:N,onActionChange:j,recordingKey:m.recordingKey,updateSelectionProperties:t,interactionType:m.interactionType,stateManagementVersion:a,selectedInteractions:r,isNestedInConditional:m.isNestedInConditional,isNarrowPanel:m.isNarrowPanel,actionIndexPath:m.actionIndexPath,onDrop:m.onDrop,onSelect:m.onSelect,onExpand:m.onExpand,onNewActionAdded:m.onNewActionAdded,selectedActionIndex:m.selectedActionIndex,expandedRows:m.expandedRows,autoOpenVariablePicker:l,autoOpenExpressionBuilder:c,setAutoOpenExpressionBuilder:s,handleMouseDownUI3:J}))}var rD=n(427113),rM=n(220877),rR=n(229243);function rL({onChange:e,value:t,shouldFocusKeyCaptureField:n,setShouldFocusKeyCaptureField:a}){let i;let r=(0,rR._i)(t?.keyCodes),l=t=>e({keyCodes:t,triggerDevice:"KEYBOARD"}),[c,s]=o.useState(!1),m=o.useRef(null);o.useEffect(()=>{(!t||!t.keyCodes||0===t.keyCodes.length)&&n&&m.current&&(a(!1),m.current.focus(),s(!0))},[a,n,t]),o.useEffect(()=>{if(!c)return()=>{};let t=new rM.L,n=t.onPress(t=>{e({keyCodes:[t.buttons[0]],triggerDevice:t.controllerType}),requestAnimationFrame(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})});return t.start(),()=>{n.release(),t.end()}},[e,c]);let p=null,u=(0,rR.E8)(t),_=(0,eD.GS)();return c?i=o.createElement(rU,null,_?(0,d.tx)("proto.keyCapture.press_key_lowercase"):(0,d.tx)("proto.keyCapture.press_key")):t?.triggerDevice==="KEYBOARD"&&r?p=(0,rR.U8)(r):u?p=u:i=o.createElement(rU,null,_?(0,d.tx)("proto.keyCapture.click_to_set_key"):(0,d.tx)("proto.keyCapture.click_to_select")),o.createElement(a7.rp,{ref:m,className:"prototype_key_capture_field--root--bD21s","data-tooltip-type":a0.Ib.TEXT,"data-tooltip":p&&p.length>10?p:null,onFocus:()=>s(!0),onBlur:()=>s(!1),onKeyDown:e=>{e.preventDefault(),e.stopPropagation();let t=e.which||e.keyCode;!rR.RI.has(t)&&rR.pu[t]&&(t===r?.keyCode&&e.repeat?l((0,rR.wb)({keyCode:t,metaKey:e.metaKey||r.metaKey,shiftKey:e.shiftKey||r.shiftKey,ctrlKey:e.ctrlKey||r.ctrlKey,altKey:e.altKey||r.altKey})):l((0,rR.wb)({...e,keyCode:t})),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},recordingKey:"keycapture"},p??i)}function rU({children:e}){return o.createElement("span",{className:"prototype_key_capture_field--placeholder--gWUKF"},e)}var rK=n(78972);let rV=om.l6,rB=om.c$,rF=new oo.VG,rz=new oo.EX,rG=new oo.JV,r$=new oo.Eq;function rW(e){let t=(0,i.wA)(),n=(0,oi.Um)(),a=(0,eD.GS)(),r=(0,op.cJ)(),{showVideoV2Triggers:c}=(0,o9.R)(e=>({allStatesInSelection:e.mirror.selectionProperties.stateGroupSelectionInfo?.mode===l.iCO.STATE,allTopLevelFramesInSelection:!!e.mirror.selectionProperties.allTopLevelFramesInSelection,showVideoV2Triggers:(0,os.dq)(e.mirror.selectionProperties)})),s=(0,y.md)(rK.NE),d=t=>{let n=o.createElement("div",{className:"transition_interaction_dropdown--prototypeInteractionIcon---njby"},(0,os.e7)(t));return o.createElement(rB,{key:t,value:t,icon:a?n:void 0,recordingKey:aW.Pt(e,t),disabled:!function(t){if("NONE"===t)return!0;let n=!!e.interactionsOnSelectedNodes&&e.interactionsOnSelectedNodes.every(t=>e.interactionsOnSelectedNodes&&aG.aI(t.sourceNodeID,e.interactionsOnSelectedNodes[0].sourceNodeID))&&!(0,aj.hS)(e.property),a=(function(){if(e.interactionsOnSelectedNodes)return new Set(e.interactionsOnSelectedNodes.map(e=>e?.event?.interactionType).filter(e=>void 0!==e))})()?.has(t)&&(0,aj.hS)(e.property)&&e.property!==t;return(!n&&!a||!!["ON_KEY_DOWN","DRAG","ON_VOICE","ON_MEDIA_HIT"].includes(t))&&("AFTER_TIMEOUT"===t?!e.interactionContainsOpenLinkAction:"ON_MEDIA_HIT"===t||"ON_MEDIA_END"===t?c:(!e.interactionContainsOpenLinkAction||"ON_CLICK"===t||"MOUSE_UP"===t)&&(!e.interactionContainsUpdateMediaRuntime||"ON_HOVER"!==t&&"ON_PRESS"!==t&&"DRAG"!==t)&&(!e.interactionOnlyContainsBack||"ON_HOVER"!==t&&"ON_PRESS"!==t))}(t)})},m=(r?[]:["NONE"]).map(d),p=["ON_CLICK",...r?[]:["DRAG"],"ON_HOVER","ON_PRESS","ON_KEY_DOWN"].map(d),u=["MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].map(d),_=(r?[]:["ON_MEDIA_HIT","ON_MEDIA_END"]).map(d),E=["AFTER_TIMEOUT"].map(d),g=s?"ON_MEDIA_HIT"!==e.property?rz:r$:"ON_MEDIA_HIT"!==e.property?rF:rG,v=o.useCallback(e=>e-24,[]),h=[...m,!r&&o.createElement(om.sK,{key:"select1"}),...p,o.createElement(om.sK,{key:"select2"}),...u,!r&&o.createElement(om.sK,{key:"select3"}),...E,...!r&&c?[o.createElement(om.sK,{key:"select4"}),..._]:[]],[f,N]=o.useState(void 0),b=o.createElement(or.Q,{setMaxWidth:N,options:h,formatOption:e=>e&&e.props.value?g.format(e.props.value):"",getIcon:()=>(0,os.e7)("AFTER_TIMEOUT")}),I=(0,aj.E7)(e.property);return o.createElement(o.Fragment,null,o.createElement(rV,{id:"interaction-type-select",className:e.className,chevronClassName:"transition_interaction_dropdown--chevron--pyzhq",dataTestId:"interaction-select",property:e.property,formatter:g,icon:a&&I?(0,os.e7)(I):void 0,onChange:e.onChange,dispatch:t,dropdownShown:n,recordingKey:aW.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,oc.nl)(),dropdownAlignment:v,dropdownWidth:f},h),b)}let rH={keyCodes:[],triggerDevice:"KEYBOARD"};function rY(e,t,n,a){return n?o.createElement(oG.cS,{label:e,input:t,appendedClassName:a?void 0:oT.dU}):o.createElement(a7.fI,null,t)}function rX(e){let{detailPropsMultipleActions:t,interactionsOnSelectedNodesAndComponents:n,updateSelectionProperties:a}=(0,rS.Ay)(e.category),{interactionType:r="NONE",transitionTimeout:l=.8,mediaHitTime:c=0,interactionMaintained:s=!1,interactionDuration:m=.3,keyTrigger:p=rH}=t.interactionEvent,u=(e,t)=>{if(e.connectionType===t)return e;if("CONDITIONAL"===e.connectionType)for(let n of(0,aj.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]){let e=n.actions?n.actions.find(e=>e.connectionType===t):void 0;if(void 0!==e)return e}return null},_=void 0!==t.interactionActions.find(e=>u(e,"URL")),E=void 0!==t.interactionActions.find(e=>u(e,"UPDATE_MEDIA_RUNTIME")),g=1===t.interactionActions.length&&"BACK"===t.interactionActions[0].connectionType,y=void 0!==t.interactionActions.find(e=>u(e,"CONDITIONAL"));return function(e){let t=(0,i.wA)(),n=e.updateSelectionProperties,a=(0,ry.RU)(),[r,l]=o.useState(!1),c=(0,eD.GS)(),s=(0,a3.YT)(),m=s===a3.Oz.SINGLE_COL,p=s===a3.Oz.TWO_COL,u=!0===(0,aj.E7)(e.maintained),_=(0,aj.E7)(e.keyTrigger),E="ON_KEY_DOWN"===(0,aj.E7)(e.interactionType),g="AFTER_TIMEOUT"===(0,aj.E7)(e.interactionType),y="ON_MEDIA_HIT"===(0,aj.E7)(e.interactionType),v=["MOUSE_IN","MOUSE_OUT","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].indexOf((0,aj.E7)(e.interactionType)||"")>-1,h=o.createElement(rW,{className:oT.sQ,property:e.interactionType,onChange:a=>{a8.sn.start("interaction_details_changed"),n({interactionType:a}),t((0,aq._P)({name:"Prototype Interaction Type Changed",params:{newType:a,oldType:(0,aj._W)(e.interactionType,"MIXED")}})),"ON_KEY_DOWN"===a&&l(!0)},interactionContainsOpenLinkAction:e.interactionContainsOpenLinkAction,interactionContainsUpdateMediaRuntime:e.interactionContainsUpdateMediaRuntime,interactionOnlyContainsBack:e.interactionOnlyContainsBack,recordingKey:aW.Pt(e,"interactionDropdown"),interactionsOnSelectedNodes:e.interactionsOnSelectedNodes}),f=c?m?o.createElement(oG.cS,{label:(0,d.tx)("proto.trigger"),input:h}):o.createElement("div",{className:oT.BX},h):o.createElement(a7.fI,{className:eW()(oT.SG,oT.QT)},h,o.createElement("div",{className:oT.LY},e.headerButtons)),N=o.createElement(o.Fragment,null,g&&rY((0,d.tx)("proto.delay"),o.createElement(il.W4,{className:c?oT.Lp:oT.Zp,inputClassName:c?oT.Gl:void 0,dataTestId:"timeout-input",dispatch:t,value:e.timeout,onValueChange:e=>{n({transitionTimeout:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:20,"data-tooltip-type":a0.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:aW.Pt(e,"timeoutInput")},c?o.createElement(rD.A,null):void 0),c,m),E&&rY((0,d.tx)("proto.key"),o.createElement(rL,{onChange:e=>{n({keyTrigger:e})},value:_,shouldFocusKeyCaptureField:r,setShouldFocusKeyCaptureField:l}),c,m),y&&rY((0,d.tx)("proto.time"),o.createElement(il.qd,{displayFractions:!0,className:oT.Ym,inputClassName:oT.vE,dataTestId:"mediaHitTime-input",dispatch:t,value:e.mediaHitTime,onValueChange:e=>{n({mediaHitTime:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:3600,"data-tooltip-type":a0.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.video_hit_time"),tooltipForScreenReadersOnly:!0,recordingKey:aW.Pt(e,"mediaHitTimeInput")},c?o.createElement(rf,null):void 0),c,m),v&&rY((0,d.tx)("proto.delay"),o.createElement(il.W4,{className:c?oT.Lp:oT.aq,inputClassName:c?oT.Gl:oT.p0,dataTestId:"duration-input",dispatch:t,value:u?e.interactionDuration:void 0,onValueChange:e=>{n(e&&e>0?{interactionMaintained:!0,interactionDuration:e}:{interactionMaintained:!1})},min:0,allowEmpty:!0,placeholder:(0,d.t)("proto.trigger.add_delay_placeholder"),wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,"data-tooltip-type":a0.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:aW.Pt(e,"delayInput")},c?o.createElement(rD.A,null):void 0),c,m));return c?o.createElement("div",{className:p?oT.eU:void 0},f,N):o.createElement("div",{className:oT.cF},f,N)}({...e,updateSelectionProperties:a,interactionType:r,interactionContainsOpenLinkAction:_,interactionContainsUpdateMediaRuntime:E,interactionOnlyContainsBack:g,interactionContainsConditionalAction:y,timeout:l,maintained:s,interactionDuration:m,mediaHitTime:c,keyTrigger:p,interactionsOnSelectedNodes:n,recordingKey:aW.Pt(e.recordingKey,a3.Qe)})}let rQ="prototype_interaction_edit_modal--contentContainer--bo2b4",rJ="prototype_interaction_edit_modal--ui3TwoColContentContainer--x9vrG",rj="prototype_interaction_edit_modal--ui3SingleColContentContainer--uF-ir",rq="prototype_interaction_edit_modal--dividerHorizontal--3wvnB",rZ="prototype_interaction_edit_modal--ui3InteractionsPanelContentRight--bVfG8";function r0(e){let{selectedInteractions:t,makeUpdateSelectionPropertiesForActionIndex:n,makeUpdateMultipleDestinationNodesForActionIndex:a,differentLengthActions:i,mergedActions:r}=(0,rS.Ay)(e.category),l="NONE"!==(0,aj.E7)(e.interactionType),c=void 0!==r.find(e=>"CONDITIONAL"===e.connectionType),{selectedActionIndex:s,onSelect:m}=e,p=(0,eD.GS)(),u=(0,a3.YT)(),_=u===a3.Oz.SINGLE_COL,E=u===a3.Oz.TWO_COL,{expandedRows:g,setExpandedRows:y,deleteButtonPressed:v,newActionIndexPath:h,resetNewActionIndexPath:f}=e;o.useEffect(()=>{h&&!h?.equals([])&&(p?m(h.path,!0):(y([...g,h]),m([],!1)),f())},[g,y,h,f,m,p]);let N=o.useCallback(e=>{g.find(t=>t.equals(e))?y(g.filter(t=>!t.equals(e))):y([...g,new iC.Op(e)])},[g,y]),b=o.useCallback(n=>{var a=n.dropItem;if((0,aj.gl)(a)||(0,iC.qQ)(n.dragItem))return;let o=e.interactionsOnSelectedNodes;if(!o||!t)return;for(var i=0;i<t?.length;i++){let e=t[i];if(e&&e.actions){let o=e.actions,r=(0,iC.Vp)(o,s,g,a,n.position);if(r.newSelectedActionIndex&&E&&m(r.newSelectedActionIndex.path,!0),r.newActions&&(t[i].actions=r.newActions,p||m([],!1)),r.newExpandedRows){if(E){let e=[];r.newActions?.forEach((t,n)=>{"CONDITIONAL"===t.connectionType&&e.push(new iC.Op([n]))}),y(e)}else y(r.newExpandedRows)}}}let r=o.map(e=>t.find(t=>t.id===e.id)??e);aQ.Y5.updateSelectionProperties({prototypeInteractions:r})},[g,y,e.interactionsOnSelectedNodes,s,t,m,p,E]),I=eW()({"prototype_interaction_edit_modal--panelUI3--WK3CN":p,"prototype_interaction_edit_modal--panelUI3TwoColumn--V5gi4":E});return o.createElement(a4.hh,null,o.createElement(a7.Zk,{className:I},e.shouldHideTitle?null:o.createElement(a7.fI,null,o.createElement(a7.U8,{title:(0,d.t)("proto.interaction.interaction"),dataTooltipContentKey:ot,dataTooltipTimeoutDelay:50})),o.createElement("div",null,(l||p)&&o.createElement(o.Fragment,null,_&&o.createElement(o.Fragment,null,o.createElement(rX,{category:e.category,recordingKey:a3.dJ,headerButtons:o.createElement(o.Fragment,null)}),o.createElement("div",{className:"prototype_interaction_edit_modal--dividerHorizontalUI3--HMCeE"})),i&&o.createElement(a5.Y,{direction:"horizontal",padding:{horizontal:16,vertical:12}},o.createElement(a7.UZ,null,(0,d.tx)("fullscreen.properties_panel.click_plus_to_replace_mixed_content"))),!i&&o.createElement(o.Fragment,null,r?.map((i,l)=>o.createElement(rk,{key:l,updateMultipleDestinationNodes:a(l),action:i,recordingKey:aW.Pt(e.recordingKey,a3.eG,l),updateSelectionProperties:n(l),onDeleteAction:()=>v(l),interactionType:e.interactionType,actionIndexPath:[l],numActions:r.length,isNestedInConditional:!1,isNarrowPanel:!c,stateManagementVersion:e.stateManagementVersion,selectedInteractions:t,onDrop:b,onSelect:e.onSelect,onExpand:N,selectedActionIndex:s,autoOpenVariablePicker:e.autoOpenVariablePicker,expandedRows:g,onNewActionAdded:e.onNewActionAdded,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder})))))))}function r1({transition:e,recordingKey:t,updateSelectionProperties:n,stateManagementVersion:a,selectedInteractions:r}){let l=(0,i.wA)(),c=(0,eD.GS)(),s=(0,a3.YT)()===a3.Oz.SINGLE_COL,p=()=>{for(let t of(E.az.trackDefinedEvent("prototype.state_management_noodle_upgraded",{num_interactions:r.length,preserve_scroll_position_value:!!e.preserveScroll}),r))(0,a3.uU)(t.stateManagementVersion)&&t.id&&t.sourceNodeID&&ra.zZ.recordInteractionUpgraded(t.id,t.sourceNodeID);n({...(0,aj.hS)(e.preserveScroll)&&(0,aj.hS)(a)?{transitionResetScrollPosition:!e.preserveScroll}:{},stateManagementVersion:1}),l(m.F.enqueue({type:"state-management-updated",message:(0,d.t)("proto.state_management.visual_bell_updated_message"),button:{text:(0,d.t)("proto.state_management.visual_bell_update_all"),action:()=>{aQ.Y5.triggerActionInUserEditScope("update-interactions-state-management-on-page"),l(m.F.enqueue({type:"state-management-updated-all",message:(0,d.t)("proto.state_management.visual_bell_update_all_message")}))}}}))},u=()=>{E.az.trackDefinedEvent("prototype.state_management_noodle_reverted",{num_interactions:r.length}),n({stateManagementVersion:0})},_=1===a?o.createElement(nv.$n,{variant:"link",recordingKey:aW.Pt(t,"revert-state-management-version"),onClick:u,htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,d.tx)("proto.state_management.revert_controls")):o.createElement(nv.$n,{variant:"secondary",recordingKey:aW.Pt(t,"update-state-management-version"),onClick:p},(0,d.tx)("proto.state_management.update_controls")),g=s?nv.IK:nv.$n,y=1===a?o.createElement(g,{variant:"secondary",onClick:u,recordingKey:aW.Pt(t,"revert-state-management-version"),htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,d.tx)("proto.state_management.revert_controls")):o.createElement(g,{variant:"primary",onClick:p,recordingKey:aW.Pt(t,"update-state-management-version")},(0,d.tx)("proto.state_management.update_controls")),v=1===a?(0,d.tx)("proto.state_management.new_controls"):(0,d.tx)("proto.state_management.old_controls"),h=o.createElement(B.N,{trusted:!0,newTab:!0,href:"https://help.figma.com/hc/articles/14397859494295"},c?(0,d.tx)("proto.state_management.controls_help_link_new"):(0,d.tx)("proto.state_management.controls_help_link")),f=o.createElement("div",{className:"prototype_state_management_version_panel--versionControls--siAOf"},o.createElement(a7.JU,{className:"prototype_state_management_version_panel--label--vvYMX"},v,h),o.createElement("div",{className:"prototype_state_management_version_panel--buttonContainer--rJZ-y"},_)),N=o.createElement("div",{className:"prototype_state_management_version_panel--containerUI3--V5tpG"},o.createElement(io.J,null,v),o.createElement(io.J,null,h),y),b=o.createElement("div",{className:"prototype_state_management_version_panel--containerUI3TwoCol--AAp8u"},o.createElement("span",{className:"prototype_state_management_version_panel--labelWrapperUI3--37g5A"},o.createElement(io.J,null,v)),o.createElement("span",{className:"prototype_state_management_version_panel--helpLinkWrapperUI3--BttuC"},h),y);return o.createElement(rt.k,{name:"prototype_state_management_version_panel"},o.createElement(a7.Zk,{className:c?"prototype_state_management_version_panel--panelUI3--8-Db5":void 0},c?s?N:b:f))}let r2="created_noodle";function r8(e){let{shouldHideTitle:t=!1,category:n,newActionIndexPath:a}=e,i=(0,a3.YT)()===a3.Oz.TWO_COL,{detailProps:r,detailPropsMultipleActions:l,interactionsOnSelectedNodesAndComponents:c,updateSelectionProperties:s,selectedInteractions:d}=(0,rS.Ay)(e.category);(0,g.h)(()=>{if(void 0!==a8.sn.get(r2)){let e=a8.sn.stop(r2);(0,E.sx)(r2,{elapsedMs:e,numConnectors:d.length},{forwardToDatadog:!0})}});let{showPanel:m,transition:p}=(0,a3.n6)(r,l,d),{interactionType:u="NONE",interactionMaintained:_=!1,interactionDuration:y=.3,keyTrigger:v=rH,transitionTimeout:h=.8,mediaHitTime:f=0}=l.interactionEvent,N=(0,a3.iC)(d),b=o.createElement(r0,{interactionType:u,timeout:h,mediaHitTime:f,maintained:_,interactionDuration:y,keyTrigger:v,recordingKey:aW.Pt(e,a3.Qe),shouldHideTitle:t,interactionsOnSelectedNodes:c,category:n,stateManagementVersion:N,autoOpenVariablePicker:e.autoOpenVariablePicker,newActionIndexPath:a,resetNewActionIndexPath:e.resetNewActionIndexPath,onNewActionAdded:e.onNewActionAdded,onSelect:e.onSelect,selectedActionIndex:e.selectedActionIndex,expandedRows:e.expandedRows,setExpandedRows:e.setExpandedRows,deleteButtonPressed:e.deleteButtonPressed,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder});return o.createElement("div",null,b,!i&&m&&o.createElement(r1,{transition:p,recordingKey:aW.Pt(e,"stateManagementVersionPanel"),updateSelectionProperties:s,stateManagementVersion:N,selectedInteractions:d}))}var r3=n(235733),r4=n(436347);function r5(e,t,n){let[a,o,i]=e.path,r=t[a].conditionalActions;if((0,aj.hS)(r)){let e=r?.[o].actions?.length??0;if(i>=e){if(0===e){n([a],!0);return}n([a,o,i-1],!0);return}}}function r7(e,t,n){let a=e.path[0]>=t.length,o=0===e.path.length;if(a){n([t.length-1],!0);return}if(o){n([0],!0);return}}var r6=n(207259),r9=n(277687);let le=()=>{l.glU.setSelectedInteractions([]),(0,c.kc)().prototype_ai_magic_link_show_suggestion_toast&&aQ.Y5.showMagicLinkSuggestedVisualBell("create_node_transition"),aQ.Y5.deselectProperty()},lt=(0,ne.jz)("197px"),ln=(0,ne.c8)("50%");function la(e){var t;return e&&a?.height<369?a=t={...a,height:369}:a??={width:440,height:e?369:320,leftWidthPct:45}}let lo=o.memo(function(){let e=(0,i.d4)(lc),t=(0,rS.HS)(),{selectedInteractions:n}=(0,rS.Ay)(t),a=n.length>0,[r,l]=o.useState(!1),c=aW.v_(a3.dJ,"keydown",t=>"Shift"!==t.key?aW.aH:(l(!0),e&&a)?void 0:aW.aH),s=aW.v_(a3.dJ,"keyup",t=>"Shift"!==t.key?aW.aH:(l(!1),e&&a)?void 0:aW.aH);if(o.useEffect(()=>(document.addEventListener("keydown",c),document.addEventListener("keyup",s),()=>{document.removeEventListener("keydown",c),document.removeEventListener("keyup",s)}),[c,s]),!e||!a)return null;let d=n.some(e=>e.actions?.some(e=>"CONDITIONAL"===e.connectionType));return o.createElement(li,{category:t,containsConditional:d,pressingShiftKey:r,initialX:e.initialX,initialY:e.initialY,shouldPin:e.shouldPin,setPressingShiftKey:l})}),li=o.memo(function({category:e,containsConditional:t,pressingShiftKey:n,initialX:r,initialY:c,shouldPin:s,setPressingShiftKey:m}){let p=(0,i.wA)(),[u,_]=o.useState(!1),[,E]=(0,y.fp)(r4.x),g=(0,o.useRef)(null),[v,h]=o.useState(!1),f=s||u,N=(0,eD.GS)(),b=(0,a3.YT)(),I=b===a3.Oz.SINGLE_COL,T=b===a3.Oz.TWO_COL,[A,C]=o.useState(new iC.Op(N?[0]:[])),{selectedInteractions:O,differentLengthActions:P,interactionsOnSelectedNodesAndComponents:x,mergedActions:w,detailProps:k,detailPropsMultipleActions:D,updateSelectionProperties:M}=(0,rS.Ay)(e);var R=A.path.length>0?A:new iC.Op([0]);let L=R.isConditional(),U=(e,t)=>R=new iC.Op(e);N&&R.path[0]>=w.length&&!L?r7(A,w,U):N&&L&&r5(A,w,U);let K=o.useCallback((e,t)=>{t?C(new iC.Op(e)):C(new iC.Op([]))},[]);o.useEffect(()=>{if(0===w.length){(0,aH.us)("the interactions panel should always have actions if rendered");let e=JSON.parse(JSON.stringify(O));for(let t of e)if(t&&t.actions?.length===0){let e={connectionType:"NONE"};t.actions=[e]}let t=x.map(t=>e.find(e=>aG.aI(e.id,t.id))??t);aQ.Y5.updateSelectionProperties({prototypeInteractions:t})}if(!N)return;let e=A.isConditional();if(e){if(e){r5(A,w,K);return}}else{r7(A,w,K);return}},[w,A,N,K,O,x]);let{shouldShowAdvancedPrototypingPaywall:V,showAdvancedPrototypinglMultipleActionsModal:B}=(0,a3.zt)(),{showPanel:F,transition:z}=(0,a3.n6)(k,D,O),G=(0,a3.iC)(O);var $=[];T?w.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&$.push(new iC.Op([t]))}):w.length<4&&w.forEach((e,t)=>{$.push(new iC.Op([t]))});let[W,H]=o.useState($),Y=o.useRef(null),X=n&&!f&&!v,Q=(0,ne.jz)(r6.prototypeInteractionModalWidth),J=(0,ne.jz)(r6.prototypeInteractionModalExpandedWidth),j=la(F).width,q=t?J:Q;T&&(q=j);let[Z,ee]=o.useState(s),et=(0,S._X)({subscribeToUpdates_expensive:!s}),en=o.useCallback(()=>{u||(p((0,aq._P)({name:"prototype_interaction_details_modal_dragged"})),_(!0))},[p,u,_]),ea=o.useMemo(()=>{let e=new tL.Mi(r,c);if(s)return T?new tL.Mi(e.x-(j-Q),e.y):t?new tL.Mi(e.x-(J-Q),e.y):e;{let t=(0,S.$g)(et,e);return new tL.Mi(t.x-q/2,t.y+30)}},[q,r,c,t,s,et,T,J,Q,j]);o.useEffect(()=>{if(!n)return;let e=e=>{!e.shiftKey&&n&&m(!1)};return document.addEventListener("mousemove",e),()=>{document.removeEventListener("mousemove",e)}},[n,m]),o.useEffect(()=>{E(X)},[E,X]),o.useEffect(()=>{ee(s)},[s]),o.useEffect(()=>()=>{p((0,aq._P)({name:"prototype_interaction_details_modal_closed"}))},[p]);let eo=o.useRef(null),[ei,er]=o.useState(!1);o.useEffect(()=>{ei&&(er(!1),eo.current?.scrollToBottom())},[ei,er,eo]);let[es,ed]=o.useState(new iC.Op([])),em=(0,ec.q5)(),ep=o.useCallback((e,t)=>{let n=e.event.clipboardData||window.clipboardData;switch(t){case aZ.zy.COPY:case aZ.zy.CUT:{let a=JSON.parse(JSON.stringify(O)),o=(0,r3.l)(a),i=aJ.fG(em?.key||null,{prototypeInteractions:o});if(aJ.C4(n,i,""),t===aZ.zy.CUT){let e=[];for(let t of O){let{sourceNodeID:n,id:a}=t;n&&a&&e.push(a$.d({nodeID:n,interactionID:a}))}az.l7.user("delete-prototype-interactions",()=>l.glU.deleteInteractions(e)),aQ.Y5.deselectProperty()}e.accept()}}},[em?.key,O]),eu=o.useRef(!1),[e_,eE]=o.useState(!1),{firstVariableSetMode:eg,firstVariableSetID:ey}=o0(),ev=(0,el.p8)("currentPage"),eh=o.useCallback((e,t,n,a)=>{p((0,aq._P)({name:"Prototype delete action",params:{action:e,source:"panel",connector_id:t,page_id:n,actionInConditionalAction:a}}))},[p]),ef=o.useCallback(e=>{if(x&&O){var t=!1,n=!1;if(V)B();else{for(let i=0;i<O?.length;i++){let r=O[i],l=[];if(r&&r.actions){var a=0,o=[];for(let i=0;i<r.actions.length;i++){let c=r.actions[i];if(i!==e)void 0!==W.find(e=>e.equals([i]))&&o.push(new iC.Op([a])),l.push(c),a++;else{let e=r.id?r.id:aG.Hr;eh(c.connectionType?c.connectionType:"NONE",(0,aG.dI)(e),ev),i===r.actions.length-1&&(t=!0),2===r.actions.length&&(n=!0)}H(o)}O[i].actions=l}}let i=x.map(e=>O.find(t=>t.id===e.id)??e);aQ.Y5.updateSelectionProperties({prototypeInteractions:i}),n&&N&&H([new iC.Op([0])]),t&&T&&C(new iC.Op([e-1]))}}},[x,O,V,B,W,ev,eh,T,N]),eN=o.useCallback(e=>{if(!x||!O||!e.path.length||void 0===e.path[0])return;let[t,n,a]=e.path,o=e.isConditional();if(V)B();else if(o){let e=!1,o=!1,i=O.map(i=>{let r=i.actions;if(!r)return i;let l=r.map((r,l)=>{if(l!==t||"CONDITIONAL"!==r.connectionType)return r;let c=r.conditionalActions;if(!c)return r;let s=c.map((t,r)=>{if(r!==n)return t;let l=t.actions;if(!l)return t;let c=l[a];c&&eh(c.connectionType?c.connectionType:"NONE",(0,aG.dI)(i.id??aG.Hr),ev,!0);let s=l.filter((e,t)=>t!==a);return e=a===l.length-1,o=0===s.length,{...t,actions:s}});return{...r,conditionalActions:s}});return{...i,actions:l}}),r=x.map(e=>i.find(t=>t.id===e.id)??e);aQ.Y5.updateSelectionProperties({prototypeInteractions:r}),o?C(new iC.Op([t])):!o&&e&&C(new iC.Op([t,n,a-1]))}else ef(t);document.activeElement?.blur()},[x,O,V,B,ef,ev,eh]),eb=o.createElement(aY.P,{className:T?"prototype_interaction_edit_modal--ui3TwoColScrollContainer--IWuQ4":rQ,useBottomPinning:!T,ref:eo,allowScrollAndZoomOver:!0,"data-not-draggable":!0},o.createElement(r8,{shouldHideTitle:!0,recordingKey:T?aW.Pt("leftCol",a3.dJ):a3.dJ,category:e,autoOpenVariablePicker:eu,newActionIndexPath:es,resetNewActionIndexPath:()=>{ed(new iC.Op([]))},onNewActionAdded:e=>{ed(e)},selectedActionIndex:A,onSelect:K,expandedRows:W,setExpandedRows:H,deleteButtonPressed:ef,autoOpenExpressionBuilder:e_,setAutoOpenExpressionBuilder:eE})),eI=1===O.length,eT=O[0],eA=eT.actions&&eT.actions.length<2,eS=eT.actions&&1===eT.actions.length&&eT.actions[0],eC=!eS||"NONE"===eS.connectionType,eO=eI&&eA&&eC;var eP=aG.Hr;let ex=o.createElement(iD,{skipPaywall:eO,addButtonPressed:e=>{if(!O)return;if(("CONDITIONAL"===e.connectionType||"SET_VARIABLE"===e.connectionType||"SET_VARIABLE_MODE"===e.connectionType)&&V){B();return}"SET_VARIABLE_MODE"===e.connectionType&&(e.targetVariableSetID=ey,e.targetVariableModeID=eg),"SET_VARIABLE"===e.connectionType&&eu&&(eu.current=!0),N&&"CONDITIONAL"===e.connectionType&&eE(!0);let t=!1;var n=null,a=N&&!P&&!eO&&O[0].actions&&1===O[0].actions.length;if(P||eO)for(var o=0;o<O.length;o++){let t=O[o];t.actions=[e];let n=t.id,a=t.sourceNodeID;(0,a3.uU)(t.stateManagementVersion)&&n&&a&&ra.zZ.recordInteractionUpgraded(n,a),t.stateManagementVersion=1}else for(var o=0;o<O.length;o++){let a=O[o];if(a.actions){if((0,a3.uU)(a.stateManagementVersion)&&(a.id&&a.sourceNodeID&&ra.zZ.recordInteractionUpgraded(a.id,a.sourceNodeID),a.actions?.forEach(e=>{e.transitionResetScrollPosition=!e.transitionPreserveScroll})),T){if(A.isConditional()){let n=A.path[0],o=A.path[1],i=A.path[2],r=a.actions?.[n],l=r.conditionalActions?.[o].actions?.length??0;n===a.actions.length-1&&i===l-1&&(t=!0),r.conditionalActions?.[o].actions?.splice(i+1,0,e)}else{let n=A.path[0]+1;n===a.actions.length&&(t=!0),a.actions?.splice(n,0,e)}}else a.actions?.push(e);eP=a.id?a.id:aG.Hr}else a.actions=[e],eP=a.id?a.id:aG.Hr;if(a.stateManagementVersion=1,T){let e=[...A.path];e[e.length-1]+=1,n=new iC.Op([...e])}else n=new iC.Op([a.actions.length-1])}let i=x.map(e=>O.find(t=>t.id===e.id)??e);if(aQ.Y5.updateSelectionProperties({prototypeInteractions:i}),a||T){var r=[];i[0].actions?.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&r.push(new iC.Op([t]))}),H(r)}er&&(!T||t)&&er(!0),ed&&ed(n),p((0,aq._P)({name:"Prototype add action",params:{action:e.connectionType?e.connectionType:"NONE",source:"panel",connector_id:(0,aG.dI)(eP),page_id:ev}}))},renderButton:!0,recordingKey:a3.dJ,isNestedInConditional:T&&A.isConditional()}),ew=O.some(e=>void 0!==e.actions&&e.actions?.length>1),ek=!A.isConditional()&&!ew,eM=o.createElement(ez.K,{onClick:()=>eN(A),"aria-label":(0,d.t)("proto.prototype_panel.delete"),disabled:ek,recordingKey:aW.Pt(a3.dJ,"actionDeleteButton"),htmlAttributes:{"data-tooltip":(0,d.t)("proto.prototype_panel.delete"),"data-tooltip-type":a0.Ib.TEXT}},o.createElement(aX.U,{svg:rx.A},o.createElement(aF.O,null))),eR=o.createElement("div",{className:"prototype_interaction_edit_modal--ui3FooterContainer--oYsXM"},ex," ",eM),eL=o.createElement(oN.c.Provider,{value:oN.P.LEFT},o.createElement("div",{className:T?"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeftResizable--16pLu":"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeft--UYWSG",ref:Y,style:T?{width:`${la(F).leftWidthPct}%`}:void 0},o.createElement(rX,{category:e,recordingKey:a3.dJ,headerButtons:o.createElement(o.Fragment,null)}),o.createElement("div",{className:rq}),eb,o.createElement("div",{className:rq}),o.createElement(o.Fragment,null,eR))),eU=w.length>0?o.createElement(oN.c.Provider,{value:oN.P.RIGHT},o.createElement(aY.P,{allowScrollAndZoomOver:!0,"data-not-draggable":!0,className:T?"prototype_interaction_edit_modal--ui3ScrollContainerRight--LJr-n":void 0},o.createElement(lr,{selectedActionIndex:R,handleExpandUI3:(e,t)=>{!t&&w.length>1?H(W.filter(t=>!t.equals(e))):W.find(t=>t.equals(e))||H([...W,new iC.Op(e)])},autoOpenVariablePicker:eu,autoOpenExpressionBuilder:e_,setAutoOpenExpressionBuilder:eE}))):null,eK=o.useRef(lt),[,eV]=(0,aB.i)({disabled:!T,onDragStart(){Y.current&&(eK.current=Y.current.getBoundingClientRect().width)},onDrag(e){if(Y.current&&eK.current){let t=la(F),n=eK.current+e.delta.x,o=n/t.width*100;n<lt?o=lt/t.width*100:o>ln&&(o=ln),Y.current.style.width=`${o}%`,a={...t,leftWidthPct:o}}}}),eB=T?o.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColPanelContainer--e8MK8"},o.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColInnerContainer--ZvJj2"},eL,o.createElement("div",{className:"prototype_interaction_edit_modal--dividerVertical--Noi1C"},o.createElement("div",{...eV({className:"prototype_interaction_edit_modal--verticalResizeHandle--xkc8V"})})),eU),F&&o.createElement(r1,{transition:z,recordingKey:aW.Pt(a3.dJ,"stateManagementVersionPanel"),updateSelectionProperties:M,stateManagementVersion:G,selectedInteractions:O})):eb;return o.createElement(a2.ht.Provider,{value:o.useMemo(()=>({autoCloseOnScroll:!f}),[f])},o.createElement(a1.vL,{name:"Prototype Draggable modal",className:"prototype_interaction_edit_modal--prototypeDraggableModal--njJ6A",handleClipboard:ep},o.createElement(i3.vx,{ref:g,dataTestId:"in-context-prototype-interaction-edit-modal",title:t=>o.createElement("div",{className:"prototype_interaction_edit_modal--onboardingRow--UlvE0"},o.createElement(ll,{category:e,recordingKey:a3.dJ,createActionTrigger:ex,closeButton:t})),containerClassName:eW()({[rQ]:!T,[rJ]:T,[rj]:I,"prototype_interaction_edit_modal--abovePropertiesPanel--hFejC":Z,"prototype_interaction_edit_modal--belowPropertiesPanel--f1Jfl":!Z,"prototype_interaction_edit_modal--modalExpandedWidth--IDl6k":t&&!N,"prototype_interaction_edit_modal--modalWidth--cCH7B":!t&&!N,"prototype_interaction_edit_modal--hideModal--RSp-R":X}),contentContainerClassName:eW()({[rQ]:!T,[rJ]:T,[rj]:I}),headerClassName:"prototype_interaction_edit_modal--multilineInteractionDetailsHeader--OE8Wr",allowWheelPassthrough:!0,initialPosition:ea,headerSize:"small",onClose:le,recordingKey:"interactionDetailsModal",arrowPosition:s?void 0:i3.F_.TOP,arrowRelativeX:s?void 0:q/2,onDragStart:()=>{ee(!0),en()},canRenderBelowViewport:!0,allowAutoExpanding:!0,dragHeaderOnly:!0,onFocus:()=>h(!0),allowResizeHeight:T,allowResizeWidth:T,fullFrame:T,minWidth:T?440:void 0,minHeight:T?F?369:320:void 0,maxWidth:T?800:void 0,maxHeight:T?800:void 0,initialHeight:T?la(F).height-i3.uF:void 0,initialWidth:T?la(F).width:void 0,onResize:T?e=>{a={...la(F),height:e.height,width:e.width}}:void 0},N?eB:eb)))});function lr({selectedActionIndex:e,autoOpenVariablePicker:t,handleExpandUI3:n,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:i}){let r=(0,rS.HS)(),{selectedInteractions:l,mergedActions:c,makeUpdateSelectionPropertiesForActionIndex:s,makeUpdateMultipleDestinationNodesForActionIndex:d,detailPropsMultipleActions:m}=(0,rS.Ay)(r),p=e.path[0],u=d(p),_=s(p),E=(0,a3.iC)(l),g=m.interactionEvent.interactionType??"NONE";if(e.isConditional()){let n=e.path[1],r=e.path[2],s=c[p],d=((0,aj.hS)(s.conditionalActions)&&s.conditionalActions?s.conditionalActions:[])[n],m=d?.actions?.[r];return m?o.createElement("div",{className:rZ},o.createElement(rk,{key:r,updateMultipleDestinationNodes:u.appendActionIndex(n).appendActionIndex(r),action:m,recordingKey:aW.Pt(a3.dJ,a3.Qe,a3.eG,p),updateSelectionProperties:_.appendActionIndex(n).appendActionIndex(r),onDeleteAction:Y.lQ,interactionType:g,actionIndexPath:e.path,numActions:c.length,isNestedInConditional:!0,stateManagementVersion:E,selectedInteractions:l,onDrop:Y.lQ,onSelect:Y.lQ,onExpand:Y.lQ,selectedActionIndex:e,expandedRows:[e],autoOpenVariablePicker:t,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:i,isNarrowPanel:!0})):null}return o.createElement("div",{className:rZ},o.createElement(rk,{key:p,updateMultipleDestinationNodes:u,action:c[p],recordingKey:aW.Pt(a3.dJ,a3.Qe,a3.eG,p),updateSelectionProperties:_,onDeleteAction:Y.lQ,interactionType:g,actionIndexPath:[p],numActions:c.length,isNestedInConditional:!1,stateManagementVersion:E,selectedInteractions:l,onDrop:Y.lQ,onSelect:Y.lQ,onExpand:n,selectedActionIndex:e,autoOpenVariablePicker:t,expandedRows:[e],autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:i,isNarrowPanel:!0}))}function ll({category:e,recordingKey:t,closeButton:n,createActionTrigger:a}){let r=(0,i.wA)(),{selectedInteractions:s}=(0,rS.Ay)(e),m=(0,a3.YT)(),p=m===a3.Oz.TWO_COL,u=m===a3.Oz.SINGLE_COL,_=(()=>{if(1!==s.length)return 0;let e=s[0],t={nodeID:e.sourceNodeID,interactionID:e.id};return l.X3B.getMatchingInteractions(a$.d(t)).length})(),E=(0,c.kc)().prototype_hide_matching_noodles&&1===s.length&&_>1&&o.createElement(ez.K,{actionOnPointerDown:!0,onClick:()=>{if(1!==s.length)return;let e=s[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=l.X3B.getMatchingInteractions(a$.d(t));l.glU.selectInteractionsAndSourceNodes(n);let a=(0,d.t)("proto.interaction_details.visual_bell.selected_n_matching_interactions",{total_num_interactions:n.length});aQ.Y5.showVisualBellWithUndo("selected-matching-noodles",a,!1),r((0,aq._P)({name:"prototype_select_matching_interactions",params:{num_connectors:n.length}}))},"aria-label":(0,d.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:_}),htmlAttributes:{tabIndex:-1,onMouseEnter:()=>{if(1!==s.length)return;let e=s[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=l.X3B.getMatchingInteractions(a$.d(t));l.glU.hoverInteractions(n)},onMouseLeave:()=>l.glU.hoverInteractions([]),"data-tooltip":(0,d.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:_}),"data-tooltip-type":a0.Ib.TEXT}},o.createElement(aX.U,{svg:r9.A},o.createElement(nV.A,null))),g=o.createElement(rX,{category:e,recordingKey:t,headerButtons:o.createElement(o.Fragment,null,E,a,n)}),y=o.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeader--Ka7aM"},(0,d.tx)("proto.interaction_details.header"),o.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeaderButtons--UqykU"},E,n)),v=o.createElement(o.Fragment,null,(0,d.tx)("proto.interaction_details.header"),o.createElement("div",{className:"prototype_interaction_edit_modal--ui3CollapsedModalHeaderButtons--7yPuD"},E,a,n));return p?y:u?v:g}let lc=e=>e.pickerShown?.id===tK.o$?e.pickerShown:null;var ls=n(220899),ld=n(563850),lm=n(501729),lp=n(29717),lu=n(988947),l_=n(161883),lE=n(146942),lg=n(326864),ly=n(369717),lv=n(882203),lh=n(413661),lf=n(77266);let lN=o.memo(({shouldShowDragAndDropBorder:e})=>{let t=(0,el.p8)("isReadOnly"),n=(0,i.d4)(e=>e.progressBarState),a=(0,el.p8)("loadingEmbeds"),u=(0,eA.ut)(l.Ez5?.uiState().showCanvasSearch,!1),_=(0,eS.Lk)(),E=(0,o.useRef)(null),g=(0,i.d4)(e=>e.userFlags),y=!!(0,c.kc)().internal_only_debug_tools||!!g.has_cursor_bot_onboarding_v2,v=(0,i.d4)(e=>e.openFile),h=v?v.key:"",f=(0,i.d4)(e=>e.universalInsertModal),N=(0,i.wA)();(0,ev.Gb)(h),(0,eT.W)(),(0,ld.K)();let b=(0,eb.BI)(),I=(0,ey.l7)(),{fpl_accessible_areas_for_design:T,fpl_a11y_accessible_areas_fullscreen_shortcuts:A}=(0,c.kc)(),S=o.createElement(eO.e,{condition:!!(A&&T),wrapper:e=>o.createElement(eC.m,{role:"region","aria-label":(0,d.t)("fullscreen_actions.left_sidebar_label")},e)},I?o.createElement(s.tH,{boundaryKey:"DevModeLeftPanel",fallback:s.H4.NONE_I_KNOW_WHAT_IM_DOING,sentryTags:{area:r.eBU.DEVELOPER_TOOLS}},o.createElement(p.O,null)):o.createElement(aT.m,null));return o.createElement(ah,null,o.createElement(eh.ED,null),o.createElement(aN.sk,null,n.mode!==l.Oin.OFF&&o.createElement("div",{className:lf._q}),o.createElement(t8.pO,{initialFilterState:{currentPage:!1}},a.map(e=>o.createElement(aE._,{key:`loading-embed-${e}`,nodeId:e})),o.createElement(ab.qn,null),o.createElement(ly.u,null),u&&o.createElement(aO.n,null),(0,c.kc)().ce_al_experiments_on&&o.createElement(aO.n,null),o.createElement(a_.GR,null),o.createElement(a_.bu,null),o.createElement(lm.J,null),o.createElement(ab.XI,{commentsDetailContainerRef:E}),o.createElement(lh.Z,null),(0,c.kc)().cursor_bot&&y&&o.createElement(aS.S,null),o.createElement(aI.X,null),o.createElement(ap.J,null),o.createElement(aA.Nz,null),o.createElement("div",{ref:E}),!(0,eN.T)()&&S,!t&&o.createElement(lo,null),o.createElement(au.G,null,I?null:o.createElement(o.Fragment,null,o.createElement(lb,null),!!b?.shouldOptimizeForIpadApp&&o.createElement(lE.K,null),!!b?.shouldOptimizeForIpadApp&&o.createElement(lg.t,null))),e&&o.createElement(aA.X5,null),(0,c.kc)().aip_flower_garden&&o.createElement(ac,null)),o.createElement(eP.A,{isFigjamEditor:!1,isDesignEditor:!0,isSlidesEditor:!1,openFile:v}),o.createElement(ls.l,{defaultViewTabsAvailable:!0,defaultViewAssetsTabVisible:!0}),f.showing&&o.createElement(s.tH,{boundaryKey:"FdBrowseResourceModal",onError:()=>{N(m.F.enqueue({message:"Unable to open inserts menu",type:"react-error"}))},fallback:s.H4.NONE_I_KNOW_WHAT_IM_DOING},o.createElement(lu.k,null))),_&&o.createElement(aC.K,{className:lf.PA},o.createElement(l_.s,null)))}),lb=o.memo(function(){let e=(0,el.p8)("topLevelMode"),t=(0,el.ax)(),n=(0,el.dH)();return(0,eI.z)({topLevelMode:l.lyf.PREVIEW,eventName:"Preview Mode Selection Changed",teamFilesOnly:!0}),o.useEffect(()=>{t&&e===l.lyf.PREVIEW&&n!==l.NLJ.COMMENTS&&(0,ef.NT)(l.FAf.INSPECT)},[t,e,n]),o.createElement(o.Fragment,null,o.createElement(af.E,null),o.createElement(lI,null))}),lI=o.memo(function(){return o.createElement(o.Fragment,null,o.createElement(ex.p,null,o.createElement(ew.L,null)),o.createElement(ex.p,{featureFlag:"starting_points_modal"},o.createElement(ti,null)),o.createElement(ex.p,null,o.createElement(eg,null)),o.createElement(ex.p,null,o.createElement(lp.e,null)),o.createElement(ex.p,null,o.createElement(U,null)),o.createElement(ex.p,null,o.createElement(K.A,null)),o.createElement(ex.p,null,o.createElement(tC,null)),o.createElement(ex.p,null,o.createElement(tD,null)),o.createElement(ex.p,{featureFlag:"mobile_prompt_sidebar_modal"},o.createElement(aK,null)),o.createElement(ex.p,null,o.createElement(V.S,null)),o.createElement(ex.p,null,o.createElement(t2,null)),o.createElement(ex.p,{featureFlag:"cmty_visual_assets_nux"},o.createElement(th,null)))});function lT(){let[e,t]=(0,o.useState)(!1);return o.createElement(ag.c,{loadedCommentsProvider:!1},o.createElement(lv.v,{setShouldShowDragAndDropBorder:t,isDragTarget:!1},o.createElement(lN,{shouldShowDragAndDropBorder:e})))}},700201:(e,t,n)=>{n.d(t,{f:()=>E});var a=n(411855),o=n(744952),i=n(462132),r=n(454475),l=n(171946),c=n(345202),s=n(248172),d=n(148467),m=n(216422),p=n(820139),u=n(260783),_=n(501191);function E({resolvedTypes:e,recordingKey:t}){let{showing:n,toggle:r,hide:m}=(0,c.BK)("expression-builder-create-variable"),p=a.useRef(null),E=o.rf(o.Pt(t,"createVariableDropdown"),"click",a.useCallback(()=>{1===e.length?f(e[0]):r()},[e,r])),[y,v]=a.useState(!1),h=a.useRef(null),f=e=>{let t=p.current?.getBoundingClientRect();t&&(h.current={initialPosition:new i.Mi(t.left,t.top),resolvedType:e},v(!0))},N=()=>{v(!1)};return a.createElement(a.Fragment,null,a.createElement("button",{ref:p,className:u.ZS,onClick:E},a.createElement(l.B,{svg:_.A})),y&&(y&&h.current?a.createElement(d.U,{initialPosition:h.current.initialPosition,initialWidth:d.i,resolvedType:h.current.resolvedType,onCreateVariable:N,onClose:N}):null),n&&p.current&&a.createElement(s.Cf,{arrowOffsetFromRectLeft:14,leanPadding:0,lean:"right",targetRect:p.current.getBoundingClientRect()},e.map(e=>a.createElement(g,{key:e,resolvedType:e,onClose:m,showCreationModal:f,recordingKey:t}))))}function g({resolvedType:e,onClose:t,showCreationModal:n,recordingKey:i}){let l=(0,p.F)(e),c=o.rf(o.Pt(i,"createVariableOption",l.name),"click",a.useCallback(()=>{n(e),t()},[t,e,n]));return a.createElement(r.c$,{className:u.Fs,onClick:c},a.createElement(m.i,{type:e,showTooltip:!1}),l.name)}}}]);

//# debugId=615eb246-aa0b-5e50-bff6-6b331b2554bc

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/fab014c4310f85c4df6363ee84f046ec42eb2bc0/fullscreen_design-d010c0b4b52a148d.min.js.map